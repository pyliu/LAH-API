<!DOCTYPE html>
<html lang="zh-TW">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>桃園地所書籤索引</title>
    <script src="tailwind.js"></script>
    <script src="lucide.min.js"></script>
    <style>
        /* --- CSS Variables --- */
        :root {
            --bootstrap-primary: #0d6efd;
            --bootstrap-primary-hover: #0b5ed7;
            --bootstrap-primary-active: #0a58ca;
            --bootstrap-primary-dark-bg: #0d6efd;
            --bootstrap-primary-dark-hover-bg: #3c87fd;
            --bootstrap-primary-dark-active-bg: #0b5ed7;
        }

        /* --- General Body & Scrollbar --- */
        body {
            font-family: 'Inter', sans-serif;
            transition: background-color 0.3s ease, color 0.3s ease;
        }
        ::-webkit-scrollbar { width: 8px; height: 8px; }
        ::-webkit-scrollbar-track { background: #f3f4f6; border-radius: 10px; }
        .dark ::-webkit-scrollbar-track { background: #374151; }
        ::-webkit-scrollbar-thumb { background: #9ca3af; border-radius: 10px; }
        .dark ::-webkit-scrollbar-thumb { background: #6b7280; }
        ::-webkit-scrollbar-thumb:hover { background: #6b7280; }
        .dark ::-webkit-scrollbar-thumb:hover { background: #4b5563; }

        /* --- Sidebar --- */
        #sidebar {
            transition: width 0.3s ease-in-out, padding 0.3s ease-in-out;
        }
        .sidebar-item {
            display: flex; align-items: center; justify-content: flex-start;
            padding: 0.625rem 1rem;
            border-radius: 0.375rem;
            transition: background-color 0.2s ease-in-out, color 0.2s ease-in-out, padding 0.3s ease-in-out;
            width: 100%; cursor: pointer;
            overflow: hidden;
        }
        .sidebar-item > span {
            transition: opacity 0.2s ease-in-out, color 0.2s ease-in-out;
            margin-left: 0.5rem;
            white-space: nowrap;
        }
        .sidebar-item > i[data-lucide] {
            margin-right: 0;
            flex-shrink: 0;
        }
        #sidebar.collapsed .sidebar-item {
            justify-content: center;
            padding: 0.625rem 0.5rem;
        }
        #sidebar.collapsed #sidebar-header .font-semibold > span,
        #sidebar.collapsed .sidebar-item > span {
            display: none;
        }
        #sidebar.collapsed #sidebar-header .font-semibold {
            justify-content: center;
        }
        #theme-toggle-button { margin-top: auto; }

        /* --- Bookmark Cards --- */
        .bookmark-card-styled {
            display: block;
            overflow: hidden;
            transition: box-shadow 0.3s ease-in-out, background-color 0.3s ease-in-out;
            text-decoration: none;
        }
        .bookmark-card-styled:hover {
            /* Existing hover styles */
        }
        .card-content-wrapper {
            padding: 1.25rem; display: flex;
            flex-direction: column; flex-grow: 1;
            height: 100%;
        }
        /* Removed: .card-title > i[data-lucide] + span { margin-left: 0.5rem; } */
        /* Spacing is now handled by mr-2 on the icon itself via JS */

        /* --- Action Button (visual cue) --- */
        .action-button-visual {
            display: inline-flex; align-items: center; justify-content: center;
            white-space: nowrap;
        }
        .action-button-visual > span { margin-right: 0.25rem; }

        /* --- Lucide Icons --- */
        i[data-lucide] {
            display: inline-block;
            vertical-align: -0.2em;
            line-height: 1;
            flex-shrink: 0;
        }
        i[data-lucide]:not(.card-title > i[data-lucide]) {
            width: 1.25em;
            height: 1.25em;
        }
        .card-title > i[data-lucide] {
            /* margin-right is now handled by mr-2 class in JS */
            /* width and height will be set by inline style in JS */
        }


        /* --- Light Theme --- */
        body { background-color: #f3f4f6; color: #1f2937; }
        #sidebar { background-color: #e9ecef; color: #212529; }
        #sidebar-header .font-semibold { color: #212529; }
        #sidebar-header .font-semibold > i[data-lucide] + span { margin-left: 0.5rem; }
        .sidebar-item { color: #212529; }
        .sidebar-item:hover { background-color: var(--bootstrap-primary-hover); color: #ffffff !important; }
        .sidebar-item.active { background-color: var(--bootstrap-primary); color: #ffffff !important; }
        #theme-toggle-button { color: #212529; }
        #theme-toggle-button:hover { background-color: var(--bootstrap-primary-hover); color: #ffffff !important; }
        main { background-color: #f3f4f6; }
        #current-category-title { color: #1f2937; }
        .bookmark-card-styled {
            background-color: #ffffff; border-radius: 0.75rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            color: inherit;
        }
        .bookmark-card-styled:hover {
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        .card-title span { color: #1f2937; }
        .card-title + p { color: #4b5563; }
        .card-title > i[data-lucide] { color: var(--bootstrap-primary); }
        .action-button-visual {
            background-color: var(--bootstrap-primary);
            color: #ffffff;
            padding-top: 0.5rem; padding-bottom: 0.5rem;
            padding-left: 1rem; padding-right: 1rem;
            border-radius: 0.5rem;
            transition-property: background-color, border-color, color, fill, stroke, opacity, box-shadow, transform, filter, backdrop-filter;timing-function: cubic-bezier(0.4, 0, 0.2, 1);
            transition-duration: 300ms;
            text-align: center;
        }
        .bookmark-card-styled:hover .action-button-visual {
             background-color: var(--bootstrap-primary-hover);
        }
        #sidebar-toggle-button { color: #374151; }
        #sidebar-toggle-button:hover { background-color: #e5e7eb; }
        #sidebar-toggle-button.open-icon-red svg { color: #ef4444; }


        /* --- Dark Theme --- */
        .dark body { background-color: #0f172a; color: #cbd5e1; }
        .dark #sidebar { background-color: #1e293b; color: #e2e8f0; }
        .dark #sidebar-header .font-semibold { color: #f1f5f9; }
        .dark .sidebar-item { color: #e2e8f0; }
        .dark .sidebar-item:hover { background-color: var(--bootstrap-primary-dark-hover-bg); color: #f8fafc !important; }
        .dark .sidebar-item.active { background-color: var(--bootstrap-primary-dark-active-bg); color: #f8fafc !important; }
        .dark #theme-toggle-button { color: #e2e8f0; }
        .dark #theme-toggle-button:hover { background-color: var(--bootstrap-primary-dark-hover-bg); color: #f8fafc !important; }
        .dark main { background-color: #0f172a; }
        .dark #current-category-title { color: #f1f5f9; }
        .dark .bookmark-card-styled {
            background-color: #1e293b;
            box-shadow: 0 4px 6px -1px rgba(0,0,0,0.6), 0 2px 4px -1px rgba(0,0,0,0.5);
            color: inherit;
        }
        .dark .bookmark-card-styled:hover {
             box-shadow: 0 10px 15px -3px rgba(0,0,0,0.7), 0 4px 6px -2px rgba(0,0,0,0.6);
        }
        .dark .card-title span { color: #f1f5f9; }
        .dark .card-title + p { color: #94a3b8; }
        .dark .card-title > i[data-lucide] { color: var(--bootstrap-primary-dark-hover-bg); }
        .dark .action-button-visual {
            background-color: var(--bootstrap-primary-dark-bg);
            color: #f8fafc;
        }
        .dark .bookmark-card-styled:hover .action-button-visual {
             background-color: var(--bootstrap-primary-dark-hover-bg);
        }
        .dark #sidebar-toggle-button { color: #94a3b8; }
        .dark #sidebar-toggle-button:hover { background-color: #334155; }
        .dark #sidebar-toggle-button.open-icon-red svg { color: #f87171; }


        #bookmarks-content {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 1.5rem;
        }

        /* --- Copyright --- */
        .copyright-footer {
            position: fixed;
            bottom: 1rem; /* Tailwind class: bottom-4 */
            right: 1rem; /* Tailwind class: right-4 */
            font-size: 0.75rem; /* Tailwind class: text-xs */
            color: #6b7280; /* Tailwind class: text-gray-500 */
            text-shadow: 1px 1px 2px rgba(0,0,0,0.1); /* 浮動效果 */
            z-index: 50; /* 確保在最上層 */
        }
        .dark .copyright-footer {
            color: #9ca3af; /* Tailwind class: dark:text-gray-400 */
            text-shadow: 1px 1px 2px rgba(255,255,255,0.1); /* 深色模式下的浮動效果 */
        }
    </style>
</head>

<body class="">
    <div class="flex h-screen overflow-hidden">
        <aside id="sidebar" class="p-4 flex flex-col overflow-y-auto bg-white dark:bg-gray-800 shadow-lg z-20">
            <div id="sidebar-header" class="mb-6">
                <div class="text-2xl font-semibold flex items-center">
                    <i data-lucide="link" class="mr-2"></i>
                    <span>書籤索引</span>
                </div>
            </div>
            <div id="sidebar-links" class="space-y-2 flex-grow"></div>
            <button id="theme-toggle-button" class="sidebar-item mt-4" title="切換顯示主題">
                <i data-lucide="sun"></i>
                <span>切換主題</span>
            </button>
        </aside>

        <main class="flex-1 p-4 overflow-y-auto">
            <div class="flex items-center mb-6">
                <button id="sidebar-toggle-button" class="p-2 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 z-30 mr-3" title="開啟/收合側邊欄">
                    <i data-lucide="menu" class="text-xl"></i>
                </button>
                <h1 id="current-category-title" class="text-3xl font-bold">共通網址</h1>
            </div>

            <div id="bookmarks-content">
                </div>
        </main>
    </div>

    <div class="copyright-footer">
        © Taoyuan Land Office 2025 All Rights Reserved.
    </div>

    <script>
        // --- Data (same as before) ---
        const bookmarksData = [
            {
                category: "共通網址",
                id: "common",
                icon: "home",
                links: [
                    { title: "地政事務所入口網", href: "http://220.1.34.75:8080/", description: "顯示最新公告及各業務小幫手連結", icon: "layout-dashboard" },
                    { title: "機關內部人事業務系統", href: "https://webitr.tycg.gov.tw/WebITR/", description: "桃園市政府差勤系統 https://webitr.tycg.gov.tw/WebITR/", icon: "clock" },
                    { title: "公文整合資訊系統", href: "https://odis.tycg.gov.tw/", description: "市府公文系統 https://odis.tycg.gov.tw/", icon: "book-marked" },
                    { title: "地所員工知識網", href: "http://220.1.34.18:8888", description: "提供公告、各課室專屬區、員工資訊、會議室預約 ... 等功能", icon: "home" },
                    { title: "桃園市政府公務雲", href: "https://tycgcloud.tycg.gov.tw/", description: "桃園市政府公務雲(內網) https://tycgcloud.tycg.gov.tw/", icon: "cloud" },
                    { title: "地政系統跨縣市伺服器", href: "http://220.1.34.161:9080/LandHA/", description: "地政系統跨縣市操作專屬伺服器 http://220.1.34.161:9080/LandHA/", icon: "server" },
                    { title: "內外網檔案交換系統", href: "http://220.1.34.26:8008/", description: "內網電腦檔案交換至外網的交換系統，外網下載請至 http://220.2.34.17:8008/", icon: "file-output" },
                    { title: "資訊課各式表單下載", href: "http://220.1.34.18/service/section/%E8%B3%87%E8%A8%8A%E8%AA%B2/download.html", description: "提供各式資訊課申請表單下載", icon: "database" },
                    { title: "人事室各式表單下載", href: "http://220.1.34.18/service/section/%E4%BA%BA%E4%BA%8B%E5%AE%A4/download.html", description: "提供各式人事相關申請表單下載", icon: "user" },
                    { title: "行政課各式下載區", href: "http://220.1.34.18/service/section/04/download.htm", description: "行政課各式下載專區", icon: "user-cog" }
                ]
            },
            {
                category: "全功能櫃台",
                id: "counter",
                icon: "concierge-bell",
                links: [
                    { title: "地政系統-跨縣市AP(161)", href: "http://220.1.34.161:9080/LandHA/", description: "地政系統跨縣市操作專屬伺服器 http://220.1.34.161:9080/LandHA/", icon: "server-cog" },
                    { title: "地政系統-桃園外掛AP(60)", href: "http://220.1.34.60:9080/LandHA/", description: "地政系統桃園外掛操作專屬伺服器 http://220.1.34.60:9080/LandHA/", icon: "server-cog" },
                    { title: "地政系統-工作站AP(118)", href: "http://220.1.34.118:9080/LandHA/", description: "地政系統工作站操作專屬伺服器 http://220.1.34.118:9080/LandHA/", icon: "server-cog" },
                    { title: "登記課專屬入口網站", href: "http://220.1.34.18/service/section/%E7%99%BB%E8%A8%98%E8%AA%B2/index.htm", description: "最新消息、課務會議、教育訓練、法規新訊、解釋函令、下載專區、地籍清理、活動剪影", icon: "layout-list" },
                    { title: "地政智慧控管系統", href: "http://220.1.34.75:8080/reg/", description: "提供十多項登記案件查詢及控管統計功能的系統 http://220.1.34.75:8080/reg/", icon: "landmark" },
                    { title: "地政歷史資料查詢系統", href: "http://220.1.34.15/NLOWeb/", description: "地政歷史資料查詢系統 http://220.1.34.15/NLOWeb/", icon: "history" },
                    { title: "謄本櫃員機後台管理", href: "http://220.1.33.117/MGMT/", description: "管理謄本櫃員機會員帳號、顯示統計資料", icon: "settings-2" },
                    { title: "簡訊發送紀錄查詢", href: "http://220.1.34.75:8080/reg/sms", description: "提供地政系統傳送地籍異動即時通等簡訊紀錄查詢 http://220.1.34.75:8080/reg/sms", icon: "message-square-text" }
                ]
            },
            {
                category: "登記課",
                id: "reg",
                icon: "file-signature",
                links: [
                    { title: "登記課專屬入口網站", href: "http://220.1.34.18/service/section/%E7%99%BB%E8%A8%98%E8%AA%B2/index.htm", description: "最新消息、課務會議、教育訓練、法規新訊、解釋函令、下載專區、地籍清理、活動剪影", icon: "layout-list" },
                    { title: "地政智慧控管系統", href: "http://220.1.34.75:8080/reg/", description: "提供十多項登記案件查詢及控管統計功能的系統 http://220.1.34.75:8080/reg/", icon: "landmark" },
                    { title: "地政系統-跨縣市AP(161)", href: "http://220.1.34.161:9080/LandHA/", description: "地政系統跨縣市操作專屬伺服器 http://220.1.34.161:9080/LandHA/", icon: "server-cog" },
                    { title: "地政系統-桃園外掛AP(60)", href: "http://220.1.34.60:9080/LandHA/", description: "地政系統桃園外掛操作專屬伺服器 http://220.1.34.60:9080/LandHA/", icon: "server-cog" },
                    { title: "地政系統-登記課AP1(205)", href: "http://220.1.34.205:9080/LandHA/", description: "地政系統登記課操作專屬伺服器 http://220.1.34.205:9080/LandHA/", icon: "server-cog" },
                    { title: "地政系統-登記課AP2(206)", href: "http://220.1.34.206:9080/LandHA/", description: "地政系統登記課操作專屬伺服器 http://220.1.34.206:9080/LandHA/", icon: "server-cog" },
                    { title: "內政部地政司-電子產權憑證後台", href: "https://220.5.61.73/etd-manager/", description: "內政部地政司開發提供電子產權憑證管理功能... https://220.5.61.73/etd-manager/", icon: "shield-check" },
                    { title: "地政歷史資料查詢系統", href: "http://220.1.34.15/NLOWeb/", description: "地政歷史資料查詢系統 http://220.1.34.15/NLOWeb/", icon: "history" },
                    { title: "土地參考資訊檔查詢系統", href: "http://220.1.34.213/ref/jsp/security/login.jsp", description: "土地參考資訊檔查詢系統 http://220.1.34.213/ref/jsp/security/login.jsp", icon: "file-search" },
                    { title: "內政部地政司-數位櫃台", href: "http://220.5.61.14/", description: "內政部地政司數位櫃臺公務端網站 http://220.5.61.14/", icon: "monitor-smartphone" },
                    { title: "內政部地政司-罕用字查詢系統", href: "http://220.5.61.32/MOILAND/", description: "內政部地政司開發建置之罕用字查詢系統 http://220.5.61.32/MOILAND/", icon: "spell-check" },
                    { title: "內政部戶役政電子閘門系統", href: "https://210.241.18.131/", description: "內政部戶役政電子閘門系統 https://210.241.18.131/", icon: "door-open" },
                    { title: "內政部地政司-未辦繼承", href: "http://220.1.33.37:8091/OIB6/Login.jsp", description: "內政部地政司未辦繼承登記土地及建物管理系統 http://220.1.33.37:8091/OIB6/Login.jsp", icon: "user-x" },
                    { title: "內政部地政司-地籍清理", href: "http://220.1.33.79:8080/TAZQ/index.jsp", description: "內政部地政司地籍清理管理系統 http://220.1.33.79:8080/TAZQ/index.jsp", icon: "files" },
                    { title: "內政部地政司-線上申辦", href: "http://220.5.61.17/cms/", description: "內政部地政司線上申辦系統 http://220.5.61.17/cms/", icon: "file-plus-2" },
                    { title: "謄本櫃員機後台管理", href: "http://220.1.33.117/MGMT/", description: "管理謄本櫃員機會員帳號、顯示統計資料", icon: "settings-2" },
                    { title: "地政系統-罰鍰裁處AP(162)", href: "http://220.1.34.162:9080/LandHA/", description: "地政系統罰鍰裁處操作專屬伺服器 http://220.1.34.162:9080/LandHA/", icon: "gavel" },
                    { title: "私法人購置住宅", href: "http://220.1.33.80/PcQ.aspx", description: "私法人購置住宅 http://220.1.33.80/PcQ.aspx", icon: "building" }
                ]
            },
            {
                category: "測量課",
                id: "sur",
                icon: "ruler",
                links: [
                    { title: "測量課專屬入口網站", href: "http://220.1.34.18/service/section/%E6%B8%AC%E9%87%8F%E8%AA%B2/index.htm", description: "法院判決案例、會議紀錄、法令規範、測量成果交換、應用軟體、常用表格 ...", icon: "layout-list" },
                    { title: "地政系統-測量課AP1(207)", href: "http://220.1.34.207:9080/LandHA/", description: "地政系統測量課操作專屬伺服器 http://220.1.34.207:9080/LandHA/", icon: "server-cog" },
                    { title: "地政系統-測量課AP2(62)", href: "http://220.1.34.62:9080/LandHA/", description: "地政系統測量課操作專屬伺服器 http://220.1.34.62:9080/LandHA/", icon: "server-cog" },
                    { title: "建管圖資介接系統", href: "http://220.1.33.43:8080/Q14Web/", description: "建物第一次測量-使用執照資訊及竣工圖介接系統 http://220.1.33.43:8080/Q14Web/", icon: "map" },
                    { title: "測量逾期案件查詢", href: "http://220.1.34.75:8080/sur/expire", description: "測量逾期案件查詢 http://220.1.34.75:8080/sur/expire", icon: "calendar-clock" },
                    { title: "重測換狀通知書系統", href: "http://220.1.34.211:9080/XDT98/", description: "重測換狀通知書系統 http://220.1.34.211:9080/XDT98/", icon: "file-text" }
                ]
            },
            {
                category: "地價課",
                id: "val",
                icon: "tags",
                links: [
                    { title: "地價課專屬入口網站", href: "http://220.1.34.18/service/section/%E8%A1%8C%E6%94%BF%E8%AA%B2/fram.htm", description: "最新消息、會議紀錄、表單下載 ...", icon: "layout-list" },
                    { title: "地政系統-地價課AP(156)", href: "http://220.1.34.156:9080/LandHA/", description: "地政系統地價課操作專屬伺服器 http://220.1.34.156:9080/LandHA/", icon: "server-cog" },
                    { title: "實價登錄案件控管", href: "http://220.1.34.75:8080/prc/realprice", description: "實價登錄案件控管頁面 http://220.1.34.75:8080/prc/realprice", icon: "file-check-2" },
                    { title: "實價登錄JSON資料解析", href: "http://220.1.34.75:8080/prc/json-converter", description: "實價登錄JSON資料解析 http://220.1.34.75:8080/prc/json-converter", icon: "file-json" },
                    { title: "不動產交易成交資訊登錄機制系統", href: "http://220.5.61.195:8080/RPM/", description: "不動產交易成交資訊登錄機制系統 http://220.5.61.195:8080/RPM/", icon: "database-zap" },
                    { title: "五方區估系統", href: "http://220.1.34.12/TomMis/", description: "地價區段劃分及區段地價估價作業系統 http://220.1.34.12/TomMis/", icon: "area-chart" },
                    { title: "實價登錄清理系統", href: "http://220.1.34.12/moi_estate/", description: "實價登錄清理系統 http://220.1.34.12/moi_estate/", icon: "file-scan" },
                    { title: "實價登錄簡訊系統", href: "http://220.1.34.221/", description: "實價登錄簡訊系統 http://220.1.34.221/", icon: "message-square-more" }
                ]
            },
            {
                category: "行政課",
                id: "adm",
                icon: "briefcase",
                links: [
                    { title: "行政課專屬入口網站", href: "http://220.1.34.18/service/section/04/index.htm", description: "最新消息、年度計畫、公文稽催 ...", icon: "layout-list" },
                    { title: "檔案知識庫", href: "http://220.1.34.18/service/section/archives/archives.html", description: "檔案作業規劃、檔案應用、檔案分類表、會議記錄 ...", icon: "archive" },
                    { title: "地政系統-行政課AP(156)", href: "http://220.1.34.156:9080/LandHA/", description: "地政系統行政課操作專屬伺服器 http://220.1.34.156:9080/LandHA/", icon: "server-cog" },
                    { title: "非都市土地使用編定管理系統", href: "http://220.1.34.12:8080/LandHA/", description: "非都市土地使用編定管理系統 http://220.1.34.12:8080/LandHA/", icon: "map-pin" },
                    { title: "檔案應用預約申請控管系統", href: "http://220.1.34.75:8080/adm/file", description: "民眾檔案應用服務申請控管 http://220.1.34.75:8080/adm/file", icon: "file-archive" },
                    { title: "土地參考資訊檔查詢系統", href: "http://220.1.34.213/ref/jsp/security/login.jsp", description: "土地參考資訊檔查詢系統 http://220.1.34.213/ref/jsp/security/login.jsp", icon: "file-search" }
                ]
            },
            {
                category: "資訊課",
                id: "inf",
                icon: "laptop",
                links: [
                    { title: "資訊課專屬入口網站", href: "http://220.1.34.18/service/section/%E8%B3%87%E8%A8%8A%E8%AA%B2/", description: "最新消息、表單下載、會議記錄 ...", icon: "layout-list" },
                    { title: "地政資訊系統監控", href: "http://220.1.34.75:8080/inf/dashboard", description: "以儀表板呈現最即時的系統狀態 http://220.1.34.75:8080/inf/dashboard", icon: "tv" },
                    { title: "111數發部政府簡訊平台", href: "https://111.gov.tw/psms_web/", description: "政府專屬短碼簡訊平臺(外網) https://111.gov.tw/psms_web/", icon: "message-circle" },
                    { title: "地政系統-本所測試機", href: "http://192.168.17.20:9080/LandHA/", description: "地政系統-跨縣市測試機 http://192.168.17.20:9080/LandHA/", icon: "server" },
                    { title: "地政系統-桃園外掛測試機", href: "http://192.168.17.21:9080/LandHA/", description: "地政系統-桃園外掛測試機 http://192.168.17.21:9080/LandHA/", icon: "server" },
                    { title: "地政系統-跨縣市測試機", href: "http://192.168.17.22:9080/LandHA/", description: "地政系統-跨縣市測試機 http://192.168.17.22:9080/LandHA/", icon: "server" },
                    { title: "案件辦理情形通知系統", href: "http://220.1.34.221:8080/SMS98/", description: "精誠開發之系統透過「中華電信訊息中心API」傳送案件辦理狀態簡訊及電子郵件 http://220.1.34.221:8080/SMS98/", icon: "message-circle-more" },
                    { title: "便民觸控查詢控制台", href: "http://220.1.34.211:9080/touch/", description: "便民觸控查詢控制台 http://220.1.34.211:9080/touch/", icon: "monitor" },
                    { title: "SRMAS 機房天氣圖", href: "http://220.1.34.75:8080/inf/weather/", description: "機房網路及主要系統狀態顯示 http://220.1.34.75:8080/inf/weather/", icon: "cloud-sun-rain" }
                ]
            },
            {
                category: "人事室",
                id: "hr",
                icon: "users",
                links: [
                    { title: "人事室專屬入口網站", href: "http://220.1.34.18/service/section/%E4%BA%BA%E4%BA%8B%E5%AE%A4/index.htm", description: "最新消息、表單下載、職掌業務 ...", icon: "layout-list" }
                ]
            },
            {
                category: "會計室",
                id: "acc",
                icon: "calculator",
                links: [
                    { title: "會計室(內部控制)專屬入口網站", href: "http://220.1.34.18/service/section/%E6%9C%83%E8%A8%88%E5%AE%A4/index.htm", description: "參考資料、會議紀錄、內控制度 ...", icon: "layout-list" }
                ]
            },
            {
                category: "舊版書籤",
                id: "legacy",
                icon: "archive",
                href: "old.html",
                isDirectLink: true
            }
        ];

        // --- DOM Elements ---
        const sidebar = document.getElementById('sidebar');
        const mainContent = document.querySelector('main');
        const sidebarLinksContainer = document.getElementById('sidebar-links');
        const bookmarksContent = document.getElementById('bookmarks-content');
        const currentCategoryTitle = document.getElementById('current-category-title');
        const sidebarToggleButton = document.getElementById('sidebar-toggle-button');
        // const sidebarToggleIcon = sidebarToggleButton.querySelector('i'); // No longer globally cached
        const themeToggleButton = document.getElementById('theme-toggle-button');
        const htmlElement = document.documentElement;


        // --- Sidebar State Constants ---
        const SIDEBAR_OPEN_WIDTH_CLASS = 'w-48';
        const SIDEBAR_COLLAPSED_WIDTH_CLASS = 'w-16';

        let isSidebarVisuallyOpen = false;

        // Function to update visibility of text in sidebar and toggle button icon/color
        function updateSidebarIconAndText() {
            const sidebarTexts = sidebar.querySelectorAll('.sidebar-item > span, #sidebar-header .font-semibold > span');
            let iconName;

            if (isSidebarVisuallyOpen) {
                sidebarTexts.forEach(span => span.classList.remove('hidden'));
                sidebar.classList.remove('collapsed');
                iconName = 'sidebar-close';
                sidebarToggleButton.classList.add('open-icon-red');
            } else {
                sidebarTexts.forEach(span => span.classList.add('hidden'));
                sidebar.classList.add('collapsed');
                iconName = 'menu';
                sidebarToggleButton.classList.remove('open-icon-red');
            }

            sidebarToggleButton.innerHTML = `<i data-lucide="${iconName}" class="text-xl"></i>`;

            setTimeout(() => {
                lucide.createIcons();
            }, 0);
        }

        // Function to apply the visual state to the sidebar and save to localStorage
        function setSidebarVisualState(visualState) {
            if (visualState === 'open') {
                sidebar.classList.remove(SIDEBAR_COLLAPSED_WIDTH_CLASS);
                sidebar.classList.add(SIDEBAR_OPEN_WIDTH_CLASS);
                isSidebarVisuallyOpen = true;
            } else { // 'collapsed'
                sidebar.classList.remove(SIDEBAR_OPEN_WIDTH_CLASS);
                sidebar.classList.add(SIDEBAR_COLLAPSED_WIDTH_CLASS);
                isSidebarVisuallyOpen = false;
            }
            localStorage.setItem('sidebarState', visualState);
            updateSidebarIconAndText();
        }


        // Function to apply the selected theme
        function applyTheme(theme) {
            const iconName = theme === 'dark' ? 'moon' : 'sun';
            const themeToggleSpan = themeToggleButton.querySelector('span');
            themeToggleButton.innerHTML = `<i data-lucide="${iconName}"></i><span class="${!isSidebarVisuallyOpen ? 'hidden' : ''}">${themeToggleSpan ? themeToggleSpan.textContent : '切換主題'}</span>`;

            if (theme === 'dark') {
                htmlElement.classList.add('dark');
            } else {
                htmlElement.classList.remove('dark');
            }
            setTimeout(() => {
                lucide.createIcons();
                updateSidebarIconAndText();
            }, 0);
        }

        // Function to toggle theme and save preference
        function toggleTheme() {
            const currentTheme = htmlElement.classList.contains('dark') ? 'dark' : 'light';
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            localStorage.setItem('theme', newTheme);
            applyTheme(newTheme);
        }

        // Event listener for theme toggle button
        if (themeToggleButton) {
            themeToggleButton.addEventListener('click', toggleTheme);
        }

        // Populate sidebar links
        bookmarksData.forEach((item) => {
            const linkElement = document.createElement('a');
            linkElement.href = item.isDirectLink ? item.href : '#';
            linkElement.title = item.category; // Add title attribute for tooltip
            if (item.isDirectLink) {
                linkElement.target = "_blank";
                linkElement.rel = "noopener noreferrer";
            }
            linkElement.classList.add('sidebar-item');
            linkElement.dataset.id = item.id;
            linkElement.innerHTML = `<i data-lucide="${item.icon}"></i><span>${item.category}</span>`;

            if (!item.isDirectLink) {
                linkElement.onclick = (e) => {
                    e.preventDefault();
                    loadCategory(item.id);
                    document.querySelectorAll('#sidebar-links .sidebar-item').forEach(el => {
                       el.classList.remove('active');
                    });
                    linkElement.classList.add('active');
                };
            }
            sidebarLinksContainer.appendChild(linkElement);
        });

        // Function to render bookmark cards
        function renderBookmarks(links) {
            bookmarksContent.innerHTML = '';
            if (!links || links.length === 0) {
                bookmarksContent.innerHTML = '<p class="text-center py-10">此類別下沒有書籤。</p>';
                bookmarksContent.querySelector('p').classList.toggle('text-gray-400', htmlElement.classList.contains('dark'));
                bookmarksContent.querySelector('p').classList.toggle('text-gray-500', !htmlElement.classList.contains('dark'));
                return;
            }
            links.forEach(link => {
                const cardLink = document.createElement('a');
                cardLink.href = link.href;
                cardLink.target = "_blank";
                cardLink.rel = "noopener noreferrer";
                cardLink.title = link.href;
                cardLink.classList.add('bookmark-card-styled', 'hover:shadow-2xl', 'dark:hover:shadow-lg', 'rounded-xl');

                // Apply inline style for icon size and add mr-2 class
                const iconHtml = link.icon ? `<i data-lucide="${link.icon}" class="mr-2" style="width: 2.1em; height: 2.1em;"></i>` : '';

                cardLink.innerHTML = `
                    <div class="card-content-wrapper">
                        <h5 class="text-xl font-semibold mb-2 flex items-center card-title">
                            ${iconHtml}
                            <span>${link.title}</span>
                        </h5>
                        <p class="text-sm mb-4 flex-grow">${link.description || '點擊前往此連結。'}</p>
                        <div class="action-button-visual mt-auto font-medium">
                            <span>前往</span>
                            <i data-lucide="arrow-right"></i>
                        </div>
                    </div>
                `;
                bookmarksContent.appendChild(cardLink);
            });
        }

        // Function to load a category's bookmarks
        function loadCategory(categoryId) {
            const categoryData = bookmarksData.find(item => item.id === categoryId && !item.isDirectLink);
            if (categoryData) {
                currentCategoryTitle.textContent = categoryData.category;
                bookmarksContent.classList.remove('hidden');
                renderBookmarks(categoryData.links);
                localStorage.setItem('lastSelectedCategory', categoryId);
            } else {
                console.warn(`Category with ID '${categoryId}' not found.`);
                localStorage.removeItem('lastSelectedCategory');
            }
            setTimeout(() => lucide.createIcons(), 0);
        }

        // Event listener for the sidebar toggle button
        sidebarToggleButton.addEventListener('click', () => {
            const newState = isSidebarVisuallyOpen ? 'collapsed' : 'open';
            setSidebarVisualState(newState);
        });


        // --- Initial Setup on Page Load ---
        const savedTheme = localStorage.getItem('theme') || 'light';
        applyTheme(savedTheme);

        const initialSidebarState = localStorage.getItem('sidebarState') || 'collapsed';
        setSidebarVisualState(initialSidebarState);

        let categoryToLoadId = localStorage.getItem('lastSelectedCategory');
        let categoryIsValid = false;

        if (categoryToLoadId) {
            const categoryExists = bookmarksData.find(item => item.id === categoryToLoadId && !item.isDirectLink);
            if (categoryExists) {
                categoryIsValid = true;
            } else {
                localStorage.removeItem('lastSelectedCategory');
                categoryToLoadId = null;
            }
        }

        if (!categoryIsValid) {
            const firstLoadableCategory = bookmarksData.find(item => !item.isDirectLink);
            if (firstLoadableCategory) {
                categoryToLoadId = firstLoadableCategory.id;
            }
        }

        if (categoryToLoadId) {
            loadCategory(categoryToLoadId);
            const activeSidebarItem = document.querySelector(`#sidebar-links .sidebar-item[data-id='${categoryToLoadId}']`);
            if (activeSidebarItem) {
                document.querySelectorAll('#sidebar-links .sidebar-item.active').forEach(el => el.classList.remove('active'));
                activeSidebarItem.classList.add('active');
            }
        } else {
            currentCategoryTitle.textContent = "沒有可顯示的書籤";
            let messageP = document.createElement('p');
            messageP.classList.add('text-center', 'py-10');
            messageP.classList.toggle('text-gray-400', htmlElement.classList.contains('dark'));
            messageP.classList.toggle('text-gray-500', !htmlElement.classList.contains('dark'));
            messageP.textContent = '請先新增書籤類別。';
            bookmarksContent.innerHTML = '';
            bookmarksContent.appendChild(messageP);
            setTimeout(() => lucide.createIcons(), 0);
        }
    </script>
</body>
</html>
