<!DOCTYPE html>
<html lang="zh-TW">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ¡ƒåœ’åœ°æ‰€æ›¸ç±¤ç´¢å¼•</title>
    
    <!-- ç¦æ­¢å¿«å–çš„ Meta æ¨™ç±¤ -->
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">

    <!-- å¤–éƒ¨å‡½å¼åº« -->
    <script src="vue.global.prod.js"></script>
    <script src="lucide.min.js"></script>
    <link href="tailwind.min.css" rel="stylesheet">

    <!-- è‡ªè¨‚æ¨£å¼ -->
    <style>
        /* CSS è®Šæ•¸å®šç¾©ï¼Œç”¨æ–¼æ·ºè‰²æ¨¡å¼ä¸‹çš„é è¨­å€¼ */
        :root {
            --bootstrap-primary: #0d6efd;
            --bootstrap-primary-hover: #0b5ed7;
            --bootstrap-primary-active: #0a58ca;
            --highlight-bg-light: #fffbe0; /* æ·ºè‰²æ¨¡å¼ä¸‹çš„æ·¡é»ƒè‰²èƒŒæ™¯ */
            --highlight-border-light: #fcd34d; /* æ·ºè‰²æ¨¡å¼ä¸‹çš„é»ƒè‰²é‚Šæ¡† */
            --watermark-bg-light: rgba(252, 211, 77, 0.8); /* æµ®æ°´å°èƒŒæ™¯è‰² (æ·ºè‰²æ¨¡å¼) */
            --watermark-text-light: #6b4d00; /* æµ®æ°´å°æ–‡å­—è‰² (æ·ºè‰²æ¨¡å¼) */

            /* æ·ºè‰²æ¨¡å¼ä¸‹çš„é€šç”¨é¡è‰² */
            --body-bg: #f3f4f6;
            --body-text: #1f2937;
            --sidebar-bg: #e9ecef;
            --sidebar-text: #212529;
            --sidebar-header-text: #212529;
            --sidebar-time-h2-text: #212529;
            --sidebar-time-h2-border: #d1d5db;
            --sidebar-time-display-bg: #f9fafb;
            --sidebar-time-display-text: #374151;
            --main-bg: #f3f4f6;
            --current-category-title-text: #1f2937;
            --bookmark-card-bg: #ffffff;
            --card-title-text: #1f2937;
            --card-description-text: #4b5563;
            --sidebar-toggle-button-color: #374151;
            --sidebar-toggle-button-hover-bg: #e5e7eb;
        }

        /* æ·±è‰²æ¨¡å¼ä¸‹çš„ CSS è®Šæ•¸å®šç¾©ï¼Œè¦†è“‹æ·ºè‰²æ¨¡å¼çš„é è¨­å€¼ */
        html.dark {
            --bootstrap-primary-dark-bg: #0d6efd; /* ç¢ºä¿æ·±è‰²æ¨¡å¼ä¸‹ä¸»è¦é¡è‰²ä¸€è‡´ */
            --bootstrap-primary-dark-hover-bg: #3c87fd;
            --bootstrap-primary-dark-active-bg: #0b5ed7;
            --highlight-bg-dark: #332a00; /* æ·±è‰²æ¨¡å¼ä¸‹çš„æ·¡é»ƒè‰²èƒŒæ™¯ */
            --highlight-border-dark: #fcd34d; /* æ·±è‰²æ¨¡å¼ä¸‹çš„é»ƒè‰²é‚Šæ¡† */
            --watermark-bg-dark: rgba(252, 211, 77, 0.4); /* æµ®æ°´å°èƒŒæ™¯è‰² (æ·±è‰²æ¨¡å¼) */
            --watermark-text-dark: #fcd34d; /* æµ®æ°´å°æ–‡å­—è‰² (æ·±è‰²æ¨¡å¼) */

            /* æ·±è‰²æ¨¡å¼ä¸‹çš„é€šç”¨é¡è‰² */
            --body-bg: #0f172a;
            --body-text: #cbd5e1;
            --sidebar-bg: #1e293b;
            --sidebar-text: #e2e8f0;
            --sidebar-header-text: #f1f5f9;
            --sidebar-time-h2-text: #e2e8f0;
            --sidebar-time-h2-border: #374151;
            --sidebar-time-display-bg: #374151;
            --sidebar-time-display-text: #9ca3af;
            --main-bg: #0f172a;
            --current-category-title-text: #f1f5f9;
            --bookmark-card-bg: #1e293b;
            --card-title-text: #f1f5f9;
            --card-description-text: #94a3b8;
            --sidebar-toggle-button-color: #94a3b8;
            --sidebar-toggle-button-hover-bg: #334155;
        }

        /* å…¨å±€æ¨£å¼ - ä½¿ç”¨ CSS è®Šæ•¸ä¸¦å¼·åˆ¶å„ªå…ˆç´š */
        body {
            font-family: 'Inter', sans-serif;
            transition: background-color 0.3s ease, color 0.3s ease;
            background-color: var(--body-bg) !important;
            color: var(--body-text) !important;
        }

        body.modal-open { overflow: hidden; }

        /* æ»¾å‹•æ¢æ¨£å¼ */
        ::-webkit-scrollbar { width: 8px; height: 8px; }
        ::-webkit-scrollbar-track { background: var(--body-bg) !important; border-radius: 10px; } /* æ»¾å‹•æ¢è»Œé“é¡è‰²è·Ÿéš¨ä¸»é¡Œ */
        ::-webkit-scrollbar-thumb { background: #9ca3af !important; border-radius: 10px; }
        ::-webkit-scrollbar-thumb:hover { background: #6b7280 !important; }
        html.dark ::-webkit-scrollbar-thumb { background: #6b7280 !important; }
        html.dark ::-webkit-scrollbar-thumb:hover { background: #4b5563 !important; }


        /* å´é‚Šæ¬„æ¨£å¼ - ä½¿ç”¨ CSS è®Šæ•¸ä¸¦å¼·åˆ¶å„ªå…ˆç´š */
        #sidebar { 
            transition: width 0.3s ease-in-out, padding 0.3s ease-in-out; 
            background-color: var(--sidebar-bg) !important;
            color: var(--sidebar-text) !important;
        }

        #sidebar-header .font-semibold { color: var(--sidebar-header-text) !important; }
        #sidebar-header .font-semibold > i[data-lucide] + span { margin-left: 0.5rem; }

        .sidebar-item {
            display: flex; align-items: center; justify-content: flex-start;
            padding: 0.625rem 1rem; border-radius: 0.375rem;
            transition: background-color 0.2s ease-in-out, color 0.2s ease-in-out, padding 0.3s ease-in-out;
            width: 100%; cursor: pointer; overflow: hidden;
            color: var(--sidebar-text) !important;
        }

        .sidebar-item:hover { background-color: var(--bootstrap-primary-hover) !important; color: #ffffff !important; }
        html.dark .sidebar-item:hover { background-color: var(--bootstrap-primary-dark-hover-bg) !important; color: #f8fafc !important; }

        .sidebar-item.active { background-color: var(--bootstrap-primary) !important; color: #ffffff !important; }
        html.dark .sidebar-item.active { background-color: var(--bootstrap-primary-dark-active-bg) !important; color: #f8fafc !important; }

        #sidebar.collapsed .sidebar-item { justify-content: center; padding: 0.625rem 0.5rem; }
        #sidebar.collapsed #sidebar-header .font-semibold > span,
        #sidebar.collapsed .sidebar-item > span,
        #sidebar.collapsed #current-time-section h2,
        #sidebar.collapsed #current-time-section div { display: none; }
        #sidebar.collapsed #current-time-section { padding-top: 0; padding-bottom: 0; margin-top:0; margin-bottom:0; }
        #sidebar.collapsed #sidebar-header .font-semibold { justify-content: center; }
        #theme-toggle-button { margin-top: auto; }

        /* ç›®å‰æ™‚é–“å€å¡Šæ¨£å¼ - ä½¿ç”¨ CSS è®Šæ•¸ä¸¦å¼·åˆ¶å„ªå…ˆç´š */
        #current-time-section h2 { 
            color: var(--sidebar-time-h2-text) !important; 
            border-color: var(--sidebar-time-h2-border) !important; 
        }

        #current-time-display { 
            background-color: var(--sidebar-time-display-bg) !important; 
            color: var(--sidebar-time-display-text) !important; 
        }

        /* ä¸»è¦å…§å®¹å€å¡Šæ¨£å¼ - ä½¿ç”¨ CSS è®Šæ•¸ä¸¦å¼·åˆ¶å„ªå…ˆç´š */
        main { 
            background-color: var(--main-bg) !important; 
        }

        #current-category-title { color: var(--current-category-title-text) !important; }
        #current-category-title > i[data-lucide] { color: var(--bootstrap-primary) !important; }
        html.dark #current-category-title > i[data-lucide] { color: var(--bootstrap-primary-dark-hover-bg) !important; }

        /* æ›¸ç±¤å¡ç‰‡æ¨£å¼ - ä½¿ç”¨ CSS è®Šæ•¸ä¸¦å¼·åˆ¶å„ªå…ˆç´š */
        .bookmark-card-styled {
            display: block; overflow: hidden;
            transition: box-shadow 0.3s ease-in-out, background-color 0.3s ease-in-out;
            text-decoration: none;
            background-color: var(--bookmark-card-bg) !important;
            border-radius: 0.75rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            color: inherit; /* ä¿æŒç¹¼æ‰¿ï¼Œç”±çˆ¶å±¤ body æ§åˆ¶ */
            position: relative; /* ç‚ºäº†æµ®æ°´å°çš„çµ•å°å®šä½ */
        }

        .bookmark-card-styled:hover { box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05); }
        html.dark .bookmark-card-styled:hover { box-shadow: 0 10px 15px -3px rgba(0,0,0,0.7), 0 4px 6px -2px rgba(0,0,0,0.6); }

        .card-content-wrapper { padding: 1.25rem; display: flex; flex-direction: column; flex-grow: 1; height: 100%; }
        .card-title span { color: var(--card-title-text) !important; }
        .card-title + p { color: var(--card-description-text) !important; }
        .card-title > i[data-lucide] { color: var(--bootstrap-primary) !important; }
        html.dark .card-title > i[data-lucide] { color: var(--bootstrap-primary-dark-hover-bg) !important; }

        /* å‹•ä½œæŒ‰éˆ•æ¨£å¼ - ä½¿ç”¨ CSS è®Šæ•¸ä¸¦å¼·åˆ¶å„ªå…ˆç´š */
        .action-button-visual {
            display: inline-flex; align-items: center; justify-content: center; white-space: nowrap;
            background-color: var(--bootstrap-primary) !important; 
            color: #ffffff !important;
            padding-top: 0.5rem; padding-bottom: 0.5rem; padding-left: 1rem; padding-right: 1rem;
            border-radius: 0.5rem;
            transition-property: background-color, border-color, color, fill, stroke, opacity, box-shadow, transform, filter, backdrop-filter;
            transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
            transition-duration: 300ms;
            text-align: center;
        }
        html.dark .action-button-visual { background-color: var(--bootstrap-primary-dark-bg) !important; color: #f8fafc !important; }
        .bookmark-card-styled:hover .action-button-visual { background-color: var(--bootstrap-primary-hover) !important; }
        html.dark .bookmark-card-styled:hover .action-button-visual { background-color: var(--bootstrap-primary-dark-hover-bg) !important; }

        /* å´é‚Šæ¬„é–‹é—œæŒ‰éˆ•æ¨£å¼ - ä½¿ç”¨ CSS è®Šæ•¸ä¸¦å¼·åˆ¶å„ªå…ˆç´š */
        #sidebar-toggle-button { color: var(--sidebar-toggle-button-color) !important; }
        #sidebar-toggle-button:hover { background-color: var(--sidebar-toggle-button-hover-bg) !important; }

        /* Lucide åœ–ç¤ºé€šç”¨æ¨£å¼ */
        i[data-lucide] { display: inline-block; vertical-align: -0.2em; line-height: 1; flex-shrink: 0; }
        i[data-lucide]:not(.card-title > i[data-lucide]) { width: 1.25em; height: 1.25em; }
        i[data-lucide].card-title > i[data-lucide] { width: 2.1em; height: 2.1em; } /* ç¢ºä¿å¡ç‰‡æ¨™é¡Œåœ–ç¤ºå¤§å° */
        #current-category-title > i[data-lucide] { width: 1em; height: 1em; }

        /* æ›¸ç±¤å…§å®¹ç¶²æ ¼ä½ˆå±€ */
        #bookmarks-content { 
            display: grid; 
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); 
            gap: 1.5rem; 
            position: relative; /* ç¢ºä¿çµ•å°å®šä½çš„å­å…ƒç´ ç›¸å°æ–¼æ­¤å®¹å™¨ */
        }

        /* PDF æ‡¸æµ®é è¦½æ¨£å¼ */
        #pdf-popover {
            pointer-events: none;
            transition: opacity 0.2s ease-in-out;
            width: 297px;
            height: 415px;
        }

        /* --------------------------------------------------------------------- */
        /* çµ±ä¸€çš„æ·¡é»ƒè‰²é†’ç›®æç¤ºæ¨£å¼ (å‰3å€‹æœ€å¸¸é»æ“Šçš„å¡ç‰‡) */
        .bookmark-card-styled.highlighted {
            background-color: var(--highlight-bg-light) !important; 
            border: 2px solid var(--highlight-border-light) !important; 
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            transform: translateY(-2px); /* è¼•å¾®ä¸Šæµ®æ•ˆæœ */
        }

        html.dark .bookmark-card-styled.highlighted {
            background-color: var(--highlight-bg-dark) !important; 
            border: 2px solid var(--highlight-border-dark) !important; 
            box-shadow: 0 10px 15px -3px rgba(0,0,0,0.7), 0 4px 6px -2px rgba(0,0,0,0.6);
        }

        /* æµ®æ°´å°æ¨£å¼ */
        .last-accessed-watermark {
            position: absolute;
            bottom: 0.75rem; /* è·é›¢åº•éƒ¨ */
            right: 0.75rem; /* è·é›¢å³å´ */
            background-color: var(--watermark-bg-light);
            color: var(--watermark-text-light);
            padding: 0.25rem 0.5rem;
            border-radius: 0.375rem;
            font-size: 0.6rem; /* 12px */
            font-weight: 600;
            z-index: 10;
            white-space: nowrap; /* é˜²æ­¢æ–‡å­—æ›è¡Œ */
            opacity: 0.9;
            box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
        }

        html.dark .last-accessed-watermark {
            background-color: var(--watermark-bg-dark);
            color: var(--watermark-text-dark);
        }
        /* --------------------------------------------------------------------- */

        /* éæ¸¡æ•ˆæœçš„ CSS é¡åˆ¥ */
        .list-enter-active,
        .list-leave-active {
            /* å¢åŠ éæ¸¡æ™‚é–“åˆ° 1.5 ç§’ï¼Œä½¿ç”¨å½ˆè·³çš„ cubic-bezier å‡½æ•¸ */
            transition: all 1.5s cubic-bezier(0.68, -0.55, 0.265, 1.55); 
        }
        .list-enter-from {
            opacity: 0;
            /* è®“é€²å…¥çš„å¡ç‰‡å¾æ›´ä¸‹æ–¹ä¸”ç¸®å°çš„ç‹€æ…‹é€²å…¥ */
            transform: scale(0.5) translateY(200px); 
        }
        .list-leave-to {
            opacity: 0;
            /* è®“é›¢é–‹çš„å¡ç‰‡ç¸®å°ä¸¦å‘ä¸Šæ–¹é›¢é–‹ï¼Œä½¿å…¶æ›´æ˜é¡¯ */
            transform: scale(0.5) translateY(-200px); 
        }
        /* ç¢ºä¿é›¢é–‹çš„å…ƒç´ ä¸æœƒå½±éŸ¿ä½ˆå±€ï¼Œä¸¦åœ¨æœ€ä¸Šå±¤ */
        .list-leave-active {
            position: absolute;
            z-index: 10; /* ç¢ºä¿é›¢é–‹çš„å…ƒç´ åœ¨æœ€ä¸Šå±¤ */
            /* ç”±æ–¼ grid ä½ˆå±€çš„ç‰¹æ€§ï¼Œç•¶å…ƒç´ è¢«è¨­å®šç‚º absolute æ™‚ï¼Œå…¶ä½”ç”¨çš„ç©ºé–“æœƒç«‹å³è¢«é‡‹æ”¾ã€‚
               é€™ä½¿å¾— translateY çš„å‹•ç•«èµ·é»ä¸æ˜é¡¯ã€‚
               å„˜ç®¡ Vue çš„ TransitionGroup æœƒç›¡åŠ›è™•ç†ï¼Œä½† grid çš„å³æ™‚é‡æ’å¯èƒ½æœƒè¦†è“‹è¦–è¦ºæ•ˆæœã€‚
               é€éå¤§å¹…å¢åŠ å‹•ç•«æ™‚é–“å’Œä½ç§»ï¼Œå¸Œæœ›èƒ½è®“æ•ˆæœæ›´æ˜“æ–¼å¯Ÿè¦ºã€‚
            */
        }
        /* ç¢ºä¿åœ¨éæ¸¡æœŸé–“ï¼Œç¶²æ ¼ä½ˆå±€çš„å…ƒç´ èƒ½å¤ å¹³æ»‘ç§»å‹• */
        .list-move {
            /* å¢åŠ ç§»å‹•éæ¸¡æ™‚é–“ï¼Œä¸¦ä½¿ç”¨ç›¸åŒçš„ç·©å‹•å‡½æ•¸ï¼Œä¿æŒä¸€è‡´æ€§ */
            transition: transform 1.5s cubic-bezier(0.68, -0.55, 0.265, 1.55); 
        }
    </style>
</head>

<body>
    <div id="app" class="flex h-screen overflow-hidden">
        <!-- å´é‚Šæ¬„ -->
        <aside id="sidebar" class="p-4 flex flex-col overflow-y-auto shadow-lg z-20" :class="[isSidebarCollapsed ? 'w-16 collapsed' : 'w-48']">
            <!-- æ¨™é¡Œ -->
            <div id="sidebar-header" class="mb-6">
                <div class="text-2xl font-semibold flex items-center">
                    <i data-lucide="link" class="mr-2"></i>
                    <span v-show="!isSidebarCollapsed">æ›¸ç±¤ç´¢å¼•</span>
                </div>
            </div>

            <!-- åˆ†é¡é€£çµ -->
            <div id="sidebar-links" class="space-y-2 flex-grow">
                <a v-for="cat in bookmarks" :key="cat.id" :href="cat.isDirectLink ? cat.href : '#'" :title="cat.category" :target="cat.isDirectLink ? '_blank' : null" :rel="cat.isDirectLink ? 'noopener noreferrer' : null" class="sidebar-item" :class="{ 'active': cat.id === currentCategoryId }" @click.prevent="!cat.isDirectLink && selectCategory(cat.id)">
                    <i :data-lucide="cat.icon" class="mr-2"></i> <!-- æ–°å¢é–“éš” -->
                    <span v-show="!isSidebarCollapsed">{{ cat.category }}</span>
                </a>
            </div>
            
            <!-- ç›®å‰æ™‚é–“ -->
            <section id="current-time-section" class="mt-6 mb-2" v-show="!isSidebarCollapsed">
                <h2 class="text-lg font-semibold mb-2 pb-1 border-b">ç›®å‰æ™‚é–“</h2>
                <div id="current-time-display" class="text-sm p-3 rounded-md shadow-sm">
                    <p class="mb-1">æ—¥æœŸï¼š{{ currentDate }}</p>
                    <p>æ™‚é–“ï¼š{{ currentTime }}</p>
                </div>
            </section>

            <!-- ä¸»é¡Œåˆ‡æ›æŒ‰éˆ• -->
            <button id="theme-toggle-button" class="sidebar-item mt-4" title="åˆ‡æ›é¡¯ç¤ºä¸»é¡Œ" @click="toggleTheme">
                <!-- æ·»åŠ  :key="theme" ç¢ºä¿åœ–ç¤ºåœ¨ä¸»é¡Œåˆ‡æ›æ™‚é‡æ–°æ¸²æŸ“ -->
                <i :data-lucide="theme === 'dark' ? 'moon' : 'sun'" :key="theme" class="mr-2"></i> <!-- æ–°å¢é–“éš” -->
                <span v-show="!isSidebarCollapsed">åˆ‡æ›ä¸»é¡Œ</span>
            </button>
        </aside>

        <!-- ä¸»è¦å…§å®¹å€ -->
        <main :key="mainContentKey" class="flex-1 p-4 overflow-y-auto">
            <div class="flex items-center mb-6">
                <!-- å´é‚Šæ¬„é–‹é—œ -->
                <button id="sidebar-toggle-button" class="p-2 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 z-30 mr-3" title="é–‹å•Ÿ/æ”¶åˆå´é‚Šæ¬„" @click="toggleSidebar">
                    <span class="text-xl font-bold w-6 text-center">{{ isSidebarCollapsed ? 'â˜°' : 'â—€' }}</span>
                </button>
                <!-- ç›®å‰åˆ†é¡æ¨™é¡Œ -->
                <h1 id="current-category-title" class="text-3xl font-bold flex items-center" v-if="currentCategory">
                    <span>{{ currentCategory.category }}</span>
                    <!-- <i :data-lucide="currentCategory.icon" class="ml-3"></i> -->
                </h1>
            </div>

            <!-- æ›¸ç±¤å¡ç‰‡å…§å®¹ - ä½¿ç”¨ TransitionGroup åŒ…è£¹ -->
            <TransitionGroup name="list" tag="div" id="bookmarks-content">
                <a v-for="link in currentCategoryLinks" :key="link.href" :href="link.href" :title="link.href" :target="getLinkTarget(link)" :rel="getLinkTarget(link) === '_blank' ? 'noopener noreferrer' : null" :download="isDownloadable(link) ? '' : null" @click="handleLinkClick($event, link)" @mouseenter="handlePdfHover($event, link)" @mouseleave="hidePdfPopover" class="bookmark-card-styled hover:shadow-2xl dark:hover:shadow-lg rounded-xl" :class="{ 'highlighted': link.isHighlighted }">
                    <!-- æµ®æ°´å°ï¼šä¸Šæ¬¡å­˜å–æ™‚é–“ -->
                    <div v-if="link.isHighlighted && link.lastAccessedTimeFormatted" class="last-accessed-watermark">
                        ä¸Šæ¬¡å­˜å–: {{ link.lastAccessedTimeFormatted }}
                    </div>
                    <div class="card-content-wrapper">
                        <h5 class="text-xl font-semibold mb-2 flex items-center card-title">
                            <i v-if="link.icon" :data-lucide="link.icon" class="mr-2"></i>
                            <span>{{ link.title }}</span>
                        </h5>
                        <p class="text-sm mb-4 flex-grow" v-html="markdownToHtml(link.description || 'é»æ“Šä»¥ç¹¼çºŒã€‚')"></p>
                        <div class="action-button-visual mt-auto font-medium">
                            <span class="mr-2">{{ getButtonText(link) }}</span> <!-- æ–°å¢é–“éš” -->
                            <i :data-lucide="getButtonIcon(link)"></i>
                        </div>
                    </div>
                </a>
            </TransitionGroup>
        </main>

        <!-- PDF é è¦½ Modal -->
        <div v-if="pdfModal.visible" id="pdf-modal" class="fixed inset-0 bg-black bg-opacity-75 z-50 flex items-center justify-center p-4 transition-opacity duration-300" @click.self="closePdfModal">
            <div class="bg-white dark:bg-slate-800 rounded-lg shadow-2xl w-full h-full max-w-6xl flex flex-col">
                <div class="flex justify-between items-center p-4 border-b border-gray-200 dark:border-gray-700">
                    <h3 id="pdf-modal-title" class="text-xl font-semibold text-gray-900 dark:text-white truncate">{{ pdfModal.title }}</h3>
                    <button id="pdf-modal-close" @click="closePdfModal" class="text-gray-400 bg-transparent hover:bg-gray-200 dark:hover:bg-gray-600 hover:text-gray-900 dark:hover:text-white rounded-lg text-sm p-1.5 ml-auto inline-flex items-center">
                        <!-- <i data-lucide="x" class="w-6 h-6"></i> -->
                        <span class="text-xl font-bold w-6 text-center">âœ–</span>
                        <span class="sr-only">é—œé–‰è¦–çª—</span>
                    </button>
                </div>
                <div class="p-2 flex-grow">
                    <iframe id="pdf-iframe" class="w-full h-full border-0" :src="pdfModal.src"></iframe>
                </div>
            </div>
        </div>
        
        <!-- PDF æ‡¸æµ®é è¦½ Popover -->
        <div id="pdf-popover" ref="pdfPopover" class="hidden fixed z-[100] bg-white dark:bg-slate-800 border border-gray-300 dark:border-gray-600 rounded-lg shadow-xl overflow-hidden">
            <div class="w-full h-full p-1">
                <iframe id="pdf-popover-iframe" class="w-full h-full" :src="pdfPopoverState.src"></iframe>
            </div>
        </div>
    </div>

    <script>
        const { createApp, ref, reactive, onMounted, computed, watch, nextTick } = Vue;

        const app = createApp({
            setup() {
                // --- éŸ¿æ‡‰å¼ç‹€æ…‹ (Reactive State) ---
                const bookmarks = ref([
                    {
                        category: 'å…±é€šç³»çµ±ç¶²å€',
                        id: 'common',
                        icon: 'send-horizontal',
                        links: [
                        { title: 'åœ°æ‰€å“¡å·¥çŸ¥è­˜ç¶²', href: 'http://220.1.34.18:8888', description: 'æä¾›å…¬å‘Šã€å„èª²å®¤å°ˆå±¬å€ã€å“¡å·¥è³‡è¨Šã€æœƒè­°å®¤é ç´„ ... ç­‰åŠŸèƒ½', icon: 'layout-dashboard' },
                        { title: 'æ©Ÿé—œå…§éƒ¨äººäº‹æ¥­å‹™ç³»çµ±', href: 'https://webitr.tycg.gov.tw/WebITR/', description: 'æ¡ƒåœ’å¸‚æ”¿åºœå·®å‹¤ç³»çµ± https://webitr.tycg.gov.tw/WebITR/', icon: 'clock' },
                        { title: 'å…¬æ–‡æ•´åˆè³‡è¨Šç³»çµ±', href: 'https://odis.tycg.gov.tw/', description: 'å¸‚åºœå…¬æ–‡ç³»çµ± https://odis.tycg.gov.tw/', icon: 'book-marked' },
                        { title: 'æ¡ƒåœ’å¸‚æ”¿åºœå…¬å‹™é›²', href: 'https://tycgcloud.tycg.gov.tw/', description: 'æ¡ƒåœ’å¸‚æ”¿åºœå…¬å‹™é›²(å…§ç¶²) https://tycgcloud.tycg.gov.tw/', icon: 'cloud' },
                        { title: 'å…§å¤–ç¶²æª”æ¡ˆäº¤æ›ç³»çµ±', href: 'http://220.1.34.26:8008/', description: 'å…§ç¶²é›»è…¦æª”æ¡ˆäº¤æ›è‡³å¤–ç¶²çš„äº¤æ›ç³»çµ±ï¼Œå¤–ç¶²ä¸‹è¼‰è«‹è‡³ http://220.2.34.17:8008/', icon: 'file-output' },
                        { title: 'å·¥ä½œç”Ÿæ´»é»æ»´', href: 'http://220.1.34.18/album.asp', description: 'æœ¬æ‰€é›»å­ç›¸ç°¿', icon: 'image-play' },
                        { title: 'æ™ºæ…§æ§ç®¡ç³»çµ±', href: 'http://220.1.34.75:8080/', description: 'æä¾›åå¤šé …ç™»è¨˜è¼”åŠ©åŠŸèƒ½ä»¥åŠé¡¯ç¤ºæœ€æ–°å…¬å‘ŠåŠå„æ¥­å‹™å°å¹«æ‰‹é€£çµ', icon: 'monitor-smartphone' },
                        ],
                    },
                    {
                        category: 'å…¨åŠŸèƒ½æ«ƒå°',
                        id: 'counter',
                        icon: 'concierge-bell',
                        links: [
                        { title: 'åœ°æ”¿ç³»çµ±161-è·¨ç¸£å¸‚', href: 'http://220.1.34.161:9080/LandHA/', description: 'åœ°æ”¿ç³»çµ±è·¨ç¸£å¸‚æ“ä½œå°ˆå±¬ä¼ºæœå™¨ http://220.1.34.161:9080/LandHA/', icon: 'server-cog' },
                        { title: 'åœ°æ”¿ç³»çµ±60-æ¡ƒåœ’å¤–æ›', href: 'http://220.1.34.60:9080/LandHA/', description: 'åœ°æ”¿ç³»çµ±æ¡ƒåœ’å¤–æ›æ“ä½œå°ˆå±¬ä¼ºæœå™¨ http://220.1.34.60:9080/LandHA/', icon: 'server' },
                        { title: 'åœ°æ”¿ç³»çµ±118-å·¥ä½œç«™', href: 'http://220.1.34.118:9080/LandHA/', description: 'åœ°æ”¿ç³»çµ±å·¥ä½œç«™æ“ä½œå°ˆå±¬ä¼ºæœå™¨ http://220.1.34.118:9080/LandHA/', icon: 'server' },
                        { title: 'åœ°æ”¿æ™ºæ…§æ§ç®¡ç³»çµ±', href: 'http://220.1.34.75:8080/reg/', description: 'æä¾›åå¤šé …ç™»è¨˜æ¡ˆä»¶æŸ¥è©¢åŠæ§ç®¡çµ±è¨ˆåŠŸèƒ½çš„ç³»çµ± http://220.1.34.75:8080/reg/', icon: 'landmark' },
                        { title: 'åœ°æ”¿æ­·å²è³‡æ–™æŸ¥è©¢ç³»çµ±', href: 'http://220.1.34.15/NLOWeb/', description: 'åœ°æ”¿æ­·å²è³‡æ–™æŸ¥è©¢ç³»çµ± http://220.1.34.15/NLOWeb/', icon: 'history' },
                        { title: 'è¬„æœ¬æ«ƒå“¡æ©Ÿå¾Œå°ç®¡ç†', href: 'http://220.1.33.117/MGMT/', description: 'ç®¡ç†è¬„æœ¬æ«ƒå“¡æ©Ÿæœƒå“¡å¸³è™Ÿã€é¡¯ç¤ºçµ±è¨ˆè³‡æ–™', icon: 'settings-2' },
                        { title: 'ç°¡è¨Šç™¼é€ç´€éŒ„æŸ¥è©¢', href: 'http://220.1.34.75:8080/reg/sms', description: 'æä¾›åœ°æ”¿ç³»çµ±å‚³é€åœ°ç±ç•°å‹•å³æ™‚é€šç­‰ç°¡è¨Šç´€éŒ„æŸ¥è©¢ http://220.1.34.75:8080/reg/sms', icon: 'message-square-text' },
                        { title: 'ç™»è¨˜èª²å°ˆå±¬å…¥å£ç¶²ç«™', href: 'http://220.1.34.18/service/section/%E7%99%BB%E8%A8%98%E8%AA%B2/index.htm', description: 'æœ€æ–°æ¶ˆæ¯ã€èª²å‹™æœƒè­°ã€æ•™è‚²è¨“ç·´ã€æ³•è¦æ–°è¨Šã€è§£é‡‹å‡½ä»¤ã€ä¸‹è¼‰å°ˆå€ã€åœ°ç±æ¸…ç†ã€æ´»å‹•å‰ªå½±', icon: 'layout-list' },
                        ],
                    },
                    {
                        category: 'ç™»è¨˜èª²',
                        id: 'reg',
                        icon: 'file-signature',
                        links: [
                        { title: 'ç™»è¨˜èª²å°ˆå±¬å…¥å£ç¶²ç«™', href: 'http://220.1.34.18/service/section/%E7%99%BB%E8%A8%98%E8%AA%B2/index.htm', description: 'æœ€æ–°æ¶ˆæ¯ã€èª²å‹™æœƒè­°ã€æ•™è‚²è¨“ç·´ã€æ³•è¦æ–°è¨Šã€è§£é‡‹å‡½ä»¤ã€ä¸‹è¼‰å°ˆå€ã€åœ°ç±æ¸…ç†ã€æ´»å‹•å‰ªå½±', icon: 'layout-list' },
                        { title: 'ç™»è¨˜èª²ä¸‹è¼‰å€', href: 'http://220.1.34.18/service/section/%E7%99%BB%E8%A8%98%E8%AA%B2/download.htm', description: 'ç™»è¨˜èª²è‡ªè¡Œç¶­è­·ä¹‹å„å¼æª”æ¡ˆä¸‹è¼‰å°ˆå€', icon: 'download' },
                        { title: 'åœ°æ”¿æ™ºæ…§æ§ç®¡ç³»çµ±', href: 'http://220.1.34.75:8080/reg/', description: 'æä¾›åå¤šé …ç™»è¨˜æ¡ˆä»¶æŸ¥è©¢åŠæ§ç®¡çµ±è¨ˆåŠŸèƒ½çš„ç³»çµ± http://220.1.34.75:8080/reg/', icon: 'landmark' },
                        { title: 'åœ°æ”¿ç³»çµ±161-è·¨ç¸£å¸‚', href: 'http://220.1.34.161:9080/LandHA/', description: 'åœ°æ”¿ç³»çµ±è·¨ç¸£å¸‚æ“ä½œå°ˆå±¬ä¼ºæœå™¨ http://220.1.34.161:9080/LandHA/', icon: 'server-cog' },
                        { title: 'åœ°æ”¿ç³»çµ±60-æ¡ƒåœ’å¤–æ›', href: 'http://220.1.34.60:9080/LandHA/', description: 'åœ°æ”¿ç³»çµ±æ¡ƒåœ’å¤–æ›æ“ä½œå°ˆå±¬ä¼ºæœå™¨ http://220.1.34.60:9080/LandHA/', icon: 'server' },
                        { title: 'åœ°æ”¿ç³»çµ±205-ç™»è¨˜èª²1', href: 'http://220.1.34.205:9080/LandHA/', description: 'åœ°æ”¿ç³»çµ±ç™»è¨˜èª²æ“ä½œå°ˆå±¬ä¼ºæœå™¨ http://220.1.34.205:9080/LandHA/', icon: 'server' },
                        { title: 'åœ°æ”¿ç³»çµ±206-ç™»è¨˜èª²2', href: 'http://220.1.34.206:9080/LandHA/', description: 'åœ°æ”¿ç³»çµ±ç™»è¨˜èª²æ“ä½œå°ˆå±¬ä¼ºæœå™¨ http://220.1.34.206:9080/LandHA/', icon: 'server' },
                        { title: 'åœ°æ”¿ç³»çµ±162-ç½°é°è£è™•å°ˆç”¨', href: 'http://220.1.34.162:9080/LandHA/', description: 'åœ°æ”¿ç³»çµ±çµ¦ç½°é°è£è™•å°ˆç”¨ä¼ºæœå™¨ http://220.1.34.162:9080/LandHA/', icon: 'server' },
                        { title: 'åœ°æ”¿æ­·å²è³‡æ–™æŸ¥è©¢ç³»çµ±', href: 'http://220.1.34.15/NLOWeb/', description: 'åœ°æ”¿æ­·å²è³‡æ–™æŸ¥è©¢ç³»çµ± http://220.1.34.15/NLOWeb/', icon: 'history' },
                        { title: 'åœŸåœ°åƒè€ƒè³‡è¨Šæª”æŸ¥è©¢ç³»çµ±', href: 'http://220.1.34.213/ref/jsp/security/login.jsp', description: 'åœŸåœ°åƒè€ƒè³‡è¨Šæª”æŸ¥è©¢ç³»çµ± http://220.1.34.213/ref/jsp/security/login.jsp', icon: 'file-search' },
                        { title: 'è¬„æœ¬æ«ƒå“¡æ©Ÿå¾Œå°ç®¡ç†', href: 'http://220.1.33.117/MGMT/', description: 'ç®¡ç†è¬„æœ¬æ«ƒå“¡æ©Ÿæœƒå“¡å¸³è™Ÿã€é¡¯ç¤ºçµ±è¨ˆè³‡æ–™', icon: 'settings-2' },
                        { title: 'ç§æ³•äººè³¼ç½®ä½å®…', href: 'http://220.1.33.80/PcQ.aspx', description: 'ç§æ³•äººè³¼ç½®ä½å®… http://220.1.33.80/PcQ.aspx', icon: 'building' },
                        { title: 'å…§æ”¿éƒ¨-åœ°ç±ç¸½æ­¸æˆ¶ç³»çµ±', href: 'https://landowners.land.moi.gov.tw/', description: 'å€‹äººåœ°ç±è³‡æ–™é›†ä¸­æŸ¥è©¢å¹³å°ï¼Œæ•´åˆåœŸåœ°ã€å»ºç‰©æ‰€æœ‰æ¬Šè³‡è¨Š https://landowners.land.moi.gov.tw/', icon: 'folder-lock' },
                        { title: 'å…§æ”¿éƒ¨-æ•¸ä½æ«ƒå°', href: 'http://220.5.61.14/', description: 'å…§æ”¿éƒ¨æ•¸ä½æ«ƒè‡ºå…¬å‹™ç«¯ç¶²ç«™ http://220.5.61.14/', icon: 'monitor-smartphone' },
                        { title: 'å…§æ”¿éƒ¨-ç½•ç”¨å­—æŸ¥è©¢ç³»çµ±', href: 'http://220.5.61.32/MOILAND/', description: 'å…§æ”¿éƒ¨é–‹ç™¼å»ºç½®ä¹‹ç½•ç”¨å­—æŸ¥è©¢ç³»çµ± http://220.5.61.32/MOILAND/', icon: 'spell-check' },
                        { title: 'å…§æ”¿éƒ¨-æˆ¶å½¹æ”¿é›»å­é–˜é–€ç³»çµ±', href: 'https://210.241.18.131/', description: 'å…§æ”¿éƒ¨æˆ¶å½¹æ”¿é›»å­é–˜é–€ç³»çµ± https://210.241.18.131/', icon: 'door-open' },
                        { title: 'å…§æ”¿éƒ¨-æœªè¾¦ç¹¼æ‰¿', href: 'http://220.1.33.37:8091/OIB6/Login.jsp', description: 'å…§æ”¿éƒ¨æœªè¾¦ç¹¼æ‰¿ç™»è¨˜åœŸåœ°åŠå»ºç‰©ç®¡ç†ç³»çµ± http://220.1.33.37:8091/OIB6/Login.jsp', icon: 'user-x' },
                        { title: 'å…§æ”¿éƒ¨-åœ°ç±æ¸…ç†', href: 'http://220.1.33.79:8080/TAZQ/index.jsp', description: 'å…§æ”¿éƒ¨åœ°ç±æ¸…ç†ç®¡ç†ç³»çµ± http://220.1.33.79:8080/TAZQ/index.jsp', icon: 'files' },
                        { title: 'å…§æ”¿éƒ¨-ç·šä¸Šç”³è¾¦', href: 'http://220.5.61.17/cms/', description: 'å…§æ”¿éƒ¨ç·šä¸Šç”³è¾¦ç³»çµ± http://220.5.61.17/cms/', icon: 'file-plus-2' },
                        { title: 'å…§æ”¿éƒ¨-é›»å­ç”¢æ¬Šæ†‘è­‰å¾Œå°', href: 'https://220.5.61.73/etd-manager/', description: 'å…§æ”¿éƒ¨é–‹ç™¼æä¾›é›»å­ç”¢æ¬Šæ†‘è­‰ç®¡ç†åŠŸèƒ½... https://220.5.61.73/etd-manager/', icon: 'shield-check' },
                        { title: 'å…§æ”¿éƒ¨-æŠµæŠ¼æ¬Šç·šä¸Šç”³è¾¦ç³»çµ±ç®¡ç†å¾Œå°', href: 'https://220.5.61.73/moa-manager/', description: 'å…§æ”¿éƒ¨æŠµæŠ¼æ¬Šç·šä¸Šç”³è¾¦ç³»çµ±ç®¡ç†å¾Œå° ... https://220.5.61.73/moa-manager/', icon: 'file-lock-2' }
                        ],
                    },
                    {
                        category: 'æ¸¬é‡èª²',
                        id: 'sur',
                        icon: 'ruler',
                        links: [
                        { title: 'æ¸¬é‡èª²å°ˆå±¬å…¥å£ç¶²ç«™', href: 'http://220.1.34.18/service/section/%E6%B8%AC%E9%87%8F%E8%AA%B2/index.htm', description: 'æ³•é™¢åˆ¤æ±ºæ¡ˆä¾‹ã€æœƒè­°ç´€éŒ„ã€æ³•ä»¤è¦ç¯„ã€æ¸¬é‡æˆæœäº¤æ›ã€æ‡‰ç”¨è»Ÿé«”ã€å¸¸ç”¨è¡¨æ ¼ ...', icon: 'layout-list' },
                        { title: 'æ¸¬é‡èª²ä¸‹è¼‰å€', href: 'http://220.1.34.18/service/section/%E6%B8%AC%E9%87%8F%E8%AA%B2/feedback.htm', description: 'æ¸¬é‡èª²è‡ªè¡Œç¶­è­·ä¹‹å„å¼æª”æ¡ˆä¸‹è¼‰å°ˆå€', icon: 'download' },
                        { title: 'åœ°æ”¿ç³»çµ±207-æ¸¬é‡èª²1', href: 'http://220.1.34.207:9080/LandHA/', description: 'åœ°æ”¿ç³»çµ±æ¸¬é‡èª²æ“ä½œå°ˆå±¬ä¼ºæœå™¨ http://220.1.34.207:9080/LandHA/', icon: 'server' },
                        { title: 'åœ°æ”¿ç³»çµ±62-æ¸¬é‡èª²2', href: 'http://220.1.34.62:9080/LandHA/', description: 'åœ°æ”¿ç³»çµ±æ¸¬é‡èª²æ“ä½œå°ˆå±¬ä¼ºæœå™¨ http://220.1.34.62:9080/LandHA/', icon: 'server' },
                        { title: 'å»ºç®¡åœ–è³‡ä»‹æ¥ç³»çµ±', href: 'http://220.1.33.43:8080/Q14Web/', description: 'å»ºç‰©ç¬¬ä¸€æ¬¡æ¸¬é‡-ä½¿ç”¨åŸ·ç…§è³‡è¨ŠåŠç«£å·¥åœ–ä»‹æ¥ç³»çµ± http://220.1.33.43:8080/Q14Web/', icon: 'map' },
                        { title: 'æ¸¬é‡é€¾æœŸæ¡ˆä»¶æŸ¥è©¢', href: 'http://220.1.34.75:8080/sur/expire', description: 'æ¸¬é‡é€¾æœŸæ¡ˆä»¶æŸ¥è©¢ http://220.1.34.75:8080/sur/expire', icon: 'calendar-clock' },
                        { title: 'é‡æ¸¬æ›ç‹€é€šçŸ¥æ›¸ç³»çµ±', href: 'http://220.1.34.211:9080/XDT98/', description: 'é‡æ¸¬æ›ç‹€é€šçŸ¥æ›¸ç³»çµ± http://220.1.34.211:9080/XDT98/', icon: 'file-text' },
                        ],
                    },
                    {
                        category: 'åœ°åƒ¹èª²',
                        id: 'val',
                        icon: 'tags',
                        links: [
                        { title: 'åœ°åƒ¹èª²å°ˆå±¬å…¥å£ç¶²ç«™', href: 'http://220.1.34.18/service/section/%E8%A1%8C%E6%94%BF%E8%AA%B2/fram.htm', description: 'æœ€æ–°æ¶ˆæ¯ã€æœƒè­°ç´€éŒ„ã€è¡¨å–®ä¸‹è¼‰ ...', icon: 'layout-list' },
                        { title: 'åœ°åƒ¹èª²ä¸‹è¼‰å€', href: 'http://220.1.34.18/service/section/%E8%A1%8C%E6%94%BF%E8%AA%B2/fram.htm', description: 'åœ°åƒ¹èª²è‡ªè¡Œç¶­è­·ä¹‹å„å¼æª”æ¡ˆä¸‹è¼‰å°ˆå€', icon: 'download' },
                        { title: 'åœ°æ”¿ç³»çµ±156-åœ°åƒ¹èª²', href: 'http://220.1.34.156:9080/LandHA/', description: 'åœ°æ”¿ç³»çµ±åœ°åƒ¹èª²æ“ä½œå°ˆå±¬ä¼ºæœå™¨ http://220.1.34.156:9080/LandHA/', icon: 'server' },
                        { title: 'å¯¦åƒ¹ç™»éŒ„æ¡ˆä»¶æ§ç®¡', href: 'http://220.1.34.75:8080/prc/realprice', description: 'å¯¦åƒ¹ç™»éŒ„æ¡ˆä»¶æ§ç®¡é é¢ http://220.1.34.75:8080/prc/realprice', icon: 'file-check-2' },
                        { title: 'å¯¦åƒ¹ç™»éŒ„JSONè³‡æ–™è§£æ', href: 'http://220.1.34.75:8080/prc/json-converter', description: 'å¯¦åƒ¹ç™»éŒ„JSONè³‡æ–™è§£æ http://220.1.34.75:8080/prc/json-converter', icon: 'file-json' },
                        { title: 'ä¸å‹•ç”¢äº¤æ˜“æˆäº¤è³‡è¨Šç™»éŒ„æ©Ÿåˆ¶ç³»çµ±', href: 'http://220.5.61.195:8080/RPM/', description: 'ä¸å‹•ç”¢äº¤æ˜“æˆäº¤è³‡è¨Šç™»éŒ„æ©Ÿåˆ¶ç³»çµ± http://220.5.61.195:8080/RPM/', icon: 'database-zap' },
                        { title: 'äº”æ–¹å€ä¼°ç³»çµ±', href: 'http://220.1.34.12/TomMis/', description: 'åœ°åƒ¹å€æ®µåŠƒåˆ†åŠå€æ®µåœ°åƒ¹ä¼°åƒ¹ä½œæ¥­ç³»çµ± http://220.1.34.12/TomMis/', icon: 'area-chart' },
                        { title: 'å¯¦åƒ¹ç™»éŒ„æ¸…ç†ç³»çµ±', href: 'http://220.1.34.12/moi_estate/', description: 'å¯¦åƒ¹ç™»éŒ„æ¸…ç†ç³»çµ± http://220.1.34.12/moi_estate/', icon: 'file-scan' },
                        { title: 'å¯¦åƒ¹ç™»éŒ„ç°¡è¨Šç³»çµ±', href: 'http://220.1.34.221/', description: 'å¯¦åƒ¹ç™»éŒ„ç°¡è¨Šç³»çµ± http://220.1.34.221/', icon: 'message-square-more' },
                        ],
                    },
                    {
                        category: 'è¡Œæ”¿èª²',
                        id: 'adm',
                        icon: 'briefcase',
                        links: [
                        { title: 'è¡Œæ”¿èª²å°ˆå±¬å…¥å£ç¶²ç«™', href: 'http://220.1.34.18/service/section/04/index.htm', description: 'æœ€æ–°æ¶ˆæ¯ã€å¹´åº¦è¨ˆç•«ã€å…¬æ–‡ç¨½å‚¬ ...', icon: 'layout-list' },
                        { title: 'è¡Œæ”¿èª²ä¸‹è¼‰å€', href: 'http://220.1.34.18/service/section/04/download.htm', description: 'è¡Œæ”¿èª²è‡ªè¡Œç¶­è­·å„å¼ä¸‹è¼‰å°ˆå€', icon: 'download' },
                        { title: 'æª”æ¡ˆçŸ¥è­˜åº«', href: 'http://220.1.34.18/service/section/archives/archives.html', description: 'æª”æ¡ˆä½œæ¥­è¦åŠƒã€æª”æ¡ˆæ‡‰ç”¨ã€æª”æ¡ˆåˆ†é¡è¡¨ã€æœƒè­°è¨˜éŒ„ ...', icon: 'archive' },
                        { title: 'åœ°æ”¿ç³»çµ±156-è¡Œæ”¿èª²', href: 'http://220.1.34.156:9080/LandHA/', description: 'åœ°æ”¿ç³»çµ±è¡Œæ”¿èª²æ“ä½œå°ˆå±¬ä¼ºæœå™¨ http://220.1.34.156:9080/LandHA/', icon: 'server' },
                        { title: 'ééƒ½å¸‚åœŸåœ°ä½¿ç”¨ç·¨å®šç®¡ç†ç³»çµ±', href: 'http://220.1.34.12:8080/LandHA/', description: 'ééƒ½å¸‚åœŸåœ°ä½¿ç”¨ç·¨å®šç®¡ç†ç³»çµ± http://220.1.34.12:8080/LandHA/', icon: 'map-pin' },
                        { title: 'æª”æ¡ˆæ‡‰ç”¨é ç´„ç”³è«‹æ§ç®¡ç³»çµ±', href: 'http://220.1.34.75:8080/adm/file', description: 'æ°‘çœ¾æª”æ¡ˆæ‡‰ç”¨æœå‹™ç”³è«‹æ§ç®¡ http://220.1.34.75:8080/adm/file', icon: 'file-archive' },
                        { title: 'åœŸåœ°åƒè€ƒè³‡è¨Šæª”æŸ¥è©¢ç³»çµ±', href: 'http://220.1.34.213/ref/jsp/security/login.jsp', description: 'åœŸåœ°åƒè€ƒè³‡è¨Šæª”æŸ¥è©¢ç³»çµ± http://220.1.34.213/ref/jsp/security/login.jsp', icon: 'file-search' },
                        ],
                    },
                    {
                        category: 'è³‡è¨Šèª²',
                        id: 'inf',
                        icon: 'computer',
                        links: [
                        { title: 'è³‡è¨Šèª²å°ˆå±¬å…¥å£ç¶²ç«™', href: 'http://220.1.34.18/service/section/%E8%B3%87%E8%A8%8A%E8%AA%B2/', description: 'æœ€æ–°æ¶ˆæ¯ã€è¡¨å–®ä¸‹è¼‰ã€æœƒè­°è¨˜éŒ„ ...', icon: 'layout-list' },
                        { title: 'è³‡è¨Šèª²è¡¨å–®ä¸‹è¼‰', href: 'http://220.1.34.18/service/section/%E8%B3%87%E8%A8%8A%E8%AA%B2/download.html', description: 'æä¾›å„å¼è³‡è¨Šèª²ç”³è«‹è¡¨å–®ä¸‹è¼‰', icon: 'download' },
                        { title: 'åœ°æ”¿è³‡è¨Šç³»çµ±ç›£æ§', href: 'http://220.1.34.75:8080/inf/dashboard', description: 'ä»¥å„€è¡¨æ¿å‘ˆç¾æœ€å³æ™‚çš„ç³»çµ±ç‹€æ…‹ http://220.1.34.75:8080/inf/dashboard', icon: 'tv' },
                        { title: '111æ•¸ç™¼éƒ¨æ”¿åºœç°¡è¨Šå¹³å°', href: 'https://111.gov.tw/psms_web/', description: 'æ”¿åºœå°ˆå±¬çŸ­ç¢¼ç°¡è¨Šå¹³è‡º(å¤–ç¶²) https://111.gov.tw/psms_web/', icon: 'message-circle' },
                        { title: 'åœ°æ”¿ç³»çµ±17.20-æœ¬æ‰€æ¸¬è©¦æ©Ÿ', href: 'http://192.168.17.20:9080/LandHA/', description: 'åœ°æ”¿ç³»çµ±-è·¨ç¸£å¸‚æ¸¬è©¦æ©Ÿ http://192.168.17.20:9080/LandHA/', icon: 'server' },
                        { title: 'åœ°æ”¿ç³»çµ±17.21-æ¡ƒåœ’å¤–æ›æ¸¬è©¦æ©Ÿ', href: 'http://192.168.17.21:9080/LandHA/', description: 'åœ°æ”¿ç³»çµ±-æ¡ƒåœ’å¤–æ›æ¸¬è©¦æ©Ÿ http://192.168.17.21:9080/LandHA/', icon: 'server' },
                        { title: 'åœ°æ”¿ç³»çµ±17.22-è·¨ç¸£å¸‚æ¸¬è©¦æ©Ÿ', href: 'http://192.168.17.22:9080/LandHA/', description: 'åœ°æ”¿ç³»çµ±-è·¨ç¸£å¸‚æ¸¬è©¦æ©Ÿ http://192.168.17.22:9080/LandHA/', icon: 'server' },
                        { title: 'æ¡ˆä»¶è¾¦ç†æƒ…å½¢é€šçŸ¥ç³»çµ±', href: 'http://220.1.34.221:8080/SMS98/', description: 'ç²¾èª é–‹ç™¼ä¹‹ç³»çµ±é€éã€Œä¸­è¯é›»ä¿¡è¨Šæ¯ä¸­å¿ƒAPIã€å‚³é€æ¡ˆä»¶è¾¦ç†ç‹€æ…‹ç°¡è¨ŠåŠé›»å­éƒµä»¶ http://220.1.34.221:8080/SMS98/', icon: 'message-circle-more' },
                        { title: 'ä¾¿æ°‘è§¸æ§æŸ¥è©¢æ§åˆ¶å°', href: 'http://220.1.34.211:9080/touch/', description: 'ä¾¿æ°‘è§¸æ§æŸ¥è©¢æ§åˆ¶å° http://220.1.34.211:9080/touch/', icon: 'monitor' },
                        { title: 'SRMAS æ©Ÿæˆ¿å¤©æ°£åœ–', href: 'http://220.1.34.75:8080/inf/weather/', description: 'æ©Ÿæˆ¿ç¶²è·¯åŠä¸»è¦ç³»çµ±ç‹€æ…‹é¡¯ç¤º http://220.1.34.75:8080/inf/weather/', icon: 'cloud-sun-rain' },
                        { title: 'è³‡è¨Šèª²ä¼‘é–’æ™‚å…‰', href: 'http://220.1.34.18/service/section/%E8%B3%87%E8%A8%8A%E8%AA%B2/time.html', description: 'è¼•é¬†ä¸€ä¸‹ ... ğŸ˜€', icon: 'smile' },
                        // å¾å¸¸ç”¨è¡¨å–®ä¸‹è¼‰ç§»å‹•éä¾†çš„è³‡è¨Šèª²æœ¬æœˆè¼ªå€¼è¡¨
                        { title: 'è³‡è¨Šèª²æœ¬æœˆè¼ªå€¼è¡¨', href: 'http://220.1.34.18/service/section/%E8%B3%87%E8%A8%8A%E8%AA%B2/news/%E8%B3%87%E8%A8%8A%E8%AA%B2%E8%BC%AA%E5%80%BC%E8%A1%A8.pdf', description: 'è³‡è¨Šèª²æœ¬æœˆä»½æ¯æ—¥å·¥ä½œè¼ªå€¼è¡¨', icon: 'refresh-ccw-dot' },
                        ],
                    },
                    {
                        category: 'äººäº‹å®¤',
                        id: 'hr',
                        icon: 'users',
                        links: [
                        { title: 'äººäº‹å®¤å°ˆå±¬å…¥å£ç¶²ç«™', href: 'http://220.1.34.18/service/section/%E4%BA%BA%E4%BA%8B%E5%AE%A4/index.htm', description: 'æœ€æ–°æ¶ˆæ¯ã€è¡¨å–®ä¸‹è¼‰ã€è·æŒæ¥­å‹™ ...', icon: 'layout-list' },
                        { title: 'äººäº‹å®¤å„å¼è¡¨å–®ä¸‹è¼‰', href: 'http://220.1.34.18/service/section/%E4%BA%BA%E4%BA%8B%E5%AE%A4/download.html', description: 'æä¾›å„å¼äººäº‹ç›¸é—œç”³è«‹è¡¨å–®ä¸‹è¼‰', icon: 'user' },
                        // å·²æ›´æ–°çš„ã€Œå·®å‹¤æ›´æ­£å–®ã€é€£çµ
                        { title: 'å·®å‹¤æ›´æ­£å–®', href: 'http://220.1.34.18/service/section/%E4%BA%BA%E4%BA%8B%E5%AE%A4/download/107/00%E6%A1%83%E5%9C%92%E5%9C%B0%E6%94%BF%E4%BA%8B%E5%8B%99%E6%89%80%E5%8A%A0%E7%8F%AD%E8%AB%8B%E5%81%87%E6%9B%B4%E6%AD%A3%E7%94%B3%E8%AB%8B%E8%A1%A8.pdf', description: 'æä¾›å¿˜åˆ·å¡ç­‰ç›¸é—œå·®å‹¤æ›´æ­£ç”³è«‹å–®ä¸‹è¼‰ï¼Œè«‹å¡«å¦¥æ ¸ç« å¾Œé€äº¤äººäº‹å®¤è¾¦ç†ã€‚', icon: 'file-pen' },
                        { title: 'å·®å‹¤ç³»çµ±æ“ä½œæ‰‹å†Š', href: 'http://220.1.34.18/service/section/%E4%BA%BA%E4%BA%8B%E5%AE%A4/pdf//WebITR2/WebITR2.0%E4%B8%80%E8%88%87%E4%BA%BA%E5%93%A1%E6%93%8D%E4%BD%9C%E6%89%8B%E5%86%8A_2_1_0_32.pdf', description: 'æä¾›å®Œæ•´ä¸€èˆ¬åŒä» WEBITR 2.0 æ“ä½œæ‰‹å†Š', icon: 'book-open' },
                        { title: 'å„å¼å·®å‹¤åˆ·å¡ç¯„ä¾‹', href: 'http://220.1.34.18/service/section/%E4%BA%BA%E4%BA%8B%E5%AE%A4/pdf/%E5%88%B7%E5%8D%A1%E7%AF%84%E4%BE%8B1030601.pdf', description: 'æä¾›å„å¼åˆ·å¡ç¯„ä¾‹æ•™å­¸', icon: 'fingerprint' },
                        { title: 'å¦‚ä½•æŸ¥è©¢å·®å‹¤è¨˜éŒ„', href: 'http://220.1.34.18/service/section/%E4%BA%BA%E4%BA%8B%E5%AE%A4/pdf/WebITR2/%E6%9F%A5%E8%A9%A2%E5%87%BA%E5%8B%A4%E8%A8%98%E9%8C%84%E6%95%99%E5%AD%B8.pdf', description: 'æä¾›ç°¡æ˜“å·®å‹¤è¨˜éŒ„æŸ¥è©¢æ­¥é©Ÿ', icon: 'history' },
                        { title: 'å·®å‹¤æ¡ˆä»¶ç”³è«‹å–æ¶ˆæ•™å­¸', href: 'http://220.1.34.18/service/section/%E4%BA%BA%E4%BA%8B%E5%AE%A4/pdf/WebITR2/%E5%B7%AE%E5%8B%A4%E6%A1%88%E4%BB%B6%E7%94%B3%E8%AB%8B%E5%8F%96%E6%B6%88%E6%95%99%E5%AD%B8.pdf', description: 'æä¾›ç°¡æ˜“å‡ºå·®åŠ ç­å–æ¶ˆæ•™å­¸', icon: 'calendar-x' },
                        { title: 'è²»ç”¨ç”³è«‹æ•™å­¸', href: 'http://220.1.34.18/service/section/%E4%BA%BA%E4%BA%8B%E5%AE%A4/pdf/WebITR2/%E8%B2%BB%E7%94%A8%E7%94%B3%E8%AB%8B%E6%95%99%E5%AD%B8.pdf', description: 'æä¾›ç°¡æ˜“ç”³è«‹å·®æ—…è²»ã€åŠ ç­è²»æ•™å­¸', icon: 'banknote' },
                        { title: 'å€‹äººè³‡æ–™ç›¸é—œæ•™å­¸', href: 'http://220.1.34.18/service/section/%E4%BA%BA%E4%BA%8B%E5%AE%A4/pdf/WebITR2/%E5%80%8B%E4%BA%BA%E8%B3%87%E6%96%99%E7%9B%B8%E9%97%9C%E6%95%99%E5%AD%B8.pdf', description: 'æä¾›ç°¡æ˜“æŸ¥è©¢åŸºæœ¬è³‡æ–™ã€ä¿®æ”¹é›»å­éƒµä»¶ã€å¸³è™Ÿå¯†ç¢¼...ç­‰å·®å‹¤ç³»çµ±åŠŸèƒ½æ•™å­¸', icon: 'user-cog' },
                        { title: 'è«‹å‡è¦å®š', href: 'http://220.1.34.18/service/section/%E4%BA%BA%E4%BA%8B%E5%AE%A4/pdf/%E8%AB%8B%E5%81%87%E5%92%8C%E4%BC%91%E5%81%87/104%E7%B5%A6%E5%81%87%E4%B8%80%E8%A6%BD%E8%A1%A8_002.pdf', description: 'æä¾›è«‹å‡è¦å®šPDFæª¢è¦–', icon: 'file-text' },
                        { title: 'å¦‚ä½•æŸ¥è©¢ä¼‘å‡ç´€éŒ„', href: 'http://220.1.34.18/service/section/%E4%BA%BA%E4%BA%8B%E5%AE%A4/pdf/WebITR2/%E5%A6%82%E4%BD%95%E6%9F%A5%E8%A9%A2%E4%BC%91%E5%81%87%E7%B4%80%E9%8C%84.pdf', description: 'æä¾›ç°¡æ˜“æŸ¥è©¢å·²ä¼‘å‡å¤©æ•¸æŸ¥è©¢æ­¥é©Ÿ', icon: 'calendar-search' },
                        { title: 'ç”³è«‹ä¼‘å‡æ•™å­¸', href: 'http://220.1.34.18/service/section/%E4%BA%BA%E4%BA%8B%E5%AE%A4/pdf/WebITR2/%E4%BC%91%E5%81%87%E7%94%B3%E8%AB%8B%E6%95%99%E5%AD%B8.pdf', description: 'æä¾›ç°¡æ˜“ç”³è«‹ä¼‘å‡æ•™å­¸', icon: 'calendar-plus' },
                        { title: 'ç”³è«‹å…¬å‡è£œä¼‘æ•™å­¸', href: 'http://220.1.34.18/service/section/%E4%BA%BA%E4%BA%8B%E5%AE%A4/pdf/WebITR2/%E5%85%AC%E5%81%87%E8%A3%9C%E4%BC%91%E7%94%B3%E8%AB%8B%E6%95%99%E5%AD%B8.pdf', description: 'æä¾›ç°¡æ˜“ç”³è«‹å…¬å‡è£œä¼‘æ•™å­¸', icon: 'briefcase' },
                        { title: 'è«‹å‡å‡ºåœ‹æ•™å­¸', href: 'http://220.1.34.18/service/section/%E4%BA%BA%E4%BA%8B%E5%AE%A4/pdf/WebITR2/%E5%87%BA%E5%9C%8B%E8%AB%8B%E5%81%87%E7%94%B3%E8%AB%8B%E6%95%99%E5%AD%B8.pdf', description: 'æä¾›ç°¡æ˜“å‡ºåœ‹è«‹å‡æ•™å­¸', icon: 'plane' },
                        ],
                    },
                    {
                        category: 'æœƒè¨ˆå®¤',
                        id: 'acc',
                        icon: 'calculator',
                        links: [
                        { title: 'æœƒè¨ˆå®¤(å…§éƒ¨æ§åˆ¶)å°ˆå±¬å…¥å£ç¶²ç«™', href: 'http://220.1.34.18/service/section/%E6%9C%83%E8%A8%88%E5%AE%A4/index.htm', description: 'åƒè€ƒè³‡æ–™ã€æœƒè­°ç´€éŒ„ã€å…§æ§åˆ¶åº¦ ...', icon: 'layout-list' },
                        ],
                    },
                    {
                        category: 'å¸¸ç”¨è¡¨å–®ä¸‹è¼‰',
                        id: 'files',
                        icon: 'file-down',
                        links: [
                        { title: 'ã€æœ¬æ‰€ã€‘é›»è…¦å•é¡Œè™•ç†è¡¨', href: 'http://220.1.34.18/service/section/%E8%B3%87%E8%A8%8A%E8%AA%B2/%E5%B8%B8%E7%94%A8%E8%A1%A8%E6%A0%BC/%E9%9B%BB%E8%85%A6%E4%BD%9C%E6%A5%AD%E7%B3%BB%E7%B5%B1%E4%BD%BF%E7%94%A8%E8%80%85%E5%95%8F%E9%A1%8C%E5%8F%8A%E8%99%95%E7%90%86%E6%83%85%E5%BD%A2%E7%B4%80%E9%8C%84%E8%A1%A8(%E6%A9%AB).doc', description: 'è³‡è¨Šèª²-é›»è…¦å•é¡Œè™•ç†è¡¨ ', icon: 'bug' },
                        { title: 'ã€è·¨æ‰€ã€‘è·¨æ‰€æ¡ˆä»¶é€šå ±å–®', href: 'http://220.1.34.18/service/section/%E8%B3%87%E8%A8%8A%E8%AA%B2/%E5%B8%B8%E7%94%A8%E8%A1%A8%E6%A0%BC/%E8%B7%A8%E6%89%80%E6%A1%88%E4%BB%B6%E9%80%9A%E5%A0%B1%E5%96%AE.doc', description: 'è³‡è¨Šèª²-å—ç†è·¨æ‰€ç™»è¨˜æ¡ˆä»¶é€šå ±å–®', icon: 'arrow-right-left' },
                        { title: 'æ‰€å…§é›»è©±ä¸€è¦½è¡¨', href: 'http://220.1.34.18/service/section/%E8%B3%87%E8%A8%8A%E8%AA%B2/news/%E6%89%80%E5%85%A7%E9%9B%BB%E8%A9%B1%E4%B8%80%E8%A6%BD%E8%A1%A8.pdf', description: 'æœ€æ–°äº‹å‹™æ‰€å…§é›»è©±ä¸€è¦½è¡¨', icon: 'phone-forwarded' },
                        { title: 'ç”³è«‹å¥æª¢è£œåŠ©è²»æ†‘è­‰', href: 'http://220.1.34.18/service/section/%E4%BA%BA%E4%BA%8B%E5%AE%A4/download/105%E5%81%A5%E6%AA%A2%E6%86%91%E8%AD%89%E7%94%A8%E7%B4%99.pdf', description: 'äººäº‹å®¤-40æ­²ä»¥ä¸Šå…¬å‹™äººå“¡ç”³è«‹å¥åº·æª¢æŸ¥è£œåŠ©è²»æ†‘è­‰ç”¨ç´™(é ˆå€åŸŸé†«é™¢ä»¥ä¸Šé†«é™¢)', icon: 'heart-pulse' },
                        // å°‡ã€Œå·®å‹¤æ›´æ­£å–®ã€åŠ å›ã€Œå¸¸ç”¨è¡¨å–®ä¸‹è¼‰ã€åˆ†é¡
                        { title: 'å·®å‹¤æ›´æ­£å–®', href: 'http://220.1.34.18/service/section/%E4%BA%BA%E4%BA%8B%E5%AE%A4/download/107/00%E6%A1%83%E5%9C%92%E5%9C%B0%E6%94%BF%E4%BA%8B%E5%8B%99%E6%89%80%E5%8A%A0%E7%8F%AD%E8%AB%8B%E5%81%87%E6%9B%B4%E6%AD%A3%E7%94%B3%E8%AB%8B%E8%A1%A8.pdf', description: 'äººäº‹å®¤-æ¡ƒåœ’åœ°æ”¿äº‹å‹™æ‰€åŠ ç­è«‹å‡æ›´æ­£ç”³è«‹å–®', icon: 'file-check-2' },
                        { title: 'DutyRoster', href: 'http://220.1.34.18/service/section/%E4%BA%BA%E4%BA%8B%E5%AE%A4/photogallery/%E8%BC%AA%E5%80%BC%E8%A1%A8/114/7%E6%9C%88%E8%BC%AA%E5%80%BC%E8%A1%A8.pdf', description: 'æœ¬æœˆä»½å…¨æ‰€é—œå¤§é–€è¼ªå€¼ç­è¡¨PDFæª¢è¦–', icon: 'flashlight' },
                        ],
                    },
                    ]);
                const currentCategoryId = ref(null);
                const theme = ref('light');
                const isSidebarCollapsed = ref(false);
                const currentTime = ref('');
                const currentDate = ref('');
                const pdfModal = reactive({ visible: false, src: '', title: '' });
                const pdfPopoverState = reactive({ src: '' });
                const pdfPopover = ref(null);
                let popoverTimeout = null;
                // å¼•å…¥ mainContentKey ä¾†å¼·åˆ¶é‡æ–°æ¸²æŸ“ main å€å¡Š
                // ç”±æ–¼ç¾åœ¨ä½¿ç”¨ TransitionGroupï¼ŒmainContentKey ä¸å†éœ€è¦å¼·åˆ¶é‡æ–°æ¸²æŸ“æ•´å€‹ main å€å¡Š
                // ä½†ä¿ç•™å®ƒä»¥é˜²æœªä¾†å…¶ä»–ç”¨é€”ï¼Œæˆ–ä½œç‚ºè§¸ç™¼æŸäº›é‚è¼¯çš„ä¾æ“š
                const mainContentKey = ref(0); 

                // currentCategory ç¾åœ¨æ˜¯ computed å±¬æ€§ï¼ŒæœƒéŸ¿æ‡‰ bookmarks.value çš„è®ŠåŒ–
                const currentCategory = computed(() => bookmarks.value.find(c => c.id === currentCategoryId.value));
                // currentCategoryLinks ä¹Ÿç›´æ¥ä¾è³´ currentCategoryï¼Œç¢ºä¿éŸ¿æ‡‰å¼æ›´æ–°
                const currentCategoryLinks = computed(() => {
                    return currentCategory.value ? currentCategory.value.links : [];
                });

                // æ ¼å¼åŒ–æ™‚é–“æˆ³è¨˜ç‚º YYYY/MM/DD HH:mm
                const formatTimestamp = (timestamp) => {
                    if (!timestamp) return '';
                    const date = new Date(timestamp);
                    const year = date.getFullYear();
                    const month = String(date.getMonth() + 1).padStart(2, '0');
                    const day = String(date.getDate()).padStart(2, '0');
                    const hours = String(date.getHours()).padStart(2, '0');
                    const minutes = String(date.getMinutes()).padStart(2, '0');
                    return `${year}/${month}/${day} ${hours}:${minutes}`;
                };

                // æ ¹æ“šé»æ“Šæ¬¡æ•¸å’Œæœ€è¿‘é»æ“Šæ™‚é–“è¼‰å…¥ä¸¦æ’åºæ›¸ç±¤é€£çµ
                const loadClickCountsAndSortBookmarks = () => {
                    // å‰µå»º bookmarks çš„æ–°æ‹·è²ï¼Œä»¥ç¢ºä¿éŸ¿æ‡‰å¼æ›´æ–°
                    const updatedBookmarks = bookmarks.value.map(category => {
                        // å‰µå»º links é™£åˆ—çš„æ‹·è²ï¼Œä¸¦ç‚ºæ¯å€‹ link æ·»åŠ è‡¨æ™‚å±¬æ€§
                        const linksWithTempData = category.links.map((link, index) => {
                            const clickKey = `link_clicks_${category.id}_${link.href}`;
                            const storedData = JSON.parse(localStorage.getItem(clickKey) || '{}');
                            const clicks = parseInt(storedData.clicks || '0', 10);
                            const lastClickedTimestamp = parseInt(storedData.lastClickedTimestamp || '0', 10);
                            // å‰µå»º link çš„æ·ºæ‹·è²ï¼Œä¸¦æ·»åŠ è‡¨æ™‚æ•¸æ“š
                            return { 
                                ...link, 
                                clicks, 
                                lastClickedTimestamp, 
                                originalIndex: index,
                                lastAccessedTimeFormatted: lastClickedTimestamp ? formatTimestamp(lastClickedTimestamp) : '' // æ ¼å¼åŒ–æ™‚é–“
                            };
                        });

                        // æ ¹æ“šæœ€è¿‘é»æ“Šæ™‚é–“é™åºæ’åºï¼Œå¦‚æœæ™‚é–“ç›¸åŒå‰‡æŒ‰é»æ“Šæ¬¡æ•¸é™åºï¼Œæœ€å¾ŒæŒ‰åŸå§‹ç´¢å¼•
                        linksWithTempData.sort((a, b) => {
                            if (b.lastClickedTimestamp !== a.lastClickedTimestamp) {
                                return b.lastClickedTimestamp - a.lastClickedTimestamp; // æœ€è¿‘é»æ“Šçš„æ’åœ¨å‰é¢
                            }
                            if (b.clicks !== a.clicks) {
                                return b.clicks - a.clicks; // é»æ“Šæ¬¡æ•¸å¤šçš„æ’åœ¨å‰é¢
                            }
                            return a.originalIndex - b.originalIndex; // ä¿æŒåŸå§‹é †åº
                        });

                        // å‰µå»ºæ–°çš„ links é™£åˆ—ï¼Œä¸¦æ ¹æ“šæ’åºçµæœè¨­å®š isHighlighted å±¬æ€§
                        const newLinks = linksWithTempData.map((item, index) => {
                            // å‰µå»º link çš„æ·ºæ‹·è²ï¼Œä¸¦ç§»é™¤è‡¨æ™‚æ•¸æ“š
                            const cleanLink = { ...item };
                            delete cleanLink.clicks;
                            delete cleanLink.originalIndex;

                            // åªæœ‰å‰ 3 å€‹é»æ“Šæ¬¡æ•¸æœ€å¤šçš„é€£çµæœƒè¢«æ¨™è¨˜ç‚ºé†’ç›®æç¤º
                            // ä¸¦ä¸”åªæœ‰ç•¶æœ‰å¯¦éš›é»æ“Šæ™‚é–“æˆ³è¨˜æ™‚æ‰é«˜äº®
                            if (index < 3 && item.clicks > 0 && item.lastClickedTimestamp > 0) { 
                                cleanLink.isHighlighted = true;
                            } else {
                                cleanLink.isHighlighted = false; // å…¶ä»–é€£çµä¸é¡¯ç¤ºé†’ç›®æç¤º
                            }
                            return cleanLink;
                        });

                        // è¿”å›ä¸€å€‹æ–°çš„ category ç‰©ä»¶ï¼ŒåŒ…å«æ›´æ–°å¾Œçš„ links é™£åˆ—
                        return { ...category, links: newLinks };
                    });

                    // å°‡æ›´æ–°å¾Œçš„ bookmarks é™£åˆ—è³¦å€¼çµ¦éŸ¿æ‡‰å¼å¼•ç”¨ï¼Œè§¸ç™¼ Vue çš„éŸ¿æ‡‰å¼æ›´æ–°
                    bookmarks.value = updatedBookmarks;
                };

                const selectCategory = (id) => {
                    currentCategoryId.value = id;
                    // ç•¶åˆ†é¡æ”¹è®Šæ™‚ï¼Œé‡æ–°è¼‰å…¥ä¸¦æ’åºé€£çµ
                    loadClickCountsAndSortBookmarks(); 
                    // éå¢ mainContentKey ä»¥å¼·åˆ¶é‡æ–°æ¸²æŸ“ main å€å¡Š (å¦‚æœéœ€è¦ï¼Œä½† TransitionGroup æœƒè™•ç†)
                    mainContentKey.value++;
                };

                const toggleTheme = () => {
                    theme.value = theme.value === 'light' ? 'dark' : 'light';
                    // ç›´æ¥åœ¨ document.documentElement ä¸Šåˆ‡æ› 'dark' class
                    document.documentElement.classList.toggle('dark', theme.value === 'dark');
                    localStorage.setItem('theme', theme.value) 
                    // åœ¨ä¸»é¡Œåˆ‡æ›å¾Œï¼Œé‡æ–°è¼‰å…¥ä¸¦æ’åºæ›¸ç±¤ï¼Œç¢ºä¿å¡ç‰‡å…§å®¹å’Œåœ–ç¤ºæ¨£å¼æ­£ç¢ºæ›´æ–°
                    // loadClickCountsAndSortBookmarks();
                    // éå¢ mainContentKey ä»¥å¼·åˆ¶é‡æ–°æ¸²æŸ“ main å€å¡Š
                    // mainContentKey.value++;
                    setTimeout(() => { location.reload(); }, 50)
                };

                const toggleSidebar = () => {
                    isSidebarCollapsed.value = !isSidebarCollapsed.value;
                };

                const updateTime = () => {
                    const now = new Date();
                    currentDate.value = `${now.getFullYear()}/${String(now.getMonth() + 1).padStart(2, '0')}/${String(now.getDate()).padStart(2, '0')}`;
                    currentTime.value = `${String(now.getHours()).padStart(2, '0')}:${String(now.getMinutes()).padStart(2, '0')}:${String(now.getSeconds()).padStart(2, '0')}`;
                };
                
                const isPdf = (link) => link.href.toLowerCase().endsWith('.pdf');
                const isDownloadable = (link) => {
                    if (isPdf(link)) return false;
                    const extensions = ['doc', 'docx', 'xls', 'xlsx', 'ppt', 'pptx', 'zip', 'rar', '7z', 'odt', 'ods', 'odp'];
                    const fileExt = link.href.split('?')[0].split('#')[0].split('.').pop().toLowerCase();
                    return extensions.includes(fileExt);
                };

                const getButtonText = (link) => {
                    if (isPdf(link)) return 'é è¦½';
                    if (isDownloadable(link)) return 'ä¸‹è¼‰';
                    return 'å‰å¾€';
                };

                const getButtonIcon = (link) => {
                    if (isPdf(link)) return 'eye';
                    if (isDownloadable(link)) return 'download';
                    return 'arrow-right';
                };
                
                const getLinkTarget = (link) => {
                    return isPdf(link) ? null : '_blank';
                };

                const handleLinkClick = (event, link) => {
                    // ç²å–ç•¶å‰åˆ†é¡ ID
                    const categoryId = currentCategoryId.value; 
                    if (categoryId && link.href) {
                        // æ§‹å»º localStorage çš„éµ
                        const clickKey = `link_clicks_${categoryId}_${link.href}`;
                        // è®€å–ä¸¦å¢åŠ é»æ“Šæ¬¡æ•¸ï¼ŒåŒæ™‚æ›´æ–°æœ€è¿‘é»æ“Šæ™‚é–“æˆ³è¨˜
                        let storedData = JSON.parse(localStorage.getItem(clickKey) || '{}');
                        let clicks = (storedData.clicks || 0) + 1;
                        let lastClickedTimestamp = Date.now(); // è¨˜éŒ„ç•¶å‰æ™‚é–“æˆ³è¨˜
                        localStorage.setItem(clickKey, JSON.stringify({ clicks, lastClickedTimestamp }));
                        // æ›´æ–°é»æ“Šæ¬¡æ•¸å¾Œï¼Œé‡æ–°æ’åºç•¶å‰åˆ†é¡çš„é€£çµ
                        loadClickCountsAndSortBookmarks();
                    }

                    // ç¾æœ‰çš„é€£çµè™•ç†é‚è¼¯
                    const internalLink = event.target.closest('[data-internal-link="true"]');
                    if (internalLink) {
                        event.preventDefault();
                        event.stopPropagation();
                        const url = internalLink.getAttribute('href');
                        const title = internalLink.textContent;
                        if (url && url.toLowerCase().endsWith('.pdf')) {
                            openPdfModal(url, title);
                        } else if (url) {
                            window.open(url, '_blank', 'noopener,noreferrer');
                        }
                        return;
                    }
                    if (isPdf(link)) {
                        event.preventDefault();
                        openPdfModal(link.href, link.title);
                    }
                };

                const openPdfModal = (src, title) => {
                    pdfModal.src = `${src}#view=FitH&toolbar=1&navpanes=1`;
                    pdfModal.title = title;
                    pdfModal.visible = true;
                };

                const closePdfModal = () => {
                    pdfModal.visible = false;
                    pdfModal.src = '';
                    pdfModal.title = '';
                };

                const handlePdfHover = (event, link) => {
                    if (!isPdf(link)) return;
                    const targetCard = event.currentTarget;
                    clearTimeout(popoverTimeout);
                    popoverTimeout = setTimeout(() => {
                        const cardRect = targetCard.getBoundingClientRect();
                        pdfPopoverState.src = `${link.href}#view=FitH&toolbar=0&navpanes=0`;
                        const popoverEl = pdfPopover.value;
                        popoverEl.classList.remove('hidden');
                        const popoverWidth = 297;
                        const popoverHeight = 415;
                        const margin = 10;
                        let top = cardRect.top + (cardRect.height / 2) - (popoverHeight / 2);
                        let left;
                        const spaceRight = window.innerWidth - cardRect.right;
                        const spaceLeft = cardRect.left;
                        if (spaceRight >= popoverWidth + margin) {
                            left = cardRect.right + margin;
                        } else if (spaceLeft >= popoverWidth + margin) {
                            left = cardRect.left - popoverWidth - margin;
                        } else {
                            left = spaceRight > spaceLeft ? cardRect.right + margin : cardRect.left - popoverWidth - margin;
                        }
                        left = Math.max(margin, Math.min(left, window.innerWidth - popoverWidth - margin));
                        top = Math.max(margin, Math.min(top, window.innerHeight - popoverHeight - margin));
                        popoverEl.style.top = `${top}px`;
                        popoverEl.style.left = `${left}px`;
                    }, 300);
                };

                const hidePdfPopover = () => {
                    clearTimeout(popoverTimeout);
                    if (pdfPopover.value) {
                       pdfPopover.value.classList.add('hidden');
                    }
                    pdfPopoverState.src = '';
                };
                
                const markdownToHtml = (text) => {
                    if (!text) return '';
                    const regex = /\[([^\]]+)\]\(([^)]+)\)/g;
                    return text.replace(regex, '<a href="$2" data-internal-link="true" class="text-blue-600 dark:text-blue-400 hover:underline font-semibold">$1</a>');
                };

                const updateDynamicLinks = async () => {
                    const now = new Date();
                    const rocYear = now.getFullYear() - 1911;
                    const month = now.getMonth() + 1;
                    const nextMonthDate = new Date(now.getFullYear(), now.getMonth() + 1, 1);
                    const nextRocYear = nextMonthDate.getFullYear() - 1911;
                    const nextMonth = nextMonthDate.getMonth() + 1;
                    
                    // æ‰¾åˆ°äººäº‹å®¤çš„ DutyRoster é€£çµ
                    const rosterLink = bookmarks.value.flatMap(c => c.links).find(l => l.title === 'DutyRoster' || l.originalTitle === 'DutyRoster');
                    if (rosterLink) {
                        const baseUrl = "http://220.1.34.18/service/section/%E4%BA%BA%E4%BA%8B%E5%AE%A4/photogallery/%E8%BC%AA%E5%80%BC%E8%A1%A8/";
                        rosterLink.href = `${baseUrl}${rocYear}/${month}æœˆè¼ªå€¼è¡¨.pdf`;
                        rosterLink.originalTitle = rosterLink.originalTitle || "DutyRoster";
                        rosterLink.title = `${rocYear}å¹´${month}æœˆå¤§é–€è¼ªå€¼è¡¨`;
                        const nextMonthHref = `${baseUrl}${nextRocYear}/${nextMonth}æœˆè¼ªå€¼è¡¨.pdf`;
                        try {
                            const response = await fetch(nextMonthHref, { method: 'HEAD' });
                            if (response.ok) {
                                rosterLink.description = `æœ¬æœˆä»½å…¨æ‰€é—œå¤§é–€è¼ªå€¼ç­è¡¨PDFæª¢è¦– | [é è¦½${nextMonth}æœˆ](${nextMonthHref})`;
                            } else {
                                rosterLink.description = `æœ¬æœˆä»½å…¨æ‰€é—œå¤§é–€è¼ªå€¼ç­è¡¨PDFæª¢è¦–`;
                            }
                        } catch (e) {
                            rosterLink.description = `æœ¬æœˆä»½å…¨æ‰€é—œå¤§é–€è¼ªå€¼ç­è¡¨PDFæª¢è¦–`;
                        }
                    }

                    // æ‰¾åˆ°è³‡è¨Šèª²çš„æœ¬æœˆè¼ªå€¼è¡¨é€£çµ
                    const infoRosterLink = bookmarks.value.flatMap(c => c.links).find(l => l.title === 'è³‡è¨Šèª²æœ¬æœˆè¼ªå€¼è¡¨');
                    if (infoRosterLink) {
                        infoRosterLink.title = `è³‡è¨Šèª²${rocYear}å¹´${month}æœˆè¼ªå€¼è¡¨`;
                        // è³‡è¨Šèª²è¼ªå€¼è¡¨NEXT.pdf çš„å›ºå®šè·¯å¾‘
                        const infoRosterNextMonthPdfUrl = `http://220.1.34.18/service/section/%E8%B3%87%E8%A8%8A%E8%AA%B2/news/%E8%B3%87%E8%A8%8A%E8%AA%B2%E8%BC%AA%E5%80%BC%E8%A1%A8NEXT.pdf`;
                        try {
                            const response = await fetch(infoRosterNextMonthPdfUrl, { method: 'HEAD' });
                            if (response.ok) {
                                infoRosterLink.description = `è³‡è¨Šèª²æœ¬æœˆä»½æ¯æ—¥å·¥ä½œè¼ªå€¼è¡¨ | [é è¦½ä¸‹å€‹æœˆ](${infoRosterNextMonthPdfUrl})`;
                            } else {
                                infoRosterLink.description = `è³‡è¨Šèª²æœ¬æœˆä»½æ¯æ—¥å·¥ä½œè¼ªå€¼è¡¨`;
                            }
                        } catch (e) {
                            infoRosterLink.description = `è³‡è¨Šèª²æœ¬æœˆä»½æ¯æ—¥å·¥ä½œè¼ªå€¼è¡¨`;
                        }
                    }
                };

                onMounted(async () => {
                    // è™•ç†æ›¸ç±¤è³‡æ–™ç§»å‹•
                    const filesCategory = bookmarks.value.find(c => c.id === 'files');
                    const infoCategory = bookmarks.value.find(c => c.id === 'inf');

                    if (filesCategory && infoCategory) {
                        const infoRosterIndex = filesCategory.links.findIndex(link => link.title === 'è³‡è¨Šèª²æœ¬æœˆè¼ªå€¼è¡¨');
                        if (infoRosterIndex !== -1) {
                            const [movedLink] = filesCategory.links.splice(infoRosterIndex, 1); // ç§»é™¤ä¸¦ç²å–ç§»å‹•çš„é€£çµ
                            infoCategory.links.push(movedLink); // æ·»åŠ åˆ°è³‡è¨Šèª²
                        }
                    }

                    await updateDynamicLinks();
                    // ç¢ºä¿åœ¨æ›è¼‰æ™‚æ­£ç¢ºè®€å–ä¸»é¡Œä¸¦æ‡‰ç”¨ class
                    theme.value = localStorage.getItem('theme') || 'light';
                    document.documentElement.classList.toggle('dark', theme.value === 'dark');

                    isSidebarCollapsed.value = (localStorage.getItem('sidebarState') === 'collapsed');
                    let lastCatId = localStorage.getItem('lastSelectedCategory');
                    const categoryExists = bookmarks.value.some(c => c.id === lastCatId);
                    if (!lastCatId || !categoryExists) {
                        lastCatId = bookmarks.value.find(c => !c.isDirectLink)?.id || null;
                    }
                    selectCategory(lastCatId); // é€™æœƒè§¸ç™¼ loadClickCountsAndSortBookmarks å’Œ mainContentKey éå¢
                    
                    updateTime();
                    setInterval(updateTime, 1000);
                });

                // ç›£è½ mainContentKey è®ŠåŒ–æ™‚ï¼Œåœ¨ nextTick å¾Œé‡æ–°å»ºç«‹ Lucide åœ–ç¤º
                watch(mainContentKey, () => {
                    nextTick(() => {
                        lucide.createIcons();
                    });
                });

                watch(isSidebarCollapsed, (collapsed) => {
                    localStorage.setItem('sidebarState', collapsed ? 'collapsed' : 'open');
                });
                
                watch(currentCategoryId, (newId) => {
                    if (newId) {
                       localStorage.setItem('lastSelectedCategory', newId);
                    }
                });
                
                watch(() => pdfModal.visible, (isVisible) => {
                    document.body.classList.toggle('modal-open', isVisible);
                });

                return {
                    bookmarks,
                    currentCategoryId,
                    theme,
                    isSidebarCollapsed,
                    currentTime,
                    currentDate,
                    pdfModal,
                    pdfPopover,
                    pdfPopoverState,
                    mainContentKey, // æš´éœ²çµ¦æ¨¡æ¿ä½¿ç”¨
                    currentCategory,
                    currentCategoryLinks, // ç¾åœ¨æ˜¯ computed
                    selectCategory,
                    toggleTheme,
                    toggleSidebar,
                    isDownloadable,
                    getButtonText,
                    getButtonIcon,
                    getLinkTarget,
                    handleLinkClick,
                    openPdfModal,
                    closePdfModal,
                    handlePdfHover,
                    hidePdfPopover,
                    markdownToHtml,
                };
            }
        });

        app.mount('#app');
    </script>
</body>
</html>
