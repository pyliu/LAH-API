<!DOCTYPE html>
<html lang="zh-TW">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ¡ƒåœ’åœ°æ‰€æ›¸ç±¤ç´¢å¼•</title>
    
    <!-- ç¦æ­¢å¿«å–çš„ Meta æ¨™ç±¤ -->
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">

    <!-- å¤–éƒ¨å‡½å¼åº« -->
    <!-- ç¢ºä¿ lodash.min.js å’Œ marked.min.js æª”æ¡ˆèˆ‡ index.html åœ¨åŒä¸€å€‹ç›®éŒ„ -->
    <script src="lodash.min.js"></script>
    <script src="marked.min.js"></script>
    <script src="vue.global.prod.js"></script>
    <script src="lucide.min.js"></script>
    <link href="tailwind.min.css" rel="stylesheet">

    <!-- è‡ªè¨‚æ¨£å¼ (å·²ä¿®æ­£ä¸»é¡Œåˆ‡æ›) -->
    <style>
        :root {
            --bootstrap-primary: #0d6efd;
            --bootstrap-primary-hover: #0b5ed7;
            --bootstrap-primary-active: #0a58ca;
            
            /* é è¨­ç‚ºæ·ºè‰²ä¸»é¡Œ */
            --highlight-bg: #fffbe0;
            --highlight-border: #fcd34d;
            --watermark-bg: rgba(252, 211, 77, 0.1);
            --watermark-text: rgba(180, 83, 9, 0.2);
            --body-bg: #f8f9fa;
            --body-color: #212529;
            --sidebar-bg: #ffffff;
            --sidebar-border: #dee2e6;
            --sidebar-link-color: #495057;
            --sidebar-link-hover-bg: #e9ecef;
            --sidebar-link-active-bg: var(--bootstrap-primary);
            --sidebar-link-active-color: #ffffff;
            --bookmark-card-bg: #ffffff;
            --bookmark-card-border: #dee2e6;
            --bookmark-card-shadow: 0 .125rem .25rem rgba(0, 0, 0, .075);
            --modal-bg: rgba(0, 0, 0, 0.5);
            --modal-content-bg: #ffffff;
        }

        [data-theme="dark"] {
            /* æ·±è‰²ä¸»é¡Œè®Šæ•¸è¦†å¯« */
            --highlight-bg: #3a372c;
            --highlight-border: #a16207;
            --watermark-bg: rgba(252, 211, 77, 0.05);
            --watermark-text: rgba(252, 211, 77, 0.1);
            --body-bg: #121212;
            --body-color: #e0e0e0;
            --sidebar-bg: #1e1e1e;
            --sidebar-border: #333;
            --sidebar-link-color: #adb5bd;
            --sidebar-link-hover-bg: #343a40;
            --bookmark-card-bg: #1e1e1e;
            --bookmark-card-border: #333;
            --bookmark-card-shadow: 0 .125rem .25rem rgba(0, 0, 0, .15);
            --modal-bg: rgba(0, 0, 0, 0.7);
            --modal-content-bg: #2d2d2d;
        }

        body {
            background-color: var(--body-bg);
            color: var(--body-color);
            transition: background-color 0.3s, color 0.3s;
        }
        
        body.modal-open {
            overflow: hidden;
        }

        #sidebar {
            background-color: var(--sidebar-bg);
            border-right: 1px solid var(--sidebar-border);
        }

        #sidebar a {
            color: var(--sidebar-link-color);
        }

        #sidebar a:hover {
            background-color: var(--sidebar-link-hover-bg);
        }

        #sidebar a.active {
            background-color: var(--sidebar-link-active-bg);
            color: var(--sidebar-link-active-color);
        }

        #bookmarks-content .bookmark-card-styled {
            background-color: var(--bookmark-card-bg);
            border: 1px solid var(--bookmark-card-border);
            box-shadow: var(--bookmark-card-shadow);
        }

        #bookmarks-content .bookmark-card-styled.recent::before {
            content: 'RECENT';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) rotate(-30deg);
            font-size: 3rem;
            font-weight: 800;
            color: var(--watermark-text);
            background-color: var(--watermark-bg);
            padding: 1rem 2rem;
            border-radius: 0.5rem;
            pointer-events: none;
            z-index: 0;
            opacity: 0.5;
        }
        
        .modal-backdrop {
            background-color: var(--modal-bg);
        }

        .modal-content {
            background-color: var(--modal-content-bg);
        }

        .fade-enter-active, .fade-leave-active {
            transition: opacity 0.3s ease;
        }
        .fade-enter-from, .fade-leave-to {
            opacity: 0;
        }

        .list-enter-active, .list-leave-active, .list-move {
            transition: all 0.5s ease;
        }
        .list-enter-from, .list-leave-to {
            opacity: 0;
            transform: translateY(30px);
        }
        .list-leave-active {
            position: absolute;
        }
    </style>
</head>

<body class="font-sans antialiased">
    <div id="app" class="flex h-screen overflow-hidden">
        <!-- Sidebar -->
        <aside id="sidebar" :class="['flex-shrink-0 transition-all duration-300', isSidebarCollapsed ? 'w-16' : 'w-48']">
            <div class="flex flex-col h-full">
                <!-- Logo -->
                <div class="p-4 border-b" :style="{ borderColor: 'var(--sidebar-border)' }">
                    <div class="flex items-center justify-center">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-blue-500"><path d="m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z"></path></svg>
                        <h1 v-show="!isSidebarCollapsed" class="ml-2 text-xl font-semibold whitespace-nowrap">æ›¸ç±¤ç´¢å¼•</h1>
                    </div>
                </div>

                <!-- Navigation Links -->
                <nav class="flex-1 p-2 space-y-1 overflow-y-auto">
                    <a v-for="category in bookmarks" :key="category.id" href="#"
                       @click.prevent="selectCategory(category.id)"
                       :class="['flex items-center p-2 rounded-md transition-colors', { 'active': currentCategoryId === category.id, 'justify-center': isSidebarCollapsed }]">
                        <i :data-lucide="category.icon" class="w-5 h-5"></i>
                        <span v-show="!isSidebarCollapsed" class="ml-3">{{ category.category }}</span>
                    </a>
                </nav>

                <!-- Footer Controls and Time -->
                <div class="p-2 border-t" :style="{ borderColor: 'var(--sidebar-border)' }">
                    <!-- Control Buttons -->
                    <button @click="toggleTheme" class="w-full flex items-center p-2 rounded-md" :class="{'justify-center': isSidebarCollapsed}" :aria-label="theme === 'dark' ? 'åˆ‡æ›ç‚ºæ·ºè‰²æ¨¡å¼' : 'åˆ‡æ›ç‚ºæ·±è‰²æ¨¡å¼'">
                        <i :data-lucide="theme === 'dark' ? 'sun' : 'moon'" class="w-5 h-5"></i>
                        <span v-show="!isSidebarCollapsed" class="ml-3">åˆ‡æ›ä¸»é¡Œ</span>
                    </button>
                    <button @click="toggleFontSize" class="w-full flex items-center p-2 rounded-md" :class="{'justify-center': isSidebarCollapsed}" aria-label="èª¿æ•´å­—é«”å¤§å°">
                        <i data-lucide="text" class="w-5 h-5"></i>
                        <span v-show="!isSidebarCollapsed" class="ml-3">èª¿æ•´å­—é«” ({{ fontSizeLabel }})</span>
                    </button>
                    <button @click="toggleSidebar" class="w-full flex items-center p-2 rounded-md" :class="{'justify-center': isSidebarCollapsed}" :aria-label="isSidebarCollapsed ? 'å±•é–‹å´é‚Šæ¬„' : 'æ”¶åˆå´é‚Šæ¬„'">
                        <i :data-lucide="isSidebarCollapsed ? 'panel-right-open' : 'panel-left-close'" class="w-5 h-5"></i>
                        <span v-show="!isSidebarCollapsed" class="ml-3">æ”¶åˆå´é‚Šæ¬„</span>
                    </button>
                    <!-- Time Display -->
                    <div v-show="!isSidebarCollapsed" class="my-2 text-center">
                        <p class="text-lg font-medium">{{ currentTime }}</p>
                        <p class="text-xs text-gray-500">{{ currentDate }}</p>
                    </div>
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="flex-1 flex flex-col overflow-hidden">
            <header class="flex items-center justify-between p-4 border-b" :style="{ borderColor: 'var(--sidebar-border)' }">
                <h2 class="text-2xl font-bold">{{ currentCategory.category }}</h2>
            </header>
            <div id="bookmarks-content" class="flex-1 p-4 overflow-y-auto">
                <transition-group name="list" tag="div" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 2xl:grid-cols-6 gap-4">
                    <div v-for="link in currentCategoryLinks" :key="link.id"
                         class="bookmark-card-styled relative rounded-lg p-4 flex flex-col items-center justify-center text-center transition-all duration-300 hover:shadow-lg hover:-translate-y-1 overflow-hidden"
                         :class="{ 'recent': recentLinks.includes(link.id) }"
                         :style="getRecentHighlightStyle(link)">
                        
                        <!-- *** FIX: ç§»é™¤ .prevent ä¿®é£¾ç¬¦ *** -->
                        <a :href="link.href" :target="getLinkTarget(link.href)" @click="handleLinkClick(link, $event)"
                           @mouseover="handlePdfHover($event, link.href)" @mouseleave="hidePdfPopover"
                           class="flex flex-col items-center justify-center w-full h-full z-10">
                            <i :data-lucide="link.icon || 'globe'" class="w-10 h-10 mb-2 text-blue-500"></i>
                            <h3 class="font-semibold">{{ link.title }}</h3>
                            <p v-if="link.description || link.nextMonthHtml" class="text-xs text-gray-500 mt-1">
                                <span v-html="markdownToHtml(link.description)"></span>
                                <span v-if="link.nextMonthHtml" v-html="link.nextMonthHtml"></span>
                            </p>
                        </a>
                        
                        <div v-if="isDownloadable(link.href) || link.href.toLowerCase().endsWith('.pdf')" class="absolute bottom-2 right-2 z-20">
                            <button @click.stop="openPdfModal(link.href)" v-if="link.href.toLowerCase().endsWith('.pdf')"
                                    class="p-1.5 bg-gray-200 dark:bg-gray-700 rounded-full hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors text-gray-700 dark:text-gray-200"
                                    aria-label="é è¦½PDF">
                                <i data-lucide="eye" class="w-4 h-4"></i>
                            </button>
                        </div>
                    </div>
                </transition-group>
            </div>
        </main>
        
        <!-- PDF Modal -->
        <transition name="fade">
            <div v-if="pdfModal.visible" class="fixed inset-0 z-50 flex items-center justify-center">
                <div class="modal-backdrop absolute inset-0" @click="closePdfModal"></div>
                <div class="modal-content relative w-11/12 h-5/6 max-w-4xl rounded-lg shadow-xl flex flex-col">
                    <header class="flex items-center justify-between p-4 border-b">
                        <h3 class="font-semibold text-lg">PDF é è¦½</h3>
                        <button @click="closePdfModal" class="p-1 rounded-full hover:bg-gray-200 dark:hover:bg-gray-600" aria-label="é—œé–‰">
                            <i data-lucide="x" class="w-6 h-6"></i>
                        </button>
                    </header>
                    <div class="flex-1 p-2">
                        <iframe :src="pdfModal.url" class="w-full h-full border-0" title="PDF Viewer"></iframe>
                    </div>
                </div>
            </div>
        </transition>

        <!-- IFrame Modal -->
        <transition name="fade">
            <div v-if="iframeModal.visible" class="fixed inset-0 z-50 flex items-center justify-center p-4 sm:p-6 md:p-8">
                <div class="modal-backdrop absolute inset-0" @click="closeIframeModal"></div>
                <div class="modal-content relative w-full h-full rounded-lg shadow-xl flex flex-col">
                    <header class="flex items-center justify-between p-4 border-b">
                        <h3 class="font-semibold text-lg truncate pr-4">{{ iframeModal.title }}</h3>
                        <button @click="closeIframeModal" class="p-1 rounded-full hover:bg-gray-200 dark:hover:bg-gray-600 flex-shrink-0" aria-label="é—œé–‰">
                            <i data-lucide="x" class="w-6 h-6"></i>
                        </button>
                    </header>
                    <div class="flex-1 p-2">
                        <iframe :src="iframeModal.url" class="w-full h-full border-0" :title="iframeModal.title"></iframe>
                    </div>
                </div>
            </div>
        </transition>

        <!-- PDF Popover -->
        <div ref="pdfPopover" v-show="pdfPopoverState.visible" 
             :style="{ top: pdfPopoverState.y + 'px', left: pdfPopoverState.x + 'px' }"
             class="fixed z-50 w-80 h-96 bg-white border border-gray-300 rounded-lg shadow-lg pointer-events-none">
            <iframe :src="pdfPopoverState.url" class="w-full h-full border-0" title="PDF Popover"></iframe>
        </div>
    </div>

    <!-- å°‡æ›¸ç±¤è³‡æ–™å¾ JS é‚è¼¯ä¸­åˆ†é›¢å‡ºä¾† -->
    <script id="bookmark-data" type="application/json">
    [
        {
            "category": "å…±é€šç³»çµ±",
            "id": "common",
            "icon": "send-horizontal",
            "links": [
            { "title": "åœ°æ‰€å“¡å·¥çŸ¥è­˜ç¶²", "href": "http://220.1.34.18:8888", "description": "æä¾›å…¬å‘Šã€å„èª²å®¤å°ˆå±¬å€ã€å“¡å·¥è³‡è¨Šã€æœƒè­°å®¤é ç´„ ... ç­‰åŠŸèƒ½", "icon": "layout-dashboard" },
            { "title": "æ©Ÿé—œå…§éƒ¨äººäº‹æ¥­å‹™ç³»çµ±", "href": "https://webitr.tycg.gov.tw/WebITR/", "description": "æ¡ƒåœ’å¸‚æ”¿åºœå·®å‹¤ç³»çµ± https://webitr.tycg.gov.tw/WebITR/", "icon": "clock" },
            { "title": "å…¬æ–‡æ•´åˆè³‡è¨Šç³»çµ±", "href": "https://odis.tycg.gov.tw/", "description": "å¸‚åºœå…¬æ–‡ç³»çµ± https://odis.tycg.gov.tw/", "icon": "book-marked" },
            { "title": "æ¡ƒåœ’å¸‚æ”¿åºœå…¬å‹™é›²", "href": "https://tycgcloud.tycg.gov.tw/", "description": "æ¡ƒåœ’å¸‚æ”¿åºœå…¬å‹™é›²(å…§ç¶²) https://tycgcloud.tycg.gov.tw/", "icon": "cloud" },
            { "title": "å…§å¤–ç¶²æª”æ¡ˆäº¤æ›ç³»çµ±", "href": "http://220.1.34.26:8008/", "description": "å…§ç¶²é›»è…¦æª”æ¡ˆäº¤æ›è‡³å¤–ç¶²çš„äº¤æ›ç³»çµ±ï¼Œå¤–ç¶²ä¸‹è¼‰è«‹è‡³ http://220.2.34.17:8008/", "icon": "file-output" },
            { "title": "å·¥ä½œç”Ÿæ´»é»æ»´", "href": "http://220.1.34.18/album.asp", "description": "æœ¬æ‰€é›»å­ç›¸ç°¿", "icon": "image-play" },
            { "title": "æ™ºæ…§æ§ç®¡ç³»çµ±", "href": "http://220.1.34.75:8080/", "description": "æä¾›åå¤šé …ç™»è¨˜è¼”åŠ©åŠŸèƒ½ä»¥åŠé¡¯ç¤ºæœ€æ–°å…¬å‘ŠåŠå„æ¥­å‹™å°å¹«æ‰‹é€£çµ", "icon": "monitor-smartphone" }
            ]
        },
        {
            "category": "å…¨åŠŸèƒ½æ«ƒå°",
            "id": "counter",
            "icon": "concierge-bell",
            "links": [
            { "title": "åœ°æ”¿ç³»çµ±161-è·¨ç¸£å¸‚", "href": "http://220.1.34.161:9080/LandHA/", "description": "åœ°æ”¿ç³»çµ±è·¨ç¸£å¸‚æ“ä½œå°ˆå±¬ä¼ºæœå™¨ http://220.1.34.161:9080/LandHA/", "icon": "server-cog" },
            { "title": "åœ°æ”¿ç³»çµ±60-æ¡ƒåœ’å¤–æ›", "href": "http://220.1.34.60:9080/LandHA/", "description": "åœ°æ”¿ç³»çµ±æ¡ƒåœ’å¤–æ›æ“ä½œå°ˆå±¬ä¼ºæœå™¨ http://220.1.34.60:9080/LandHA/", "icon": "server" },
            { "title": "åœ°æ”¿ç³»çµ±118-å·¥ä½œç«™", "href": "http://220.1.34.118:9080/LandHA/", "description": "åœ°æ”¿ç³»çµ±å·¥ä½œç«™æ“ä½œå°ˆå±¬ä¼ºæœå™¨ http://220.1.34.118:9080/LandHA/", "icon": "server" },
            { "title": "åœ°æ”¿æ™ºæ…§æ§ç®¡ç³»çµ±", "href": "http://220.1.34.75:8080/reg/", "description": "æä¾›åå¤šé …ç™»è¨˜æ¡ˆä»¶æŸ¥è©¢åŠæ§ç®¡çµ±è¨ˆåŠŸèƒ½çš„ç³»çµ± http://220.1.34.75:8080/reg/", "icon": "landmark" },
            { "title": "åœ°æ”¿æ­·å²è³‡æ–™æŸ¥è©¢ç³»çµ±", "href": "http://220.1.34.15/NLOWeb/", "description": "åœ°æ”¿æ­·å²è³‡æ–™æŸ¥è©¢ç³»çµ± http://220.1.34.15/NLOWeb/", "icon": "history" },
            { "title": "è¬„æœ¬æ«ƒå“¡æ©Ÿå¾Œå°ç®¡ç†", "href": "http://220.1.33.117/MGMT/", "description": "ç®¡ç†è¬„æœ¬æ«ƒå“¡æ©Ÿæœƒå“¡å¸³è™Ÿã€é¡¯ç¤ºçµ±è¨ˆè³‡æ–™", "icon": "settings-2" },
            { "title": "ç°¡è¨Šç™¼é€ç´€éŒ„æŸ¥è©¢", "href": "http://220.1.34.75:8080/reg/sms", "description": "æä¾›åœ°æ”¿ç³»çµ±å‚³é€åœ°ç±ç•°å‹•å³æ™‚é€šç­‰ç°¡è¨Šç´€éŒ„æŸ¥è©¢ http://220.1.34.75:8080/reg/sms", "icon": "message-square-text" },
            { "title": "ç™»è¨˜èª²å°ˆå±¬å…¥å£ç¶²ç«™", "href": "http://220.1.34.18/service/section/%E7%99%BB%E8%A8%98%E8%AA%B2/index.htm", "description": "æœ€æ–°æ¶ˆæ¯ã€èª²å‹™æœƒè­°ã€æ•™è‚²è¨“ç·´ã€æ³•è¦æ–°è¨Šã€è§£é‡‹å‡½ä»¤ã€ä¸‹è¼‰å°ˆå€ã€åœ°ç±æ¸…ç†ã€æ´»å‹•å‰ªå½±", "icon": "layout-list" }
            ]
        },
        {
            "category": "ç™»è¨˜èª²",
            "id": "reg",
            "icon": "file-signature",
            "links": [
            { "title": "ç™»è¨˜èª²å°ˆå±¬å…¥å£ç¶²ç«™", "href": "http://220.1.34.18/service/section/%E7%99%BB%E8%A8%98%E8%AA%B2%E9%81%8E%E7%A8%8B/index.htm", "description": "æœ€æ–°æ¶ˆæ¯ã€èª²å‹™æœƒè­°ã€æ•™è‚²è¨“ç·´ã€æ³•è¦æ–°è¨Šã€è§£é‡‹å‡½ä»¤ã€ä¸‹è¼‰å°ˆå€ã€åœ°ç±æ¸…ç†ã€æ´»å‹•å‰ªå½±", "icon": "layout-list" },
            { "title": "ç™»è¨˜èª²ä¸‹è¼‰å€", "href": "http://220.1.34.18/service/section/%E7%99%BB%E8%A8%98%E8%AA%B2/download.htm", "description": "ç™»è¨˜èª²è‡ªè¡Œç¶­è­·ä¹‹å„å¼æª”æ¡ˆä¸‹è¼‰å°ˆå€", "icon": "download" },
            { "title": "åœ°æ”¿æ™ºæ…§æ§ç®¡ç³»çµ±", "href": "http://220.1.34.75:8080/reg/", "description": "æä¾›åå¤šé …ç™»è¨˜æ¡ˆä»¶æŸ¥è©¢åŠæ§ç®¡çµ±è¨ˆåŠŸèƒ½çš„ç³»çµ± http://220.1.34.75:8080/reg/", "icon": "landmark" },
            { "title": "åœ°æ”¿ç³»çµ±161-è·¨ç¸£å¸‚", "href": "http://220.1.34.161:9080/LandHA/", "description": "åœ°æ”¿ç³»çµ±è·¨ç¸£å¸‚æ“ä½œå°ˆå±¬ä¼ºæœå™¨ http://220.1.34.161:9080/LandHA/", "icon": "server-cog" },
            { "title": "åœ°æ”¿ç³»çµ±60-æ¡ƒåœ’å¤–æ›", "href": "http://220.1.34.60:9080/LandHA/", "description": "åœ°æ”¿ç³»çµ±æ¡ƒåœ’å¤–æ›æ“ä½œå°ˆå±¬ä¼ºæœå™¨ http://220.1.34.60:9080/LandHA/", "icon": "server" },
            { "title": "åœ°æ”¿ç³»çµ±205-ç™»è¨˜èª²1", "href": "http://220.1.34.205:9080/LandHA/", "description": "åœ°æ”¿ç³»çµ±ç™»è¨˜èª²æ“ä½œå°ˆå±¬ä¼ºæœå™¨ http://220.1.34.205:9080/LandHA/", "icon": "server" },
            { "title": "åœ°æ”¿ç³»çµ±206-ç™»è¨˜èª²2", "href": "http://220.1.34.206:9080/LandHA/", "description": "åœ°æ”¿ç³»çµ±ç™»è¨˜èª²æ“ä½œå°ˆå±¬ä¼ºæœå™¨ http://220.1.34.206:9080/LandHA/", "icon": "server" },
            { "title": "åœ°æ”¿ç³»çµ±162-ç½°é°è£è™•å°ˆç”¨", "href": "http://220.1.34.162:9080/LandHA/", "description": "åœ°æ”¿ç³»çµ±çµ¦ç½°é°è£è™•å°ˆç”¨ä¼ºæœå™¨ http://220.1.34.162:9080/LandHA/", "icon": "server" },
            { "title": "åœ°æ”¿æ­·å²è³‡æ–™æŸ¥è©¢ç³»çµ±", "href": "http://220.1.34.15/NLOWeb/", "description": "åœ°æ”¿æ­·å²è³‡æ–™æŸ¥è©¢ç³»çµ± http://220.1.34.15/NLOWeb/", "icon": "history" },
            { "title": "åœŸåœ°åƒè€ƒè³‡è¨Šæª”æŸ¥è©¢ç³»çµ±", "href": "http://220.1.34.213/ref/jsp/security/login.jsp", "description": "åœŸåœ°åƒè€ƒè³‡è¨Šæª”æŸ¥è©¢ç³»çµ± http://220.1.34.213/ref/jsp/security/login.jsp", "icon": "file-search" },
            { "title": "è¬„æœ¬æ«ƒå“¡æ©Ÿå¾Œå°ç®¡ç†", "href": "http://220.1.33.117/MGMT/", "description": "ç®¡ç†è¬„æœ¬æ«ƒå“¡æ©Ÿæœƒå“¡å¸³è™Ÿã€é¡¯ç¤ºçµ±è¨ˆè³‡æ–™", "icon": "settings-2" },
            { "title": "ç§æ³•äººè³¼ç½®ä½å®…", "href": "http://220.1.33.80/PcQ.aspx", "description": "ç§æ³•äººè³¼ç½®ä½å®… http://220.1.33.80/PcQ.aspx", "icon": "building" },
            { "title": "å…§æ”¿éƒ¨-åœ°ç±ç¸½æ­¸æˆ¶ç³»çµ±", "href": "https://landowners.land.moi.gov.tw/", "description": "å€‹äººåœ°ç±è³‡æ–™é›†ä¸­æŸ¥è©¢å¹³å°ï¼Œæ•´åˆåœŸåœ°ã€å»ºç‰©æ‰€æœ‰æ¬Šè³‡è¨Š https://landowners.land.moi.gov.tw/", "icon": "folder-lock" },
            { "title": "å…§æ”¿éƒ¨-æ•¸ä½æ«ƒå°", "href": "http://220.5.61.14/", "description": "å…§æ”¿éƒ¨æ•¸ä½æ«ƒè‡ºå…¬å‹™ç«¯ç¶²ç«™ http://220.5.61.14/", "icon": "monitor-smartphone" },
            { "title": "å…§æ”¿éƒ¨-ç½•ç”¨å­—æŸ¥è©¢ç³»çµ±", "href": "http://220.5.61.32/MOILAND/", "description": "å…§æ”¿éƒ¨é–‹ç™¼å»ºç½®ä¹‹ç½•ç”¨å­—æŸ¥è©¢ç³»çµ± http://220.5.61.32/MOILAND/", "icon": "spell-check" },
            { "title": "å…§æ”¿éƒ¨-æˆ¶å½¹æ”¿é›»å­é–˜é–€ç³»çµ±", "href": "https://210.241.18.131/", "description": "å…§æ”¿éƒ¨æˆ¶å½¹æ”¿é›»å­é–˜é–€ç³»çµ± https://210.241.18.131/", "icon": "door-open" },
            { "title": "å…§æ”¿éƒ¨-æœªè¾¦ç¹¼æ‰¿", "href": "http://220.1.33.37:8091/OIB6/Login.jsp", "description": "å…§æ”¿éƒ¨æœªè¾¦ç¹¼æ‰¿ç™»è¨˜åœŸåœ°åŠå»ºç‰©ç®¡ç†ç³»çµ± http://220.1.33.37:8091/OIB6/Login.jsp", "icon": "user-x" },
            { "title": "å…§æ”¿éƒ¨-åœ°ç±æ¸…ç†", "href": "http://220.1.33.79:8080/TAZQ/index.jsp", "description": "å…§æ”¿éƒ¨åœ°ç±æ¸…ç†ç®¡ç†ç³»çµ± http://220.1.33.79:8080/TAZQ/index.jsp", "icon": "files" },
            { "title": "å…§æ”¿éƒ¨-ç·šä¸Šç”³è¾¦", "href": "http://220.5.61.17/cms/", "description": "å…§æ”¿éƒ¨ç·šä¸Šç”³è¾¦ç³»çµ± http://220.5.61.17/cms/", "icon": "file-plus-2" },
            { "title": "å…§æ”¿éƒ¨-é›»å­ç”¢æ¬Šæ†‘è­‰å¾Œå°", "href": "https://220.5.61.73/etd-manager/", "description": "å…§æ”¿éƒ¨é–‹ç™¼æä¾›é›»å­ç”¢æ¬Šæ†‘è­‰ç®¡ç†åŠŸèƒ½... https://220.5.61.73/etd-manager/", "icon": "shield-check" },
            { "title": "å…§æ”¿éƒ¨-æŠµæŠ¼æ¬Šç·šä¸Šç”³è¾¦ç³»çµ±ç®¡ç†å¾Œå°", "href": "https://220.5.61.73/moa-manager/", "description": "å…§æ”¿éƒ¨æŠµæŠ¼æ¬Šç·šä¸Šç”³è¾¦ç³»çµ±ç®¡ç†å¾Œå° ... https://220.5.61.73/moa-manager/", "icon": "file-lock-2" },
            { "title": "åœ°æ”¿å±€-æ‰€æœ‰æ¬Šç§»è½‰ç™»è¨˜è¦è²»è©¦ç®—", "href": "https://www.land.tycg.gov.tw/chaspx/Ssearch04_new.aspx/45", "description": "æ‰€æœ‰æ¬Šç§»è½‰ç™»è¨˜è¦è²»è©¦ç®— ... https://www.land.tycg.gov.tw/chaspx/Ssearch04_new.aspx/45", "icon": "calculator" },
            { "title": "åœ°æ”¿å±€-æŠµæŠ¼æ¬Šè¨­å®šè¦è²»è©¦ç®—", "href": "https://www.land.tycg.gov.tw/chaspx/Ssearch03_new.aspx/44", "description": "æŠµæŠ¼æ¬Šè¨­å®šè¦è²»è©¦ç®— ... https://www.land.tycg.gov.tw/chaspx/Ssearch03_new.aspx/44", "icon": "banknote" }
            ]
        },
        {
            "category": "æ¸¬é‡èª²",
            "id": "sur",
            "icon": "ruler",
            "links": [
            { "title": "æ¸¬é‡èª²å°ˆå±¬å…¥å£ç¶²ç«™", "href": "http://220.1.34.18/service/section/%E6%B8%AC%E9%87%8F%E8%AA%B2/index.htm", "description": "æ³•é™¢åˆ¤æ±ºæ¡ˆä¾‹ã€æœƒè­°ç´€éŒ„ã€æ³•ä»¤è¦ç¯„ã€æ¸¬é‡æˆæœäº¤æ›ã€æ‡‰ç”¨è»Ÿé«”ã€å¸¸ç”¨è¡¨æ ¼ ...", "icon": "layout-list" },
            { "title": "æ¸¬é‡èª²ä¸‹è¼‰å€", "href": "http://220.1.34.18/service/section/%E6%B8%AC%E9%87%8F%E8%AA%B2/feedback.htm", "description": "æ¸¬é‡èª²è‡ªè¡Œç¶­è­·ä¹‹å„å¼æª”æ¡ˆä¸‹è¼‰å°ˆå€", "icon": "download" },
            { "title": "åœ°æ”¿ç³»çµ±207-æ¸¬é‡èª²1", "href": "http://220.1.34.207:9080/LandHA/", "description": "åœ°æ”¿ç³»çµ±æ¸¬é‡èª²æ“ä½œå°ˆå±¬ä¼ºæœå™¨ http://220.1.34.207:9080/LandHA/", "icon": "server" },
            { "title": "åœ°æ”¿ç³»çµ±62-æ¸¬é‡èª²2", "href": "http://220.1.34.62:9080/LandHA/", "description": "åœ°æ”¿ç³»çµ±æ¸¬é‡èª²æ“ä½œå°ˆå±¬ä¼ºæœå™¨ http://220.1.34.62:9080/LandHA/", "icon": "server" },
            { "title": "å»ºç®¡åœ–è³‡ä»‹æ¥ç³»çµ±", "href": "http://220.1.33.43:8080/Q14Web/", "description": "å»ºç‰©ç¬¬ä¸€æ¬¡æ¸¬é‡-ä½¿ç”¨åŸ·ç…§è³‡è¨ŠåŠç«£å·¥åœ–ä»‹æ¥ç³»çµ± http://220.1.33.43:8080/Q14Web/", "icon": "map" },
            { "title": "æ¸¬é‡é€¾æœŸæ¡ˆä»¶æŸ¥è©¢", "href": "http://220.1.34.75:8080/sur/expire", "description": "æ¸¬é‡é€¾æœŸæ¡ˆä»¶æŸ¥è©¢ http://220.1.34.75:8080/sur/expire", "icon": "calendar-clock" },
            { "title": "é‡æ¸¬æ›ç‹€é€šçŸ¥æ›¸ç³»çµ±", "href": "http://220.1.34.211:9080/XDT98/", "description": "é‡æ¸¬æ›ç‹€é€šçŸ¥æ›¸ç³»çµ± http://220.1.34.211:9080/XDT98/", "icon": "file-text" }
            ]
        },
        {
            "category": "åœ°åƒ¹èª²",
            "id": "val",
            "icon": "tags",
            "links": [
            { "title": "åœ°åƒ¹èª²å°ˆå±¬å…¥å£ç¶²ç«™", "href": "http://220.1.34.18/service/section/%E8%A1%8C%E6%94%BF%E8%AA%B2/fram.htm", "description": "æœ€æ–°æ¶ˆæ¯ã€æœƒè­°ç´€éŒ„ã€è¡¨å–®ä¸‹è¼‰ ...", "icon": "layout-list" },
            { "title": "åœ°åƒ¹èª²ä¸‹è¼‰å€", "href": "http://220.1.34.18/service/section/%E8%A1%8C%E6%94%BF%E8%AA%B2/fram.htm", "description": "åœ°åƒ¹èª²è‡ªè¡Œç¶­è­·ä¹‹å„å¼æª”æ¡ˆä¸‹è¼‰å°ˆå€", "icon": "download" },
            { "title": "åœ°æ”¿ç³»çµ±156-åœ°åƒ¹èª²", "href": "http://220.1.34.156:9080/LandHA/", "description": "åœ°æ”¿ç³»çµ±åœ°åƒ¹èª²æ“ä½œå°ˆå±¬ä¼ºæœå™¨ http://220.1.34.156:9080/LandHA/", "icon": "server" },
            { "title": "å¯¦åƒ¹ç™»éŒ„æ¡ˆä»¶æ§ç®¡", "href": "http://220.1.34.75:8080/prc/realprice", "description": "å¯¦åƒ¹ç™»éŒ„æ¡ˆä»¶æ§ç®¡é é¢ http://220.1.34.75:8080/prc/realprice", "icon": "file-check-2" },
            { "title": "å¯¦åƒ¹ç™»éŒ„JSONè³‡æ–™è§£æ", "href": "http://220.1.34.75:8080/prc/json-converter", "description": "å¯¦åƒ¹ç™»éŒ„JSONè³‡æ–™è§£æ http://220.1.34.75:8080/prc/json-converter", "icon": "file-json" },
            { "title": "ä¸å‹•ç”¢äº¤æ˜“æˆäº¤è³‡è¨Šç™»éŒ„æ©Ÿåˆ¶ç³»çµ±", "href": "http://220.5.61.195:8080/RPM/", "description": "ä¸å‹•ç”¢äº¤æ˜“æˆäº¤è³‡è¨Šç™»éŒ„æ©Ÿåˆ¶ç³»çµ± http://220.5.61.195:8080/RPM/", "icon": "database-zap" },
            { "title": "äº”æ–¹å€ä¼°ç³»çµ±", "href": "http://220.1.34.12/TomMis/", "description": "åœ°åƒ¹å€æ®µåŠƒåˆ†åŠå€æ®µåœ°åƒ¹ä¼°åƒ¹ä½œæ¥­ç³»çµ± http://220.1.34.12/TomMis/", "icon": "area-chart" },
            { "title": "å¯¦åƒ¹ç™»éŒ„æ¸…ç†ç³»çµ±", "href": "http://220.1.34.12/moi_estate/", "description": "å¯¦åƒ¹ç™»éŒ„æ¸…ç†ç³»çµ± http://220.1.34.12/moi_estate/", "icon": "file-scan" },
            { "title": "å¯¦åƒ¹ç™»éŒ„ç°¡è¨Šç³»çµ±", "href": "http://220.1.34.221/", "description": "å¯¦åƒ¹ç™»éŒ„ç°¡è¨Šç³»çµ± http://220.1.34.221/", "icon": "message-square-more" }
            ]
        },
        {
            "category": "è¡Œæ”¿èª²",
            "id": "adm",
            "icon": "briefcase",
            "links": [
            { "title": "è¡Œæ”¿èª²å°ˆå±¬å…¥å£ç¶²ç«™", "href": "http://220.1.34.18/service/section/04/index.htm", "description": "æœ€æ–°æ¶ˆæ¯ã€å¹´åº¦è¨ˆç•«ã€å…¬æ–‡ç¨½å‚¬ ...", "icon": "layout-list" },
            { "title": "è¡Œæ”¿èª²ä¸‹è¼‰å€", "href": "http://220.1.34.18/service/section/04/download.htm", "description": "è¡Œæ”¿èª²è‡ªè¡Œç¶­è­·å„å¼ä¸‹è¼‰å°ˆå€", "icon": "download" },
            { "title": "æª”æ¡ˆçŸ¥è­˜åº«", "href": "http://220.1.34.18/service/section/archives/archives.html", "description": "æª”æ¡ˆä½œæ¥­è¦åŠƒã€æª”æ¡ˆæ‡‰ç”¨ã€æª”æ¡ˆåˆ†é¡è¡¨ã€æœƒè­°è¨˜éŒ„ ...", "icon": "archive" },
            { "title": "åœ°æ”¿ç³»çµ±156-è¡Œæ”¿èª²", "href": "http://220.1.34.156:9080/LandHA/", "description": "åœ°æ”¿ç³»çµ±è¡Œæ”¿èª²æ“ä½œå°ˆå±¬ä¼ºæœå™¨ http://220.1.34.156:9080/LandHA/", "icon": "server" },
            { "title": "ééƒ½å¸‚åœŸåœ°ä½¿ç”¨ç·¨å®šç®¡ç†ç³»çµ±", "href": "http://220.1.34.12:8080/LandHA/", "description": "ééƒ½å¸‚åœŸåœ°ä½¿ç”¨ç·¨å®šç®¡ç†ç³»çµ± http://220.1.34.12:8080/LandHA/", "icon": "map-pin" },
            { "title": "æª”æ¡ˆæ‡‰ç”¨é ç´„ç”³è«‹æ§ç®¡ç³»çµ±", "href": "http://220.1.34.75:8080/adm/file", "description": "æ°‘çœ¾æª”æ¡ˆæ‡‰ç”¨æœå‹™ç”³è«‹æ§ç®¡ http://220.1.34.75:8080/adm/file", "icon": "file-archive" },
            { "title": "åœŸåœ°åƒè€ƒè³‡è¨Šæª”æŸ¥è©¢ç³»çµ±", "href": "http://220.1.34.213/ref/jsp/security/login.jsp", "description": "åœŸåœ°åƒè€ƒè³‡è¨Šæª”æŸ¥è©¢ç³»çµ± http://220.1.34.213/ref/jsp/security/login.jsp", "icon": "file-search" }
            ]
        },
        {
            "category": "è³‡è¨Šèª²",
            "id": "inf",
            "icon": "computer",
            "links": [
            { "title": "è³‡è¨Šèª²å°ˆå±¬å…¥å£ç¶²ç«™", "href": "http://220.1.34.18/service/section/%E8%B3%87%E8%A8%8A%E8%AA%B2/", "description": "æœ€æ–°æ¶ˆæ¯ã€è¡¨å–®ä¸‹è¼‰ã€æœƒè­°è¨˜éŒ„ ...", "icon": "layout-list" },
            { "title": "è³‡è¨Šèª²è¡¨å–®ä¸‹è¼‰", "href": "http://220.1.34.18/service/section/%E8%B3%87%E8%A8%8A%E8%AA%B2/download.html", "description": "æä¾›å„å¼è³‡è¨Šèª²ç”³è«‹è¡¨å–®ä¸‹è¼‰", "icon": "download" },
            { "title": "åœ°æ”¿è³‡è¨Šç³»çµ±ç›£æ§", "href": "http://220.1.34.75:8080/inf/dashboard", "description": "ä»¥å„€è¡¨æ¿å‘ˆç¾æœ€å³æ™‚çš„ç³»çµ±ç‹€æ…‹ http://220.1.34.75:8080/inf/dashboard", "icon": "tv" },
            { "title": "111æ•¸ç™¼éƒ¨æ”¿åºœç°¡è¨Šå¹³å°", "href": "https://111.gov.tw/psms_web/", "description": "æ”¿åºœå°ˆå±¬çŸ­ç¢¼ç°¡è¨Šå¹³è‡º(å¤–ç¶²) https://111.gov.tw/psms_web/", "icon": "message-circle" },
            { "title": "åœ°æ”¿ç³»çµ±17.20-æœ¬æ‰€æ¸¬è©¦æ©Ÿ", "href": "http://192.168.17.20:9080/LandHA/", "description": "åœ°æ”¿ç³»çµ±-è·¨ç¸£å¸‚æ¸¬è©¦æ©Ÿ http://192.168.17.20:9080/LandHA/", "icon": "server" },
            { "title": "åœ°æ”¿ç³»çµ±17.21-æ¡ƒåœ’å¤–æ›æ¸¬è©¦æ©Ÿ", "href": "http://192.168.17.21:9080/LandHA/", "description": "åœ°æ”¿ç³»çµ±-æ¡ƒåœ’å¤–æ›æ¸¬è©¦æ©Ÿ http://192.168.17.21:9080/LandHA/", "icon": "server" },
            { "title": "åœ°æ”¿ç³»çµ±17.22-è·¨ç¸£å¸‚æ¸¬è©¦æ©Ÿ", "href": "http://192.168.17.22:9080/LandHA/", "description": "åœ°æ”¿ç³»çµ±-è·¨ç¸£å¸‚æ¸¬è©¦æ©Ÿ http://192.168.17.22:9080/LandHA/", "icon": "server" },
            { "title": "æ¡ˆä»¶è¾¦ç†æƒ…å½¢é€šçŸ¥ç³»çµ±", "href": "http://220.1.34.221:8080/SMS98/", "description": "ç²¾èª é–‹ç™¼ä¹‹ç³»çµ±é€éã€Œä¸­è¯é›»ä¿¡è¨Šæ¯ä¸­å¿ƒAPIã€å‚³é€æ¡ˆä»¶è¾¦ç†ç‹€æ…‹ç°¡è¨ŠåŠé›»å­éƒµä»¶ http://220.1.34.221:8080/SMS98/", "icon": "message-circle-more" },
            { "title": "ä¾¿æ°‘è§¸æ§æŸ¥è©¢æ§åˆ¶å°", "href": "http://220.1.34.211:9080/touch/", "description": "ä¾¿æ°‘è§¸æ§æŸ¥è©¢æ§åˆ¶å° http://220.1.34.211:9080/touch/", "icon": "monitor" },
            { "title": "SRMAS æ©Ÿæˆ¿å¤©æ°£åœ–", "href": "http://220.1.34.75:8080/inf/weather/", "description": "æ©Ÿæˆ¿ç¶²è·¯åŠä¸»è¦ç³»çµ±ç‹€æ…‹é¡¯ç¤º http://220.1.34.75:8080/inf/weather/", "icon": "cloud-sun-rain" },
            { "title": "è³‡è¨Šèª²ä¼‘é–’æ™‚å…‰", "href": "http://220.1.34.18/service/section/%E8%B3%87%E8%A8%8A%E8%AA%B2/time.html", "description": "è¼•é¬†ä¸€ä¸‹ ... ğŸ˜€", "icon": "smile" },
            { "title": "è³‡è¨Šèª²æœ¬æœˆè¼ªå€¼è¡¨", "linkId": "inf-roster", "href": "http://220.1.34.18/service/section/%E8%B3%87%E8%A8%8A%E8%AA%B2/news/%E8%B3%87%E8%A8%8A%E8%AA%B2%E8%BC%AA%E5%80%BC%E8%A1%A8.pdf", "description": "è³‡è¨Šèª²æœ¬æœˆä»½æ¯æ—¥å·¥ä½œè¼ªå€¼è¡¨", "icon": "refresh-ccw-dot" }
            ]
        },
        {
            "category": "äººäº‹å®¤",
            "id": "hr",
            "icon": "users",
            "links": [
            { "title": "äººäº‹å®¤å°ˆå±¬å…¥å£ç¶²ç«™", "href": "http://220.1.34.18/service/section/%E4%BA%BA%E4%BA%8B%E5%AE%A4/index.htm", "description": "æœ€æ–°æ¶ˆæ¯ã€è¡¨å–®ä¸‹è¼‰ã€è·æŒæ¥­å‹™ ...", "icon": "layout-list" },
            { "title": "äººäº‹å®¤å„å¼è¡¨å–®ä¸‹è¼‰", "href": "http://220.1.34.18/service/section/%E4%BA%BA%E4%BA%8B%E5%AE%A4/download.html", "description": "æä¾›å„å¼äººäº‹ç›¸é—œç”³è«‹è¡¨å–®ä¸‹è¼‰", "icon": "user" },
            { "title": "å·®å‹¤æ›´æ­£å–®", "href": "http://220.1.34.18/service/section/%E4%BA%BA%E4%BA%8B%E5%AE%A4/download/107/00%E6%A1%83%E5%9C%92%E5%9C%B0%E6%94%BF%E4%BA%8B%E5%8B%99%E6%89%80%E5%8A%A0%E7%8F%AD%E8%AB%8B%E5%81%87%E6%9B%B4%E6%AD%A3%E7%94%B3%E8%AB%8B%E8%A1%A8.pdf", "description": "æä¾›å¿˜åˆ·å¡ç­‰ç›¸é—œå·®å‹¤æ›´æ­£ç”³è«‹å–®ä¸‹è¼‰ï¼Œè«‹å¡«å¦¥æ ¸ç« å¾Œé€äº¤äººäº‹å®¤è¾¦ç†ã€‚", "icon": "file-pen" },
            { "title": "å·®å‹¤ç³»çµ±æ“ä½œæ‰‹å†Š", "href": "http://220.1.34.18/service/section/%E4%BA%BA%E4%BA%8B%E5%AE%A4/pdf//WebITR2/WebITR2.0%E4%B8%80%E8%88%87%E4%BA%BA%E5%93%A1%E6%93%8D%E4%BD%9C%E6%89%8B%E5%86%8A_2_1_0_32.pdf", "description": "æä¾›å®Œæ•´ä¸€èˆ¬åŒä» WEBITR 2.0 æ“ä½œæ‰‹å†Š", "icon": "book-open" },
            { "title": "å„å¼å·®å‹¤åˆ·å¡ç¯„ä¾‹", "href": "http://220.1.34.18/service/section/%E4%BA%BA%E4%BA%8B%E5%AE%A4/pdf/%E5%88%B7%E5%8D%A1%E7%AF%84%E4%BE%8B1030601.pdf", "description": "æä¾›å„å¼åˆ·å¡ç¯„ä¾‹æ•™å­¸", "icon": "fingerprint" },
            { "title": "å¦‚ä½•æŸ¥è©¢å·®å‹¤è¨˜éŒ„", "href": "http://220.1.34.18/service/section/%E4%BA%BA%E4%BA%8B%E5%AE%A4/pdf/WebITR2/%E6%9F%A5%E8%A9%A2%E5%87%BA%E5%8B%A4%E8%A8%98%E9%8C%84%E6%95%99%E5%AD%B8.pdf", "description": "æä¾›ç°¡æ˜“å·®å‹¤è¨˜éŒ„æŸ¥è©¢æ­¥é©Ÿ", "icon": "history" },
            { "title": "å·®å‹¤æ¡ˆä»¶ç”³è«‹å–æ¶ˆæ•™å­¸", "href": "http://220.1.34.18/service/section/%E4%BA%BA%E4%BA%8B%E5%AE%A4/pdf/WebITR2/%E5%B7%AE%E5%8B%A4%E6%A1%88%E4%BB%B6%E7%94%B3%E8%AB%8B%E5%8F%96%E6%B6%88%E6%95%99%E5%AD%B8.pdf", "description": "æä¾›ç°¡æ˜“å‡ºå·®åŠ ç­å–æ¶ˆæ•™å­¸", "icon": "calendar-x" },
            { "title": "è²»ç”¨ç”³è«‹æ•™å­¸", "href": "http://220.1.34.18/service/section/%E4%BA%BA%E4%BA%8B%E5%AE%A4/pdf/WebITR2/%E8%B2%BB%E7%94%A8%E7%94%B3%E8%AB%8B%E6%95%99%E5%AD%B8.pdf", "description": "æä¾›ç°¡æ˜“ç”³è«‹å·®æ—…è²»ã€åŠ ç­è²»æ•™å­¸", "icon": "banknote" },
            { "title": "å€‹äººè³‡æ–™ç›¸é—œæ•™å­¸", "href": "http://220.1.34.18/service/section/%E4%BA%BA%E4%BA%8B%E5%AE%A4/pdf/WebITR2/%E5%80%8B%E4%BA%BA%E8%B3%87%E6%96%99%E7%9B%B8%E9%97%9C%E6%95%99%E5%AD%B8.pdf", "description": "æä¾›ç°¡æ˜“æŸ¥è©¢åŸºæœ¬è³‡æ–™ã€ä¿®æ”¹é›»å­éƒµä»¶ã€å¸³è™Ÿå¯†ç¢¼...ç­‰å·®å‹¤ç³»çµ±åŠŸèƒ½æ•™å­¸", "icon": "user-cog" },
            { "title": "è«‹å‡è¦å®š", "href": "http://220.1.34.18/service/section/%E4%BA%BA%E4%BA%8B%E5%AE%A4/pdf/%E8%AB%8B%E5%81%87%E5%92%8C%E4%BC%91%E5%81%87/104%E7%B5%A6%E5%81%87%E4%B8%80%E8%A6%BD%E8%A1%A8_002.pdf", "description": "æä¾›è«‹å‡è¦å®šPDFæª¢è¦–", "icon": "file-text" },
            { "title": "å¦‚ä½•æŸ¥è©¢ä¼‘å‡ç´€éŒ„", "href": "http://220.1.34.18/service/section/%E4%BA%BA%E4%BA%8B%E5%AE%A4/pdf/WebITR2/%E5%A6%82%E4%BD%95%E6%9F%A5%E8%A9%A2%E4%BC%91%E5%81%87%E7%B4%80%E9%8C%84.pdf", "description": "æä¾›ç°¡æ˜“æŸ¥è©¢å·²ä¼‘å‡å¤©æ•¸æŸ¥è©¢æ­¥é©Ÿ", "icon": "calendar-search" },
            { "title": "ç”³è«‹ä¼‘å‡æ•™å­¸", "href": "http://220.1.34.18/service/section/%E4%BA%BA%E4%BA%8B%E5%AE%A4/pdf/WebITR2/%E4%BC%91%E5%81%87%E7%94%B3%E8%AB%8B%E6%95%99%E5%AD%B8.pdf", "description": "æä¾›ç°¡æ˜“ç”³è«‹ä¼‘å‡æ•™å­¸", "icon": "calendar-plus" },
            { "title": "ç”³è«‹å…¬å‡è£œä¼‘æ•™å­¸", "href": "http://220.1.34.18/service/section/%E4%BA%BA%E4%BA%8B%E5%AE%A4/pdf/WebITR2/%E5%85%AC%E5%81%87%E8%A3%9C%E4%BC%91%E7%94%B3%E8%AB%8B%E6%95%99%E5%AD%B8.pdf", "description": "æä¾›ç°¡æ˜“ç”³è«‹å…¬å‡è£œä¼‘æ•™å­¸", "icon": "briefcase" },
            { "title": "è«‹å‡å‡ºåœ‹æ•™å­¸", "href": "http://220.1.34.18/service/section/%E4%BA%BA%E4%BA%8B%E5%AE%A4/pdf/WebITR2/%E5%87%BA%E5%9C%8B%E8%AB%8B%E5%81%87%E7%94%B3%E8%AB%8B%E6%95%99%E5%AD%B8.pdf", "description": "æä¾›ç°¡æ˜“å‡ºåœ‹è«‹å‡æ•™å­¸", "icon": "plane" },
            { "title": "å…¬å‹™äººå“¡ä¿¸é¡è¡¨", "href": "http://220.1.34.18/service/section/%E8%B3%87%E8%A8%8A%E8%AA%B2/news/%E5%85%AC%E5%8B%99%E4%BA%BA%E5%93%A1%E4%BF%B8%E9%A1%8D%E8%A1%A8.pdf", "description": "å…¬å‹™äººå“¡è–ªä¿¸éšæ¢¯ç°¡æ˜è¡¨", "icon": "banknote" },
            { "title": "å…¬å‹™äººå“¡å©šå–ªç”Ÿè‚²è¡¨", "href": "http://220.1.34.18/service/section/%E8%B3%87%E8%A8%8A%E8%AA%B2/news/å…¬å‹™äººå“¡å©šå–ªè£œç”Ÿè‚²åŠ©è¡¨.pdf", "description": "å…¬å‹™äººå“¡å©šå–ªç”Ÿè‚²è£œåŠ©è¡¨", "icon": "gift" }
            ]
        },
        {
            "category": "æœƒè¨ˆå®¤",
            "id": "acc",
            "icon": "calculator",
            "links": [
            { "title": "æœƒè¨ˆå®¤(å…§éƒ¨æ§åˆ¶)å°ˆå±¬å…¥å£ç¶²ç«™", "href": "http://220.1.34.18/service/section/%E6%9C%83%E8%A8%88%E5%AE%A4/index.htm", "description": "åƒè€ƒè³‡æ–™ã€æœƒè­°ç´€éŒ„ã€å…§æ§åˆ¶åº¦ ...", "icon": "layout-list" }
            ]
        },
        {
            "category": "å¸¸ç”¨è¡¨å–®",
            "id": "files",
            "icon": "file-down",
            "links": [
            { "title": "ã€æœ¬æ‰€ã€‘é›»è…¦å•é¡Œè™•ç†è¡¨", "href": "http://220.1.34.18/service/section/%E8%B3%87%E8%A8%8A%E8%AA%B2/%E5%B8%B8%E7%94%A8%E8%A1%A8%E6%A0%BC/%E9%9B%BB%E8%85%A6%E4%BD%9C%E6%A5%AD%E7%B3%BB%E7%B5%B1%E4%BD%BF%E7%94%A8%E8%80%85%E5%95%8F%E9%A1%8C%E5%8F%8A%E8%99%95%E7%90%86%E6%83%85%E5%BD%A2%E7%B4%80%E9%8C%84%E8%A1%A8(%E6%A9%AB).doc", "description": "è³‡è¨Šèª²-é›»è…¦å•é¡Œè™•ç†è¡¨ ", "icon": "bug" },
            { "title": "ã€è·¨æ‰€ã€‘è·¨æ‰€æ¡ˆä»¶é€šå ±å–®", "href": "http://220.1.34.18/service/section/%E8%B3%87%E8%A8%8A%E8%AA%B2/%E5%B8%B8%E7%94%A8%E8%A1%A8%E6%A0%BC/%E8%B7%A8%E6%89%80%E6%A1%88%E4%BB%B6%E9%80%9A%E5%A0%B1%E5%96%AE.doc", "description": "è³‡è¨Šèª²-å—ç†è·¨æ‰€ç™»è¨˜æ¡ˆä»¶é€šå ±å–®", "icon": "arrow-right-left" },
            { "title": "æ‰€å…§é›»è©±ä¸€è¦½è¡¨", "href": "http://220.1.34.18/service/section/%E8%B3%87%E8%A8%8A%E8%AA%B2/news/%E6%89%80%E5%85%A7%E9%9B%BB%E8%A9%B1%E4%B8%80%E8%A6%BD%E8%A1%A8.pdf", "description": "æœ€æ–°äº‹å‹™æ‰€å…§é›»è©±ä¸€è¦½è¡¨", "icon": "phone-forwarded" },
            { "title": "ç”³è«‹å¥æª¢è£œåŠ©è²»æ†‘è­‰", "href": "http://220.1.34.18/service/section/%E4%BA%BA%E4%BA%8B%E5%AE%A4/download/105%E5%81%A5%E6%AA%A2%E6%86%91%E8%AD%89%E7%94%A8%E7%B4%99.pdf", "description": "äººäº‹å®¤-40æ­²ä»¥ä¸Šå…¬å‹™äººå“¡ç”³è«‹å¥åº·æª¢æŸ¥è£œåŠ©è²»æ†‘è­‰ç”¨ç´™(é ˆå€åŸŸé†«é™¢ä»¥ä¸Šé†«é™¢)", "icon": "heart-pulse" },
            { "title": "å·®å‹¤æ›´æ­£å–®", "href": "http://220.1.34.18/service/section/%E4%BA%BA%E4%BA%8B%E5%AE%A4/download/107/00%E6%A1%83%E5%9C%92%E5%9C%B0%E6%94%BF%E4%BA%8B%E5%8B%99%E6%89%80%E5%8A%A0%E7%8F%AD%E8%AB%8B%E5%81%87%E6%9B%B4%E6%AD%A3%E7%94%B3%E8%AB%8B%E8%A1%A8.pdf", "description": "äººäº‹å®¤-æ¡ƒåœ’åœ°æ”¿äº‹å‹™æ‰€åŠ ç­è«‹å‡æ›´æ­£ç”³è«‹å–®", "icon": "file-check-2" },
            { "title": "DutyRoster", "linkId": "main-gate-roster", "href": "http://220.1.34.18/service/section/%E4%BA%BA%E4%BA%8B%E5%AE%A4/photogallery/%E8%BC%AA%E5%80%BC%E8%A1%A8/114/7%E6%9C%88%E8%BC%AA%E5%80%BC%E8%A1%A8.pdf", "description": "æœ¬æœˆä»½å…¨æ‰€é—œå¤§é–€è¼ªå€¼ç­è¡¨PDFæª¢è¦–", "icon": "flashlight" },
            { "title": "å…¬å‹™äººå“¡ä¿¸é¡è¡¨", "href": "http://220.1.34.18/service/section/%E8%B3%87%E8%A8%8A%E8%AA%B2/news/%E5%85%AC%E5%8B%99%E4%BA%BA%E5%93%A1%E4%BF%B8%E9%A1%8D%E8%A1%A8.pdf", "description": "å…¬å‹™äººå“¡è–ªä¿¸éšæ¢¯ç°¡æ˜è¡¨", "icon": "banknote" },
            { "title": "å…¬å‹™äººå“¡å©šå–ªç”Ÿè‚²è¡¨", "href": "http://220.1.34.18/service/section/%E8%B3%87%E8%A8%8A%E8%AA%B2/news/å…¬å‹™äººå“¡å©šå–ªè£œç”Ÿè‚²åŠ©è¡¨.pdf", "description": "å…¬å‹™äººå“¡å©šå–ªç”Ÿè‚²è£œåŠ©è¡¨", "icon": "gift" }
            ]
        }
    ]
    </script>
    
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const { createApp, ref, reactive, computed, watch, onMounted, nextTick } = Vue;

            // =================================================================
            // Composable å‡½å¼ï¼šå°‡ç›¸é—œé‚è¼¯å°è£åœ¨ä¸€èµ·ï¼Œæé«˜å¯è®€æ€§èˆ‡è¤‡ç”¨æ€§
            // =================================================================

            /**
             * @description ç®¡ç†ä¸»é¡Œï¼ˆæ·ºè‰²/æ·±è‰²æ¨¡å¼ï¼‰çš„ Composable
             */
            function useTheme() {
                const getInitialTheme = () => {
                    const storedTheme = localStorage.getItem('theme');
                    if (storedTheme === 'light' || storedTheme === 'dark') {
                        return storedTheme;
                    }
                    if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
                        return 'dark';
                    }
                    return 'light';
                };

                const theme = ref(getInitialTheme());

                const applyTheme = (themeValue) => {
                    document.documentElement.dataset.theme = themeValue;
                };

                const toggleTheme = () => {
                    theme.value = theme.value === 'light' ? 'dark' : 'light';
                };

                watch(theme, (newTheme) => {
                    localStorage.setItem('theme', newTheme);
                    applyTheme(newTheme);
                }, { immediate: true });

                return { theme, toggleTheme };
            }

            /**
             * @description ç®¡ç†å´é‚Šæ¬„ç‹€æ…‹çš„ Composable
             */
            function useSidebar() {
                const isSidebarCollapsed = ref(localStorage.getItem('sidebarCollapsed') === 'true');

                const toggleSidebar = () => {
                    isSidebarCollapsed.value = !isSidebarCollapsed.value;
                };

                watch(isSidebarCollapsed, (isCollapsed) => {
                    localStorage.setItem('sidebarCollapsed', isCollapsed);
                });

                return { isSidebarCollapsed, toggleSidebar };
            }

            /**
             * @description ç®¡ç†å³æ™‚æ™‚é˜çš„ Composable
             */
            function useClock() {
                const currentTime = ref('');
                const currentDate = ref('');

                const updateTime = () => {
                    const now = new Date();
                    currentTime.value = now.toLocaleTimeString('zh-TW', { hour: '2-digit', minute: '2-digit', second: '2-digit', hour12: false });
                    currentDate.value = now.toLocaleDateString('zh-TW', { year: 'numeric', month: 'long', day: 'numeric' });
                };

                onMounted(() => {
                    updateTime();
                    setInterval(updateTime, 1000);
                });

                return { currentTime, currentDate };
            }
            
            /**
             * @description ç®¡ç†å­—é«”å¤§å°çš„ Composable
             */
            function useFontSize() {
                const fontSizes = { small: '110%', medium: '120%', large: '130%' };
                const fontSizeKeys = ['small', 'medium', 'large'];
                const fontSizeLabels = { small: 'å°', medium: 'ä¸­', large: 'å¤§' };

                const fontSize = ref(localStorage.getItem('fontSize') || 'small');

                const fontSizeLabel = computed(() => fontSizeLabels[fontSize.value]);

                const applyFontSize = () => {
                    document.documentElement.style.fontSize = fontSizes[fontSize.value];
                };

                const toggleFontSize = () => {
                    const currentIndex = fontSizeKeys.indexOf(fontSize.value);
                    const nextIndex = (currentIndex + 1) % fontSizeKeys.length;
                    fontSize.value = fontSizeKeys[nextIndex];
                };

                watch(fontSize, (newSize) => {
                    localStorage.setItem('fontSize', newSize);
                    applyFontSize();
                });

                onMounted(applyFontSize);

                return { fontSize, fontSizeLabel, toggleFontSize };
            }

            /**
             * @description ç®¡ç†æ›¸ç±¤è³‡æ–™èˆ‡äº’å‹•çš„ Composable
             */
            function useBookmarks(theme, openIframeModal) { // << ä¿®æ”¹ï¼šæ¥æ”¶ openIframeModal
                // å¾ HTML ä¸­è®€å–åŸå§‹è³‡æ–™
                const bookmarksDataEl = document.getElementById('bookmark-data');
                const rawBookmarksData = JSON.parse(bookmarksDataEl.textContent || '[]');

                /**
                 * @description åŒæ­¥è™•ç†æ›¸ç±¤è³‡æ–™ï¼šæ›´æ–°ç•¶æœˆè¼ªå€¼è¡¨ã€åŠ ä¸Šå”¯ä¸€ ID
                 * @returns {Array} - åˆæ­¥è™•ç†å¾Œçš„æ›¸ç±¤è³‡æ–™
                 */
                const getInitialBookmarks = () => {
                    const now = new Date();
                    const rocYear = now.getFullYear() - 1911;
                    const currentMonth = now.getMonth() + 1;
                    
                    const bookmarksCopy = JSON.parse(JSON.stringify(rawBookmarksData));

                    // æ›´æ–° "å¸¸ç”¨è¡¨å–®ä¸‹è¼‰" çš„å¤§é–€è¼ªå€¼è¡¨
                    const filesCategory = bookmarksCopy.find(c => c.id === 'files');
                    if (filesCategory) {
                        const dutyRosterLink = filesCategory.links.find(l => l.linkId === 'main-gate-roster');
                        if (dutyRosterLink) {
                            dutyRosterLink.title = `${rocYear}å¹´${currentMonth}æœˆå¤§é–€è¼ªå€¼è¡¨`;
                            dutyRosterLink.href = `http://220.1.34.18/service/section/%E4%BA%BA%E4%BA%8B%E5%AE%A4/photogallery/%E8%BC%AA%E5%80%BC%E8%A1%A8/${rocYear}/${currentMonth}%E6%9C%88%E8%BC%AA%E5%80%BC%E8%A1%A8.pdf`;
                            dutyRosterLink.description = `æœ¬æœˆä»½å…¨æ‰€é—œå¤§é–€è¼ªå€¼ç­è¡¨PDFæª¢è¦–`;
                        }
                    }

                    // æ›´æ–° "è³‡è¨Šèª²" çš„è¼ªå€¼è¡¨
                    const infCategory = bookmarksCopy.find(c => c.id === 'inf');
                    if (infCategory) {
                        const infoDutyRosterLink = infCategory.links.find(l => l.linkId === 'inf-roster');
                        if (infoDutyRosterLink) {
                            infoDutyRosterLink.title = `è³‡è¨Šèª²${rocYear}å¹´${currentMonth}æœˆè¼ªå€¼è¡¨`;
                            // æ³¨æ„ï¼šé€™è£¡çš„é€£çµçµæ§‹èˆ‡å¤§é–€è¼ªå€¼è¡¨ä¸åŒï¼Œä¿æŒåŸæ¨£
                            infoDutyRosterLink.href = `http://220.1.34.18/service/section/%E8%B3%87%E8%A8%8A%E8%AA%B2/news/%E8%B3%87%E8%A8%8A%E8%AA%B2%E8%BC%AA%E5%80%BC%E8%A1%A8.pdf`;
                            infoDutyRosterLink.description = `è³‡è¨Šèª²æœ¬æœˆä»½æ¯æ—¥å·¥ä½œè¼ªå€¼è¡¨`;
                        }
                    }
                    
                    // ç‚ºæ¯å€‹ link åŠ ä¸Šå”¯ä¸€çš„ ID å’Œæ–°çš„ nextMonthHtml å±¬æ€§
                    return bookmarksCopy.map(category => ({
                        ...category,
                        links: category.links.map((link, index) => ({
                            ...link,
                            id: `${category.id}-${index}`,
                            nextMonthHtml: '' // *** NEW: åˆå§‹åŒ– nextMonthHtml å±¬æ€§ ***
                        }))
                    }));
                };
                
                const bookmarks = reactive(getInitialBookmarks());

                /**
                 * @description ç•°æ­¥æª¢æŸ¥ä¸‹å€‹æœˆçš„è¼ªå€¼è¡¨æ˜¯å¦å­˜åœ¨ï¼Œä¸¦æ›´æ–°æè¿°
                 */
                const checkNextMonthRosters = async () => {
                    const now = new Date();
                    const rocYear = now.getFullYear() - 1911;
                    
                    let nextMonth = now.getMonth() + 2; // getMonth() æ˜¯ 0-11ï¼Œæ‰€ä»¥ +2
                    let nextMonthRocYear = rocYear;
                    if (nextMonth > 12) {
                        nextMonth = 1;
                        nextMonthRocYear += 1;
                    }

                    // æª¢æŸ¥å¤§é–€è¼ªå€¼è¡¨
                    const mainGateRoster = bookmarks
                        .find(c => c.id === 'files')?.links
                        .find(l => l.linkId === 'main-gate-roster');
                    
                    if (mainGateRoster) {
                        const nextMonthUrl = `http://220.1.34.18/service/section/%E4%BA%BA%E4%BA%8B%E5%AE%A4/photogallery/%E8%BC%AA%E5%80%BC%E8%A1%A8/${nextMonthRocYear}/${nextMonth}%E6%9C%88%E8%BC%AA%E5%80%BC%E8%A1%A8.pdf`;
                        try {
                            const response = await fetch(nextMonthUrl, { method: 'HEAD' });
                            if (response.ok) {
                                // *** FIX: æ›´æ–° nextMonthHtml è€Œä¸æ˜¯ description ***
                                mainGateRoster.nextMonthHtml = ` | <a href="${nextMonthUrl}" target="_blank" class="text-blue-500 hover:underline">é è¦½${nextMonth}æœˆ</a>`;
                            }
                        } catch (error) {
                            console.warn(`ç„¡æ³•æª¢æŸ¥ä¸‹å€‹æœˆçš„å¤§é–€è¼ªå€¼è¡¨: ${nextMonthUrl}`, error);
                        }
                    }

                    // æª¢æŸ¥è³‡è¨Šèª²è¼ªå€¼è¡¨
                    const infRoster = bookmarks
                        .find(c => c.id === 'inf')?.links
                        .find(l => l.linkId === 'inf-roster');

                    if (infRoster) {
                        const nextMonthUrl = `http://220.1.34.18/service/section/%E8%B3%87%E8%A8%8A%E8%AA%B2/news/%E8%B3%87%E8%A8%8A%E8%AA%B2%E8%BC%AA%E5%80%BC%E8%A1%A8NEXT.pdf`;
                        try {
                            const response = await fetch(nextMonthUrl, { method: 'HEAD' });
                            if (response.ok) {
                                // *** FIX: æ›´æ–° nextMonthHtml è€Œä¸æ˜¯ description ***
                                infRoster.nextMonthHtml = ` | <a href="${nextMonthUrl}" target="_blank" class="text-blue-500 hover:underline">é è¦½ä¸‹æœˆ</a>`;
                            }
                        } catch (error) {
                            console.warn(`ç„¡æ³•æª¢æŸ¥ä¸‹å€‹æœˆçš„è³‡è¨Šèª²è¼ªå€¼è¡¨: ${nextMonthUrl}`, error);
                        }
                    }
                };
                
                const currentCategoryId = ref(localStorage.getItem('lastSelectedCategory') || (bookmarks.length > 0 ? bookmarks[0].id : null));
                const clickCounts = ref(JSON.parse(localStorage.getItem('clickCounts') || '{}'));
                const recentLinks = ref(JSON.parse(localStorage.getItem('recentLinks') || '[]'));
                
                const selectCategory = (id) => {
                    currentCategoryId.value = id;
                };

                const currentCategory = computed(() => {
                    return bookmarks.find(c => c.id === currentCategoryId.value) || { category: 'æœªåˆ†é¡', links: [] };
                });

                const currentCategoryLinks = computed(() => {
                    const links = [...(currentCategory.value.links || [])];

                    links.sort((a, b) => {
                        const indexA = recentLinks.value.indexOf(a.id);
                        const indexB = recentLinks.value.indexOf(b.id);
                        if (indexA !== -1 && indexB !== -1) return indexA - indexB;
                        if (indexA !== -1) return -1;
                        if (indexB !== -1) return 1;
                        return a.title.localeCompare(b.title, 'zh-Hant');
                    });

                    return links;
                });
                
                // *** FIX: ä¿®æ”¹é»æ“Šäº‹ä»¶è™•ç†é‚è¼¯ä»¥è§£æ±ºå·¢ç‹€é€£çµå•é¡Œ ***
                const handleLinkClick = (link, event) => {
                    const clickedAnchor = event.target.closest('a');

                    // å¦‚æœé»æ“Šçš„æ˜¯å·¢ç‹€çš„ <a> æ¨™ç±¤ï¼Œä¸”å®ƒä¸æ˜¯å¡ç‰‡æœ¬èº«ï¼Œå°±è®“ç€è¦½å™¨æ­£å¸¸è™•ç†
                    if (clickedAnchor && clickedAnchor !== event.currentTarget) {
                        return;
                    }
                    
                    // é˜»æ­¢å¡ç‰‡æœ¬èº«çš„é è¨­å°èˆªè¡Œç‚º
                    event.preventDefault();

                    // --- ä»¥ä¸‹ç‚ºåŸæœ‰çš„é‚è¼¯ ---
                    // æ›´æ–°é»æ“Šæ¬¡æ•¸èˆ‡æœ€è¿‘é»æ“Šæ¸…å–®
                    clickCounts.value[link.id] = (clickCounts.value[link.id] || 0) + 1;
                    const index = recentLinks.value.indexOf(link.id);
                    if (index > -1) {
                        recentLinks.value.splice(index, 1);
                    }
                    recentLinks.value.unshift(link.id);
                    if (recentLinks.value.length > 10) {
                        recentLinks.value.pop();
                    }

                    // åˆ¤æ–· Ctrl éµ
                    if (event.ctrlKey) {
                        // å¦‚æœæŒ‰ä¸‹äº† Ctrlï¼Œå‰‡åœ¨ Modal ä¸­é–‹å•Ÿ
                        openIframeModal(link.href, link.title);
                    } else {
                        // å¦å‰‡ï¼ŒåŸ·è¡Œé è¨­è¡Œç‚º (åœ¨æ–°åˆ†é æˆ–ç•¶å‰é é¢é–‹å•Ÿ)
                        window.open(link.href, getLinkTarget(link.href));
                    }
                };

                const getRecentHighlightStyle = (link) => {
                    const index = recentLinks.value.indexOf(link.id);
                    if (index === -1) return {};
                    const opacity = Math.max(0.1, 1 - (index * 0.1));
                    const isDark = theme.value === 'dark';
                    const bgRgb = isDark ? '58, 55, 44' : '255, 251, 224';
                    const borderRgb = isDark ? '161, 98, 7' : '252, 211, 77';
                    return {
                        backgroundColor: `rgba(${bgRgb}, ${opacity})`,
                        borderColor: `rgba(${borderRgb}, ${opacity})`,
                        transition: 'background-color 0.3s, border-color 0.3s'
                    };
                };

                watch(clickCounts, (newCounts) => {
                    localStorage.setItem('clickCounts', JSON.stringify(newCounts));
                }, { deep: true });

                watch(recentLinks, (newLinks) => {
                    localStorage.setItem('recentLinks', JSON.stringify(newLinks));
                }, { deep: true });
                
                watch(currentCategoryId, (newId) => {
                    if (newId) {
                       localStorage.setItem('lastSelectedCategory', newId);
                    }
                });

                const getLinkTarget = (url) => {
                    try {
                        const urlObj = new URL(url, window.location.origin);
                        return urlObj.protocol.startsWith('http') ? '_blank' : '_self';
                    } catch (e) {
                        return '_blank';
                    }
                };

                const isDownloadable = (url) => {
                    return /\.(zip|rar|7z|exe|dmg|doc|docx|xls|xlsx|ppt|pptx)$/i.test(url);
                };

                return { 
                    bookmarks, 
                    currentCategoryId, 
                    selectCategory, 
                    currentCategory, 
                    currentCategoryLinks,
                    clickCounts,
                    recentLinks,
                    handleLinkClick,
                    getLinkTarget,
                    isDownloadable,
                    checkNextMonthRosters,
                    getRecentHighlightStyle
                };
            }

            /**
             * @description ç®¡ç† PDF é è¦½å™¨ï¼ˆå½ˆå‡ºè¦–çª—èˆ‡æ‡¸æµ®é è¦½ï¼‰çš„ Composable
             */
            function usePdfViewer() {
                const pdfModal = reactive({ visible: false, url: '' });
                const pdfPopover = ref(null);
                const pdfPopoverState = reactive({ visible: false, url: '', x: 0, y: 0 });
                let popoverTimeout = null;

                const openPdfModal = (url) => {
                    pdfModal.url = `${url}#view=FitH&toolbar=1&navpanes=1`;
                    pdfModal.visible = true;
                };

                const closePdfModal = () => {
                    pdfModal.visible = false;
                    pdfModal.url = '';
                };

                const handlePdfHover = (event, url) => {
                    if (!url.toLowerCase().endsWith('.pdf')) return;
                    
                    clearTimeout(popoverTimeout);
                    popoverTimeout = setTimeout(() => {
                        pdfPopoverState.url = `${url}#view=FitH&toolbar=0&navpanes=0`;
                        const popoverWidth = 480; 
                        const popoverHeight = 576;
                        const viewportWidth = window.innerWidth;
                        const viewportHeight = window.innerHeight;
                        const offset = 15;
                        let finalX = event.clientX + offset;
                        let finalY = event.clientY + offset;
                        if (finalX + popoverWidth > viewportWidth) finalX = event.clientX - popoverWidth - offset;
                        if (finalY + popoverHeight > viewportHeight) finalY = event.clientY - popoverHeight - offset;
                        if (finalX < 0) finalX = 0;
                        if (finalY < 0) finalY = 0;
                        pdfPopoverState.x = finalX;
                        pdfPopoverState.y = finalY;
                        pdfPopoverState.visible = true;
                    }, 500);
                };
                
                const hidePdfPopover = () => {
                    clearTimeout(popoverTimeout);
                    pdfPopoverState.visible = false;
                };

                watch(() => pdfModal.visible, (isVisible) => {
                    document.body.classList.toggle('modal-open', isVisible);
                });

                return { pdfModal, pdfPopover, pdfPopoverState, openPdfModal, closePdfModal, handlePdfHover, hidePdfPopover };
            }

            /**
             * @description [æ–°å¢] ç®¡ç† IFrame Modal çš„ Composable
             */
            function useIframeModal() {
                const iframeModal = reactive({ visible: false, url: '', title: '' });

                const openIframeModal = (url, title) => {
                    iframeModal.url = url;
                    iframeModal.title = title || 'ç¶²é å…§å®¹';
                    iframeModal.visible = true;
                };

                const closeIframeModal = () => {
                    iframeModal.visible = false;
                    iframeModal.url = '';
                    iframeModal.title = '';
                };

                // ç›£è½ Modal å¯è¦‹æ€§ï¼Œä»¥é˜²æ­¢èƒŒæ™¯æ»¾å‹•
                watch(() => iframeModal.visible, (isVisible) => {
                    // åªæœ‰åœ¨æ²’æœ‰å…¶ä»– modal æ‰“é–‹æ™‚æ‰åˆ‡æ› class
                    if (!document.querySelector('.modal-content')) {
                       document.body.classList.toggle('modal-open', isVisible);
                    }
                });

                return { iframeModal, openIframeModal, closeIframeModal };
            }

            /**
             * @description å…¶ä»–å·¥å…·å‡½å¼
             */
            function useUtils() {
                const renderer = new marked.Renderer();
                renderer.link = (href, title, text) => {
                    if (typeof href !== 'string' || !href) return text;
                    const isExternal = href.startsWith('http');
                    const target = isExternal ? ' target="_blank" rel="noopener noreferrer"' : '';
                    return `<a href="${href}" title="${title || ''}"${target}>${text}</a>`;
                };
                marked.use({ renderer });

                const markdownToHtml = (markdownText) => {
                    if (!markdownText || typeof marked === 'undefined') return markdownText || '';
                    const textWithLinkedUrls = markdownText.replace(
                        /(?<!\S)(https?:\/\/[^\s<>"']+)/g,
                        (url) => `[${url}](${url})`
                    );
                    return marked.parse(textWithLinkedUrls, { breaks: true, gfm: true });
                };
                
                return { markdownToHtml };
            }


            // =================================================================
            // Vue æ‡‰ç”¨ç¨‹å¼å¯¦ä¾‹
            // =================================================================

            const app = createApp({
                setup() {
                    // çµ„åˆæ‰€æœ‰ Composable å‡½å¼
                    const themeManager = useTheme();
                    const sidebarManager = useSidebar();
                    const clockManager = useClock();
                    const fontSizeManager = useFontSize();
                    const pdfViewerManager = usePdfViewer();
                    const iframeModalManager = useIframeModal(); // << æ–°å¢
                    const bookmarkManager = useBookmarks(themeManager.theme, iframeModalManager.openIframeModal); // << ä¿®æ”¹ï¼šå‚³å…¥ openIframeModal
                    const utils = useUtils();

                    onMounted(() => {
                        bookmarkManager.checkNextMonthRosters();
                        lucide.createIcons();
                        watch([
                            themeManager.theme, 
                            sidebarManager.isSidebarCollapsed, 
                            bookmarkManager.currentCategoryLinks
                        ], () => {
                            nextTick(() => {
                                lucide.createIcons();
                            });
                        }, { deep: true, immediate: true });
                    });

                    // å°‡æ‰€æœ‰éœ€è¦æš´éœ²çµ¦æ¨¡æ¿çš„ç‹€æ…‹å’Œæ–¹æ³•é›†ä¸­è¿”å›
                    return {
                        ...themeManager,
                        ...sidebarManager,
                        ...clockManager,
                        ...fontSizeManager,
                        ...bookmarkManager,
                        ...pdfViewerManager,
                        ...iframeModalManager, // << æ–°å¢
                        ...utils
                    };
                }
            });

            app.mount('#app');
        });
    </script>
</body>

</html>

