<!DOCTYPE html>
<html lang="zh-TW">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="For zhongli land office use only">
    <meta name="author" content="LIU, PANG-YU">
    <meta http-equiv="pragma" content="no-cache">
    <meta http-equiv="expires" content="0">
    <meta http-equiv="cache-control" content="no-cache">
    <title>應繼分系統表-桃園市中壢地政事務所</title>
    <!-- Bootstrap core CSS -->
    <link rel="preload" href="assets/css/bootstrap.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <link rel="preload" href="assets/css/loading.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <link rel="preload" href="assets/css/loading-btn.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <link rel="preload" href="assets/css/animate.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <link rel="preload" href="assets/css/awesome-font.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <link rel="preload" href="assets/css/bootstrap-vue.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <link rel="preload" href="assets/css/main.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <link rel="preload" href="assets/js/treant/Treant.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <link rel="preload" href="assets/js/treant/examples/basic-example/basic-example.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <style>
        .Treant img {
            max-width: 64px;
        }
        .card {
            max-width: 640px;
        }
    </style>
</head>

<body>
    <section class="hide">
        <div class="container-fluid" v-cloak>
            <b-card-group columns style="margin-top: 450px">
                <lah-xap-connection-chart demo></lah-xap-connection-chart>
                <lah-xap-history-chart site="HA" type='bar' demo></lah-xap-history-chart>
            </b-card-group>
            <b-button v-b-toggle.sidebar-1>Toggle Sidebar</b-button>
            <b-sidebar id="sidebar-1" title="Sidebar" bg-variant="dark" text-variant="light" backdrop no-close-on-backdrop shadow>
            <div class="px-3 py-2">
                <p>
                Cras mattis consectetur purus sit amet fermentum. Cras justo odio, dapibus ac facilisis
                in, egestas eget quam. Morbi leo risus, porta ac consectetur ac, vestibulum at eros.
                </p>
                <b-img src="get_user_img.php?name=%E8%B3%B4%E4%BF%8B%E5%84%92" fluid thumbnail></b-img>
            </div>
            </b-sidebar>
            <div id="treant" class="chart mt-2"></div>
            <div id="testHX"></div>
            <div id="test_xlsx"></div>
        </div>
    </section>

    <!-- Place scripts at the end of the body to let DOM load first then scripts  -->
    <!-- Bootstrap core JavaScript -->
    <script src="assets/js/jquery.min.js"></script>
    <script src="assets/js/popper.min.js"></script>
    <script src="assets/js/bootstrap.min.js"></script>
    <!-- Vue -->
    <script src="assets/js/vue.js"></script>
    <script src="assets/js/vuex.js"></script>
    <script src="assets/js/bootstrap-vue.min.js"></script>
    <script src="assets/js/bootstrap-vue-icons.min.js"></script>
    <!-- Add-On -->
    <script src="assets/js/axios.min.js"></script>
    <script src="assets/js/localforage.min.js"></script>
    <script src="assets/js/global.js"></script>
    <script src="assets/js/components/lah-global.js"></script>
    <script src="assets/js/components/lah-components.js"></script>
    <script src="assets/js/chart.min.js"></script>
    <script src="assets/js/mark.jquery.min.js"></script>

    <script src="assets/js/components/dashboards/lah-xap-connection-chart.js"></script>
    <script src="assets/js/components/dashboards/lah-xap-history-chart.js"></script>

    <script src="assets/js/treant/vendor/raphael.js"></script>
    <script src="assets/js/treant/Treant.js"></script>
    <script>
        $(document).ready(() => {

            new Vue({
                el: '#testHX',
                template: `<div>
                    test {{site}}
                </div>`,
                data: () => ({
                    site: 'xxxxxxxx-xxxx-Mxxx-Nxxx-xxxxxxxxxxxx'
                })
            });

            setTimeout(() => window.testApp = new Vue({
                el: "#test_xlsx",
                template: `<div style="margin-top: 85px"><b-button @click="download">xlsx download</b-button></div>`,
                methods: {
                    download() {
                        let filename = 'testAA';
                        this.$http.post(CONFIG.API.FILE.EXPORT, {
                            type: 'file_xlsx_test',
                            responseType: 'blob',
                            filename: filename
                        }).then(res => {
                            this.$log(`${filename}.xlsx`);
                            let url = window.URL.createObjectURL(new Blob([res.data]));
                            let a = document.createElement('a');
                            a.href = url;
                            a.download = `${filename}.xlsx`;
                            document.body.appendChild(a);
                            a.click();    
                            a.remove();
                            // release object in memory
                            window.URL.revokeObjectURL(url);
                        }).catch(err => {
                            console.log(err);
                        }).finally(() => {
                        });
                    }
                }
            }), 500);

            var config = {
            container: "#treant",
            connectors: {
            type: 'step'
            },
            node: {
            HTMLclass: 'nodeExample1'
            }
            },
            ceo = {
            text: {
            name: "Mark Hill",
            title: "Chief executive officer",
            contact: "Tel: 01 213 123 134",
            },
            image: "assets/img/users/not_found.jpg"
            },

            cto = {
            parent: ceo,
            text: {
            name: "Joe Linux",
            title: "Chief Technology Officer",
            },
            stackChildren: true,
            image: "assets/img/users/not_found.jpg"
            },
            cbo = {
            parent: ceo,
            stackChildren: true,
            text: {
            name: "Linda May",
            title: "Chief Business Officer",
            },
            image: "assets/img/users/not_found.jpg"
            },
            cdo = {
            parent: ceo,
            text: {
            name: "John Green",
            title: "Chief accounting officer",
            contact: "Tel: 01 213 123 134",
            },
            image: "assets/img/users/not_found.jpg"
            },
            cio = {
            parent: cto,
            text: {
            name: "Ron Blomquist",
            title: "Chief Information Security Officer"
            },
            image: "assets/img/users/not_found.jpg"
            },
            ciso = {
            parent: cto,
            text: {
            name: "Michael Rubin",
            title: "Chief Innovation Officer",
            contact: {
            val: "we@aregreat.com",
            href: "mailto:we@aregreat.com"
            }
            },
            image: "assets/img/users/not_found.jpg"
            },
            cio2 = {
            parent: cdo,
            text: {
            name: "Erica Reel",
            title: "Chief Customer Officer"
            },
            link: {
            href: "http://www.google.com"
            },
            image: "assets/img/users/not_found.jpg"
            },
            ciso2 = {
            parent: cbo,
            text: {
            name: "Alice Lopez",
            title: "Chief Communications Officer"
            },
            image: "assets/img/users/not_found.jpg"
            },
            ciso3 = {
            parent: cbo,
            text: {
            name: "Mary Johnson",
            title: "Chief Brand Officer"
            },
            image: "assets/img/users/not_found.jpg"
            },
            ciso4 = {
            parent: cbo,
            text: {
            name: "Kirk Douglas",
            title: "Chief Business Development Officer"
            },
            image: "assets/img/users/not_found.jpg"
            },

            chart_config = [
            config,
            ceo,
            cto,
            cbo,
            cdo,
            cio,
            ciso,
            cio2,
            ciso2,
            ciso3,
            ciso4
            ];
            // let echoFunc = (cfg) => () => {new Treant(cfg); console.log("called");};
            // vueApp.$on('updated', function() {
            //     new Treant(chart_config)
            //     console.log("called")
            // })
            setTimeout(() => new Treant(chart_config), 500);
        });
    </script>
</body>

</html>